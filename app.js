!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=139)}([function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n(10);e.graph=o.graph,e.Graph=o.Graph,e.journal=o.journal,e.Journal=o.Journal;var i=n(21).Network;e.Network=n(100).Network;var a=n(7).deprecated;e.isBrowser=n(7).isBrowser,e.ComponentLoader=n(12).ComponentLoader,e.Component=n(23).Component;var s=n(24);e.InPorts=s.InPorts,e.OutPorts=s.OutPorts,e.InPort=n(25),e.OutPort=n(27),e.internalSocket=n(11),e.IP=n(6),e.createNetwork=function(t,n,o){if("function"==typeof n){var s=o;o=n,n=s}"boolean"==typeof n&&(n={delay:n}),"object"!==r(n)&&(n={}),void 0===n.subscribeGraph&&(n.subscribeGraph=!0),"function"!=typeof o&&(a("Calling noflo.createNetwork without a callback is deprecated"),o=function(t){if(t)throw t});var c=new(n.subscribeGraph?e.Network:i)(t,n),u=function(t){t.start((function(e){e?o(e):o(null,t)}))};return c.loader.listComponents((function(e){e?o(e):n.delay?o(null,c):0!==t.nodes.length?c.connect((function(t){t?o(t):u(c)})):u(c)})),c},e.loadFile=function(t,n,o){o||(o=n,n=null),o&&"object"!==r(n)&&(n={baseDir:n}),"object"!==r(n)&&(n={}),n.subscribeGraph||(n.subscribeGraph=!1),e.graph.loadFile(t,(function(t,r){t?o(t):(n.baseDir&&(r.baseDir=n.baseDir),e.createNetwork(r,n,o))}))},e.saveFile=function(t,e,n){t.save(e,n)},e.asCallback=n(106).asCallback,e.asComponent=n(107).asComponent},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,u=[],l=!1,p=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):p=-1,u.length&&f())}function f(){if(!l){var t=s(d);l=!0;for(var e=u.length;e;){for(c=u,u=[];++p<e;)c&&c[p].run();p=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new h(t,e)),1!==u.length||l||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(n,r){function o(){void 0!==i&&t.removeListener("error",i),n([].slice.call(arguments))}var i;"error"!==e&&(i=function(n){t.removeListener(e,o),r(n)},t.once("error",i)),t.once(e,o)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function p(t,e,n,r){var o,i,a,s;if(u(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),a=i[e]),void 0===a)a=i[e]=n,++t._eventsCount;else if("function"==typeof a?a=i[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(o=l(t))>0&&a.length>o&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=d.bind(r);return o.listener=n,r.wrapFn=o,o}function h(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):g(o,o.length)}function m(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)i(c,this,e);else{var u=c.length,l=g(c,u);for(n=0;n<u;++n)i(l[n],this,e)}return!0},s.prototype.addListener=function(t,e){return p(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return p(this,t,e,!0)},s.prototype.once=function(t,e){return u(e),this.on(t,f(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,f(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,o,i,a;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},s.prototype.listeners=function(t){return h(this,t,!0)},s.prototype.rawListeners=function(t){return h(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e){},function(t,e,n){(function(r){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))}),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=n(101)(e);const{formatters:o}=t.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(1))},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var o=t[r];"."===o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a=i>=0?arguments[i]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,o="/"===a.charAt(0))}return(o?"/":"")+(e=n(r(e.split("/"),(function(t){return!!t})),!o).join("/"))||"."},e.normalize=function(t){var i=e.isAbsolute(t),a="/"===o(t,-1);return(t=n(r(t.split("/"),(function(t){return!!t})),!i).join("/"))||i||(t="."),t&&a&&(t+="/"),(i?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var o=r(t.split("/")),i=r(n.split("/")),a=Math.min(o.length,i.length),s=a,c=0;c<a;c++)if(o[c]!==i[c]){s=c;break}var u=[];for(c=s;c<o.length;c++)u.push("..");return(u=u.concat(i.slice(s))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,o=!0,i=t.length-1;i>=1;--i)if(47===(e=t.charCodeAt(i))){if(!o){r=i;break}}else o=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,o=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!o){n=e+1;break}}else-1===r&&(o=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,o=!0,i=0,a=t.length-1;a>=0;--a){var s=t.charCodeAt(a);if(47!==s)-1===r&&(o=!1,r=a+1),46===s?-1===e?e=a:1!==i&&(i=1):-1!==e&&(i=-1);else if(!o){n=a+1;break}}return-1===e||-1===r||0===i||1===i&&e===r-1&&e===n+1?"":t.slice(e,r)};var o="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(1))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}t.exports=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(this,t),this.type=e||"data",this.data=i,this.isIP=!0,this.scope=null,this.owner=null,this.clonable=!1,this.index=null,this.schema=null,this.datatype="all","object"===r(a)&&Object.keys(a).forEach((function(t){n[t]=a[t]})),this}return a(t,null,[{key:"isIP",value:function(t){return t&&"object"===r(t)&&!0===t.isIP}}]),a(t,[{key:"clone",value:function(){var e=this,n=new t(this.type);return Object.keys(this).forEach((function(t){var o=e[t];"owner"!==t&&null!==o&&("object"===r(o)?n[t]=JSON.parse(JSON.stringify(o)):n[t]=o)})),n}},{key:"move",value:function(t){return this.owner=t,this}},{key:"drop",value:function(){var t=this;Object.keys(this).forEach((function(e){delete t[e]}))}}]),t}()},function(t,e,n){"use strict";(function(t){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(e.isBrowser()){if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}else{if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}}).call(this,n(1))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},o=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),c=r[n];n<i;c=r[++n])m(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,a={};function s(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),l(r,t,r.depth)}function c(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function u(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&S(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return v(o)||(o=l(t,o,r)),o}var i=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(h(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(i)return i;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),k(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return p(n);if(0===a.length){if(S(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return t.stylize(Date.prototype.toString.call(n),"date");if(k(n))return p(n)}var u,w="",P=!1,O=["{","}"];(f(n)&&(P=!0,O=["[","]"]),S(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),E(n)&&(w=" "+Date.prototype.toUTCString.call(n)),k(n)&&(w=" "+p(n)),0!==a.length||P&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=P?function(t,e,n,r,o){for(var i=[],a=0,s=e.length;a<s;++a)A(e,String(a))?i.push(d(t,e,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(t,e,n,r,o,!0))})),i}(t,n,r,s,a):a.map((function(e){return d(t,n,r,s,e,P)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,w,O)):O[0]+w+O[1]}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),A(r,o)||(a="["+o+"]"),s||(t.seen.indexOf(c.value)<0?(s=m(n)?l(t,c.value,null):l(t,c.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function f(t){return Array.isArray(t)}function h(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function v(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return w(t)&&"[object RegExp]"===P(t)}function w(t){return"object"==typeof t&&null!==t}function E(t){return w(t)&&"[object Date]"===P(t)}function k(t){return w(t)&&("[object Error]"===P(t)||t instanceof Error)}function S(t){return"function"==typeof t}function P(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(y(i)&&(i=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=h,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=w,e.isDate=E,e.isError=k,e.isFunction=S,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(59);var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),_[t.getMonth()],e].join(" ")}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",C(),e.format.apply(e,arguments))},e.inherits=n(60),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var x="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(x&&t[x]){var e;if("function"!=typeof(e=t[x]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,x,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,o)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),x&&Object.defineProperty(e,x,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=x,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(I,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(1))},function(t,e,n){e.graph=n(37),e.Graph=e.graph.Graph,e.journal=n(45),e.Journal=e.journal.Journal},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=n(2).EventEmitter,d=n(6);function f(t,e){if(d.isIP(e))return e;switch(t){case"begingroup":return new d("openBracket",e);case"endgroup":return new d("closeBracket");case"data":return new d("data",e);default:return null}}function h(t){switch(t.type){case"openBracket":return{event:"begingroup",payload:t.data};case"data":return{event:"data",payload:t.data};case"closeBracket":return{event:"endgroup",payload:t.data};default:return null}}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=c(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(this,n),(t=e.call(this)).metadata=r,t.brackets=[],t.connected=!1,t.dataDelegate=null,t.debug=!1,t.emitEvent=t.regularEmitEvent,t}return a(n,[{key:"regularEmitEvent",value:function(t,e){this.emit(t,e)}},{key:"debugEmitEvent",value:function(t,e){try{this.emit(t,e)}catch(t){if(t.id&&t.metadata&&t.error){if(0===this.listeners("error").length)throw t.error;return void this.emit("error",t)}if(0===this.listeners("error").length)throw t;this.emit("error",{id:this.to.process.id,error:t,metadata:this.metadata})}}}]),a(n,[{key:"connect",value:function(){this.connected||(this.connected=!0,this.emitEvent("connect",null))}},{key:"disconnect",value:function(){this.connected&&(this.connected=!1,this.emitEvent("disconnect",null))}},{key:"isConnected",value:function(){return this.connected}},{key:"send",value:function(t){void 0!==t||"function"!=typeof this.dataDelegate?this.handleSocketEvent("data",t):this.handleSocketEvent("data",this.dataDelegate())}},{key:"post",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t;void 0===n&&"function"==typeof this.dataDelegate&&(n=this.dataDelegate()),this.isConnected()||0!==this.brackets.length||this.connect(),this.handleSocketEvent("ip",n,!1),e&&this.isConnected()&&0===this.brackets.length&&this.disconnect()}},{key:"beginGroup",value:function(t){this.handleSocketEvent("begingroup",t)}},{key:"endGroup",value:function(){this.handleSocketEvent("endgroup")}},{key:"setDataDelegate",value:function(t){if("function"!=typeof t)throw Error("A data delegate must be a function.");this.dataDelegate=t}},{key:"setDebug",value:function(t){this.debug=t,this.emitEvent=this.debug?this.debugEmitEvent:this.regularEmitEvent}},{key:"getId",value:function(){var t=function(t){return"".concat(t.process.id,"() ").concat(t.port.toUpperCase())},e=function(t){return"".concat(t.port.toUpperCase()," ").concat(t.process.id,"()")};return this.from||this.to?this.from&&!this.to?"".concat(t(this.from)," -> ANON"):this.from?"".concat(t(this.from)," -> ").concat(e(this.to)):"DATA -> ".concat(e(this.to)):"UNDEFINED"}},{key:"handleSocketEvent",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r="ip"===t&&d.isIP(e),o=r?e:f(t,e);if(o){if(!this.isConnected()&&n&&0===this.brackets.length&&this.connect(),"begingroup"===t&&this.brackets.push(e),r&&"openBracket"===o.type&&this.brackets.push(o.data),"endgroup"===t){if(0===this.brackets.length)return;o.data=this.brackets.pop(),e=o.data}if(r&&"closeBracket"===e.type){if(0===this.brackets.length)return;this.brackets.pop()}if(this.emitEvent("ip",o),o&&o.type){if(r){var i=h(o);t=i.event,e=i.payload}"connect"===t&&(this.connected=!0),"disconnect"===t&&(this.connected=!1),this.emitEvent(t,e)}}}}]),n}(p);e.InternalSocket=m,e.createSocket=function(){return new m}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=n(10),f=n(2).EventEmitter,h=n(46),m=n(7),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,t);var e,n,o,l=u(p);function p(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,p),(e=l.call(this)).baseDir=t,e.options=n,e.components=null,e.libraryIcons={},e.processing=!1,e.ready=!1,e.setMaxListeners(0),e}return e=p,(n=[{key:"getModulePrefix",value:function(t){if(!t)return"";var e=t;return"noflo"===e?"":("@"===e[0]&&(e=e.replace(/@[a-z-]+\//,"")),e.replace(/^noflo-/,""))}},{key:"listComponents",value:function(t){var e=this;this.processing?this.once("ready",(function(){return t(null,e.components)})):this.components?t(null,this.components):(this.ready=!1,this.processing=!0,this.components={},h.register(this,(function(n){e.processing=!1,e.ready=!0,e.emit("ready",!0),n?t(n):t(null,e.components)})))}},{key:"load",value:function(t,e,n){var r=this;if(this.ready){var o=this.components[t];if(!o){for(var i=Object.keys(this.components),a=0;a<i.length;a+=1){var s=i[a];if(s.split("/")[1]===t){o=this.components[s];break}}if(!o)return void e(new Error("Component ".concat(t," not available with base ").concat(this.baseDir)))}this.isGraph(o)?this.loadGraph(t,o,e,n):this.createComponent(t,o,n,(function(n,o){var i=o;n?e(n):i?("Graph"===t&&(i.baseDir=r.baseDir),"string"==typeof t&&(i.componentName=t),i.isLegacy()&&m.deprecated("Component ".concat(t," uses legacy NoFlo APIs. Please port to Process API")),r.setIcon(t,i),e(null,i)):e(new Error("Component ".concat(t," could not be loaded.")))}))}else this.listComponents((function(o){o?e(o):r.load(t,e,n)}))}},{key:"createComponent",value:function(t,e,n,r){var o,a=e;if(a){if("string"==typeof a)return"function"==typeof h.dynamicLoad?void h.dynamicLoad(t,a,n,r):void r(Error("Dynamic loading of ".concat(a," for component ").concat(t," not available on this platform.")));if("function"==typeof a.getComponent)try{o=a.getComponent(n)}catch(t){return void r(t)}else{if("function"!=typeof a)return void r(new Error("Invalid type ".concat(i(a)," for component ").concat(t,".")));try{o=a(n)}catch(t){return void r(t)}}r(null,o)}else r(new Error("Component ".concat(t," not available")))}},{key:"isGraph",value:function(t){return!("object"!==i(t)||!(t instanceof d.Graph||Array.isArray(t.nodes)&&Array.isArray(t.edges)&&Array.isArray(t.initializers)))||!("object"!==i(t)||!t.processes||!t.connections)||"string"==typeof t&&(-1!==t.indexOf(".fbp")||-1!==t.indexOf(".json"))}},{key:"loadGraph",value:function(t,e,n,r){var o=this;this.createComponent(t,this.components.Graph,r,(function(r,i){var a=i;r?n(r):(a.loader=o,a.baseDir=o.baseDir,a.inPorts.remove("graph"),a.setGraph(e,(function(e){e?n(e):(o.setIcon(t,a),n(null,a))})))}))}},{key:"setIcon",value:function(t,e){if(e.getIcon&&!e.getIcon()){var n=r(t.split("/"),2),o=n[0];n[1]&&this.getLibraryIcon(o)?e.setIcon(this.getLibraryIcon(o)):e.isSubgraph()?e.setIcon("sitemap"):e.setIcon("gear")}}},{key:"getLibraryIcon",value:function(t){return this.libraryIcons[t]?this.libraryIcons[t]:null}},{key:"setLibraryIcon",value:function(t,e){this.libraryIcons[t]=e}},{key:"normalizeName",value:function(t,e){var n=this.getModulePrefix(t),r="".concat(n,"/").concat(e);return t||(r=e),r}},{key:"registerComponent",value:function(t,e,n,r){var o=this.normalizeName(t,e);this.components[o]=n,r&&r()}},{key:"registerGraph",value:function(t,e,n,r){this.registerComponent(t,e,n,r)}},{key:"registerLoader",value:function(t,e){t(this,e)}},{key:"setSource",value:function(t,e,n,r,o){var i=this;h.setSource?this.ready?h.setSource(this,t,e,n,r,o):this.listComponents((function(a){a?o(a):i.setSource(t,e,n,r,o)})):o(new Error("setSource not allowed"))}},{key:"getSource",value:function(t,e){var n=this;h.getSource?this.ready?h.getSource(this,t,e):this.listComponents((function(r){r?e(r):n.getSource(t,e)})):e(new Error("getSource not allowed"))}},{key:"getLanguages",value:function(){return h.getLanguages?h.getLanguages():["javascript","es2015"]}},{key:"clear",value:function(){this.components=null,this.ready=!1,this.processing=!1}}])&&s(e.prototype,n),o&&s(e,o),p}(f);e.ComponentLoader=g},function(t,e){t.exports=function(t){return[":~:",t,":~:"].join("")}},function(t,e,n){const r=n(29);t.exports=class extends r{constructor(t={}){const e=t;super(e),e.catchExceptions&&(window.onerror=function(t){return this.client&&this.send("network","error",t,{href:this.context?this.context.href:this.client.location.href}),console.error(t),!0}.bind(this)),e.defaultPermissions.length||(e.defaultPermissions=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource","network:data","network:control","network:status"]),this.client=null}setClient(t){this.client=t}send(t,e,n,r){if(!this.client)return;let o=n;n instanceof Error&&(o={message:n.message,stack:n.stack});let{context:i}=this;i||(i=r),this.client.postMessage(JSON.stringify({protocol:t,command:e,payload:o}),i.href),super.send(t,e,n,i)}sendAll(t,e,n){this.send(t,e,n,this.context)}}},function(t,e){e.parseName=function(t){if(-1===t.indexOf("/"))return{library:null,name:t};const e=t.split("/");return{library:e[0],name:e[1]}},e.withNamespace=function(t,e){return e&&-1===t.indexOf("/")?`${e}/${t}`:t},e.withoutNamespace=function(t){return-1===t.indexOf("/")?t:t.split("/")[1]}},function(t,e,n){"use strict";(function(e){var r=n(124);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function o(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n(9),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,u="foo"===function(){}.name;function l(t){return Object.prototype.toString.call(t)}function p(t){return!i(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var d=t.exports=y,f=/\s*function\s+([^\(\s]*)\s*/;function h(t){if(a.isFunction(t)){if(u)return t.name;var e=t.toString().match(f);return e&&e[1]}}function m(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(u||!a.isFunction(t))return a.inspect(t);var e=h(t);return"[Function"+(e?": "+e:"")+"]"}function v(t,e,n,r,o){throw new d.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:o})}function y(t,e){t||v(t,!0,e,"==",d.ok)}function b(t,e,n,r){if(t===e)return!0;if(i(t)&&i(e))return 0===o(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(p(t)&&p(e)&&l(t)===l(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===o(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var s=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==s&&s===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var o=w(t),i=w(e);if(o&&!i||!o&&i)return!1;if(o)return t=c.call(t),e=c.call(e),b(t,e,n);var s,u,l=S(t),p=S(e);if(l.length!==p.length)return!1;for(l.sort(),p.sort(),u=l.length-1;u>=0;u--)if(l[u]!==p[u])return!1;for(u=l.length-1;u>=0;u--)if(s=l[u],!b(t[s],e[s],n,r))return!1;return!0}(t,e,n,r))}return n?t===e:t==e}function w(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function E(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function k(t,e,n,r){var o;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),o=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!o&&v(o,n,"Missing expected exception"+r);var i="string"==typeof r,s=!t&&o&&!n;if((!t&&a.isError(o)&&i&&E(o,n)||s)&&v(o,n,"Got unwanted exception"+r),t&&o&&n&&!E(o,n)||!t&&o)throw o}d.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return m(g(t.actual),128)+" "+t.operator+" "+m(g(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,o=h(e),i=r.indexOf("\n"+o);if(i>=0){var a=r.indexOf("\n",i+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(d.AssertionError,Error),d.fail=v,d.ok=y,d.equal=function(t,e,n){t!=e&&v(t,e,n,"==",d.equal)},d.notEqual=function(t,e,n){t==e&&v(t,e,n,"!=",d.notEqual)},d.deepEqual=function(t,e,n){b(t,e,!1)||v(t,e,n,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(t,e,n){b(t,e,!0)||v(t,e,n,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(t,e,n){b(t,e,!1)&&v(t,e,n,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function t(e,n,r){b(e,n,!0)&&v(e,n,r,"notDeepStrictEqual",t)},d.strictEqual=function(t,e,n){t!==e&&v(t,e,n,"===",d.strictEqual)},d.notStrictEqual=function(t,e,n){t===e&&v(t,e,n,"!==",d.notStrictEqual)},d.throws=function(t,e,n){k(!0,t,e,n)},d.doesNotThrow=function(t,e,n){k(!1,t,e,n)},d.ifError=function(t){if(t)throw t},d.strict=r((function t(e,n){e||v(e,!0,n,"==",t)}),d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var S=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(8))},function(t,e,n){t.exports=l,l.Minimatch=p;var r={sep:"/"};try{r=n(5)}catch(t){}var o=l.GLOBSTAR=p.GLOBSTAR={},i=n(126),a={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},s="().*{}+?[]^$\\!".split("").reduce((function(t,e){return t[e]=!0,t}),{});var c=/\/+/;function u(t,e){t=t||{},e=e||{};var n={};return Object.keys(e).forEach((function(t){n[t]=e[t]})),Object.keys(t).forEach((function(e){n[e]=t[e]})),n}function l(t,e,n){if("string"!=typeof e)throw new TypeError("glob pattern string required");return n||(n={}),!(!n.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new p(e,n).match(t))}function p(t,e){if(!(this instanceof p))return new p(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==r.sep&&(t=t.split(r.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function d(t,e){if(e||(e=this instanceof p?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:i(t)}l.filter=function(t,e){return e=e||{},function(n,r,o){return l(n,t,e)}},l.defaults=function(t){if(!t||!Object.keys(t).length)return l;var e=l,n=function(n,r,o){return e.minimatch(n,r,u(t,o))};return n.Minimatch=function(n,r){return new e.Minimatch(n,u(t,r))},n},p.defaults=function(t){return t&&Object.keys(t).length?l.defaults(t).Minimatch:p},p.prototype.debug=function(){},p.prototype.make=function(){if(this._made)return;var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error);this.debug(this.pattern,n),n=this.globParts=n.map((function(t){return t.split(c)})),this.debug(this.pattern,n),n=n.map((function(t,e,n){return t.map(this.parse,this)}),this),this.debug(this.pattern,n),n=n.filter((function(t){return-1===t.indexOf(!1)})),this.debug(this.pattern,n),this.set=n},p.prototype.parseNegate=function(){var t=this.pattern,e=!1,n=this.options,r=0;if(n.nonegate)return;for(var o=0,i=t.length;o<i&&"!"===t.charAt(o);o++)e=!e,r++;r&&(this.pattern=t.substr(r));this.negate=e},l.braceExpand=function(t,e){return d(t,e)},p.prototype.braceExpand=d,p.prototype.parse=function(t,e){if(t.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===t)return o;if(""===t)return"";var r,i="",c=!!n.nocase,u=!1,l=[],p=[],d=!1,h=-1,m=-1,g="."===t.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function y(){if(r){switch(r){case"*":i+="[^/]*?",c=!0;break;case"?":i+="[^/]",c=!0;break;default:i+="\\"+r}v.debug("clearStateChar %j %j",r,i),r=!1}}for(var b,w=0,E=t.length;w<E&&(b=t.charAt(w));w++)if(this.debug("%s\t%s %s %j",t,w,i,b),u&&s[b])i+="\\"+b,u=!1;else switch(b){case"/":return!1;case"\\":y(),u=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,w,i,b),d){this.debug("  in class"),"!"===b&&w===m+1&&(b="^"),i+=b;continue}v.debug("call clearStateChar %j",r),y(),r=b,n.noext&&y();continue;case"(":if(d){i+="(";continue}if(!r){i+="\\(";continue}l.push({type:r,start:w-1,reStart:i.length,open:a[r].open,close:a[r].close}),i+="!"===r?"(?:(?!(?:":"(?:",this.debug("plType %j %j",r,i),r=!1;continue;case")":if(d||!l.length){i+="\\)";continue}y(),c=!0;var k=l.pop();i+=k.close,"!"===k.type&&p.push(k),k.reEnd=i.length;continue;case"|":if(d||!l.length||u){i+="\\|",u=!1;continue}y(),i+="|";continue;case"[":if(y(),d){i+="\\"+b;continue}d=!0,m=w,h=i.length,i+=b;continue;case"]":if(w===m+1||!d){i+="\\"+b,u=!1;continue}if(d){var S=t.substring(m+1,w);try{RegExp("["+S+"]")}catch(t){var P=this.parse(S,f);i=i.substr(0,h)+"\\["+P[0]+"\\]",c=c||P[1],d=!1;continue}}c=!0,d=!1,i+=b;continue;default:y(),u?u=!1:!s[b]||"^"===b&&d||(i+="\\"),i+=b}d&&(S=t.substr(m+1),P=this.parse(S,f),i=i.substr(0,h)+"\\["+P[0],c=c||P[1]);for(k=l.pop();k;k=l.pop()){var O=i.slice(k.reStart+k.open.length);this.debug("setting tail",i,k),O=O.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(t,e,n){return n||(n="\\"),e+e+n+"|"})),this.debug("tail=%j\n   %s",O,O,k,i);var _="*"===k.type?"[^/]*?":"?"===k.type?"[^/]":"\\"+k.type;c=!0,i=i.slice(0,k.reStart)+_+"\\("+O}y(),u&&(i+="\\\\");var C=!1;switch(i.charAt(0)){case".":case"[":case"(":C=!0}for(var A=p.length-1;A>-1;A--){var x=p[A],I=i.slice(0,x.reStart),D=i.slice(x.reStart,x.reEnd-8),N=i.slice(x.reEnd-8,x.reEnd),R=i.slice(x.reEnd);N+=R;var T=I.split("(").length-1,j=R;for(w=0;w<T;w++)j=j.replace(/\)[+*?]?/,"");var L="";""===(R=j)&&e!==f&&(L="$"),i=I+D+R+L+N}""!==i&&c&&(i="(?=.)"+i);C&&(i=g+i);if(e===f)return[i,c];if(!c)return function(t){return t.replace(/\\(.)/g,"$1")}(t);var M=n.nocase?"i":"";try{var B=new RegExp("^"+i+"$",M)}catch(t){return new RegExp("$.")}return B._glob=t,B._src=i,B};var f={};l.makeRe=function(t,e){return new p(t,e||{}).makeRe()},p.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,n=e.noglobstar?"[^/]*?":e.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",r=e.nocase?"i":"",i=t.map((function(t){return t.map((function(t){return t===o?n:"string"==typeof t?function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(t):t._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(t){this.regexp=!1}return this.regexp},l.match=function(t,e,n){var r=new p(e,n=n||{});return t=t.filter((function(t){return r.match(t)})),r.options.nonull&&!t.length&&t.push(e),t},p.prototype.match=function(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var n=this.options;"/"!==r.sep&&(t=t.split(r.sep).join("/"));t=t.split(c),this.debug(this.pattern,"split",t);var o,i,a=this.set;for(this.debug(this.pattern,"set",a),i=t.length-1;i>=0&&!(o=t[i]);i--);for(i=0;i<a.length;i++){var s=a[i],u=t;if(n.matchBase&&1===s.length&&(u=[o]),this.matchOne(u,s,e))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},p.prototype.matchOne=function(t,e,n){var r=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,a=0,s=t.length,c=e.length;i<s&&a<c;i++,a++){this.debug("matchOne loop");var u,l=e[a],p=t[i];if(this.debug(e,l,p),!1===l)return!1;if(l===o){this.debug("GLOBSTAR",[e,l,p]);var d=i,f=a+1;if(f===c){for(this.debug("** at the end");i<s;i++)if("."===t[i]||".."===t[i]||!r.dot&&"."===t[i].charAt(0))return!1;return!0}for(;d<s;){var h=t[d];if(this.debug("\nglobstar while",t,d,e,f,h),this.matchOne(t.slice(d),e.slice(f),n))return this.debug("globstar found match!",d,s,h),!0;if("."===h||".."===h||!r.dot&&"."===h.charAt(0)){this.debug("dot detected!",t,d,e,f);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!n||(this.debug("\n>>> no match, partial?",t,d,e,f),d!==s))}if("string"==typeof l?(u=r.nocase?p.toLowerCase()===l.toLowerCase():p===l,this.debug("string match",l,p,u)):(u=p.match(l),this.debug("pattern match",l,p,u)),!u)return!1}if(i===s&&a===c)return!0;if(i===s)return n;if(a===c)return i===s-1&&""===t[i];throw new Error("wtf?")}},function(t,e,n){"use strict";(function(e){function n(t){return"/"===t.charAt(0)}function r(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),n=e[1]||"",r=Boolean(n&&":"!==n.charAt(1));return Boolean(e[2]||r)}t.exports="win32"===e.platform?r:n,t.exports.posix=n,t.exports.win32=r}).call(this,n(1))},function(t,e,n){(function(e){var n=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var n,r,o;try{n=Map}catch(t){n=function(){}}try{r=Set}catch(t){r=function(){}}try{o=Promise}catch(t){o=function(){}}function i(a,c,u,l,p){"object"==typeof c&&(u=c.depth,l=c.prototype,p=c.includeNonEnumerable,c=c.circular);var d=[],f=[],h=void 0!==e;return void 0===c&&(c=!0),void 0===u&&(u=1/0),function a(u,m){if(null===u)return null;if(0===m)return u;var g,v;if("object"!=typeof u)return u;if(t(u,n))g=new n;else if(t(u,r))g=new r;else if(t(u,o))g=new o((function(t,e){u.then((function(e){t(a(e,m-1))}),(function(t){e(a(t,m-1))}))}));else if(i.__isArray(u))g=[];else if(i.__isRegExp(u))g=new RegExp(u.source,s(u)),u.lastIndex&&(g.lastIndex=u.lastIndex);else if(i.__isDate(u))g=new Date(u.getTime());else{if(h&&e.isBuffer(u))return g=e.allocUnsafe?e.allocUnsafe(u.length):new e(u.length),u.copy(g),g;t(u,Error)?g=Object.create(u):void 0===l?(v=Object.getPrototypeOf(u),g=Object.create(v)):(g=Object.create(l),v=l)}if(c){var y=d.indexOf(u);if(-1!=y)return f[y];d.push(u),f.push(g)}for(var b in t(u,n)&&u.forEach((function(t,e){var n=a(e,m-1),r=a(t,m-1);g.set(n,r)})),t(u,r)&&u.forEach((function(t){var e=a(t,m-1);g.add(e)})),u){var w;v&&(w=Object.getOwnPropertyDescriptor(v,b)),w&&null==w.set||(g[b]=a(u[b],m-1))}if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(u);for(b=0;b<E.length;b++){var k=E[b];(!(P=Object.getOwnPropertyDescriptor(u,k))||P.enumerable||p)&&(g[k]=a(u[k],m-1),P.enumerable||Object.defineProperty(g,k,{enumerable:!1}))}}if(p){var S=Object.getOwnPropertyNames(u);for(b=0;b<S.length;b++){var P,O=S[b];(P=Object.getOwnPropertyDescriptor(u,O))&&P.enumerable||(g[O]=a(u[O],m-1),Object.defineProperty(g,O,{enumerable:!1}))}}return g}(a,u)}function a(t){return Object.prototype.toString.call(t)}function s(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=a,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===a(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===a(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===a(t)},i.__getRegExpFlags=s,i}();t.exports&&(t.exports=n)}).call(this,n(20).Buffer)},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(38),o=n(39),i=n(40);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return p(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=d(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(e,n),o=(t=s(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|f(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):d(t,e);if("Buffer"===e.type&&i(e.data))return d(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function p(t,e){if(l(e),t=s(t,e<0?0:0|f(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|f(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function h(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(r)return F(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,e,n);case"utf8":case"utf-8":return _(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return O(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:y(t,e,n,r,o);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,r,o){var i,a=1,s=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){var l=-1;for(i=n;i<s;i++)if(u(t,i)===u(e,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var p=!0,d=0;d<c;d++)if(u(t,i+d)!==u(e,d)){p=!1;break}if(p)return i}return-1}function b(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function w(t,e,n,r){return H(F(e,t.length-n),t,n,r)}function E(t,e,n,r){return H(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function k(t,e,n,r){return E(t,e,n,r)}function S(t,e,n,r){return H(G(e),t,n,r)}function P(t,e,n,r){return H(function(t,e){for(var n,r,o,i=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function O(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function _(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,a,s,c,u=t[o],l=null,p=u>239?4:u>223?3:u>191?2:1;if(o+p<=n)switch(p){case 1:u<128&&(l=u);break;case 2:128==(192&(i=t[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=t[o+1],a=t[o+2],128==(192&i)&&128==(192&a)&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=t[o+1],a=t[o+2],s=t[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,p=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=p}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return p(null,t)},c.allocUnsafeSlow=function(t){return p(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?_(this,0,t):m.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,o){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(i,a),u=this.slice(r,o),l=t.slice(e,n),p=0;p<s;++p)if(u[p]!==l[p]){i=u[p],a=l[p];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return E(this,t,e,n);case"latin1":case"binary":return k(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function x(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=U(t[i]);return o}function I(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,n,r,o,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function R(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function T(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function j(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,r,i){return i||j(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function M(t,e,n,r,i){return i||j(t,0,n,8),o.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var o=e-t;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},c.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),o.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),o.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),o.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),o.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||N(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||N(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):T(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):T(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}var i=0,a=1,s=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):T(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):T(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return M(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return M(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var a=c.isBuffer(t)?t:F(new c(t,r).toString()),s=a.length;for(i=0;i<n-e;++i)this[i+e]=a[i%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function F(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function G(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(8))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,t);var e,n,r,u=c(p);function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,p),u.call(this,t,e)}return e=p,(n=[{key:"addNode",value:function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={}),a(l(p.prototype),"addNode",this).call(this,t,e,(function(o,i){o?n(o):(e.initial||r.graph.addNode(t.id,t.component,t.metadata),n(null,i))}))}},{key:"removeNode",value:function(t,e){var n=this;a(l(p.prototype),"removeNode",this).call(this,t,(function(r){r?e(r):(n.graph.removeNode(t.id),e())}))}},{key:"renameNode",value:function(t,e,n){var r=this;a(l(p.prototype),"renameNode",this).call(this,t,e,(function(o){o?n(o):(r.graph.renameNode(t,e),n())}))}},{key:"addEdge",value:function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={}),a(l(p.prototype),"addEdge",this).call(this,t,e,(function(o){o?n(o):(e.initial||r.graph.addEdgeIndex(t.from.node,t.from.port,t.from.index,t.to.node,t.to.port,t.to.index,t.metadata),n())}))}},{key:"removeEdge",value:function(t,e){var n=this;a(l(p.prototype),"removeEdge",this).call(this,t,(function(r){r?e(r):(n.graph.removeEdge(t.from.node,t.from.port,t.to.node,t.to.port),e())}))}},{key:"addInitial",value:function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={}),a(l(p.prototype),"addInitial",this).call(this,t,e,(function(o){o?n(o):(e.initial||r.graph.addInitialIndex(t.from.data,t.to.node,t.to.port,t.to.index,t.metadata),n())}))}},{key:"removeInitial",value:function(t,e){var n=this;a(l(p.prototype),"removeInitial",this).call(this,t,(function(r){r?e(r):(n.graph.removeInitial(t.to.node,t.to.port),e())}))}}])&&i(e.prototype,n),r&&i(e,r),p}(n(22));e.Network=p},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=c(t);if(e){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=n(2).EventEmitter,l=n(11),p=n(7),d=n(12),f=n(99),h=n(6);function m(t,e,n,r,o,i){if(o)return t.to={process:e,port:n,index:r},e.component.inPorts&&e.component.inPorts[n]?e.component.inPorts[n].isAddressable()?(e.component.inPorts[n].attach(t,r),void i()):(e.component.inPorts[n].attach(t),void i()):void i(new Error("No inport '".concat(n,"' defined in process ").concat(e.id," (").concat(t.getId(),")")));if(t.from={process:e,port:n,index:r},e.component.outPorts&&e.component.outPorts[n]){if(e.component.outPorts[n].isAddressable())return e.component.outPorts[n].attach(t,r),void i();e.component.outPorts[n].attach(t),i()}else i(new Error("No outport '".concat(n,"' defined in process ").concat(e.id," (").concat(t.getId(),")")))}function g(t){t.socket.post(new h("data",t.data,{initial:!0}))}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(u,t);var n,r,s,c=a(u);function u(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),null==n&&(n={}),(r=c.call(this)).options=n,r.processes={},r.connections=[],r.initials=[],r.nextInitials=[],r.defaults=[],r.graph=t,r.started=!1,r.stopped=!0,r.debug=!0,r.eventBuffer=[],p.isBrowser()?r.baseDir=t.baseDir||"/":r.baseDir=t.baseDir||e.cwd(),r.startupDate=null,t.componentLoader?r.loader=t.componentLoader:r.loader=new d.ComponentLoader(r.baseDir,r.options),r}return n=u,(r=[{key:"uptime",value:function(){return this.startupDate?new Date-this.startupDate:0}},{key:"getActiveProcesses",value:function(){var t=this,e=[];return this.started?(Object.keys(this.processes).forEach((function(n){var r=t.processes[n];r.component.load>0&&e.push(n),r.component.__openConnections>0&&e.push(n)})),e):e}},{key:"bufferedEmit",value:function(t,e){var n=this;if(["icon","error","process-error","end"].includes(t))this.emit(t,e);else if(this.isStarted()||"end"===t){if(this.emit(t,e),"start"===t&&(this.eventBuffer.forEach((function(t){n.emit(t.type,t.payload)})),this.eventBuffer=[]),"ip"===t)switch(e.type){case"openBracket":return void this.bufferedEmit("begingroup",e);case"closeBracket":return void this.bufferedEmit("endgroup",e);case"data":this.bufferedEmit("data",e)}}else this.eventBuffer.push({type:t,payload:e})}},{key:"load",value:function(t,e,n){this.loader.load(t,n,e)}},{key:"addNode",value:function(t,e,n){var r=this;if("function"==typeof e&&(n=e,e={}),this.processes[t.id])n(null,this.processes[t.id]);else{var o={id:t.id};if(!t.component)return this.processes[o.id]=o,void n(null,o);this.load(t.component,t.metadata,(function(e,i){if(e)n(e);else{i.nodeId=t.id,o.component=i,o.componentName=t.component;var a=o.component.inPorts.ports,s=o.component.outPorts.ports;Object.keys(a).forEach((function(e){var n=a[e];n.node=t.id,n.nodeInstance=i,n.name=e})),Object.keys(s).forEach((function(e){var n=s[e];n.node=t.id,n.nodeInstance=i,n.name=e})),i.isSubgraph()&&r.subscribeSubgraph(o),r.subscribeNode(o),r.processes[o.id]=o,n(null,o)}}))}}},{key:"removeNode",value:function(t,e){var n=this,r=this.getNode(t.id);r?r.component.shutdown((function(r){r?e(r):(delete n.processes[t.id],e(null))})):e(new Error("Node ".concat(t.id," not found")))}},{key:"renameNode",value:function(t,e,n){var r=this.getNode(t);if(r){r.id=e;var o=r.component.inPorts.ports,i=r.component.outPorts.ports;Object.keys(o).forEach((function(t){var n=o[t];n&&(n.node=e)})),Object.keys(i).forEach((function(t){var n=i[t];n&&(n.node=e)})),this.processes[e]=r,delete this.processes[t],n(null)}else n(new Error("Process ".concat(t," not found")))}},{key:"getNode",value:function(t){return this.processes[t]}},{key:"connect",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=0,r=function(r,o){return function(i){t["add".concat(i)](o,{initial:!0},(function(t){t?e(t):(n+=1)%100!=0?r(i):setTimeout((function(){r(i)}),0)}))}},o=f.reduceRight(this.graph.nodes,r,(function(){e()})),i=f.reduceRight(this.graph.initializers,r,(function(){o("Defaults")})),a=f.reduceRight(this.graph.edges,r,(function(){i("Initial")})),s=f.reduceRight(this.graph.nodes,r,(function(){a("Edge")}));s("Node")}},{key:"subscribeSubgraph",value:function(t){var e=this;if(t.component.isReady()){if(t.component.network){t.component.network.setDebug(this.debug);var n=function(n,r){if("process-error"===n&&0===e.listeners("process-error").length){if(r.id&&r.metadata&&r.error)throw r.error;throw r}return r||(r={}),r.subgraph?(r.subgraph.unshift||(r.subgraph=[r.subgraph]),r.subgraph.unshift(t.id)):r.subgraph=[t.id],e.bufferedEmit(n,r)};t.component.network.on("ip",(function(t){n("ip",t)})),t.component.network.on("process-error",(function(t){n("process-error",t)}))}}else t.component.once("ready",(function(){e.subscribeSubgraph(t)}))}},{key:"subscribeSocket",value:function(t,e){var n=this;t.on("ip",(function(e){n.bufferedEmit("ip",{id:t.getId(),type:e.type,socket:t,data:e.data,metadata:t.metadata})})),t.on("error",(function(t){if(0===n.listeners("process-error").length){if(t.id&&t.metadata&&t.error)throw t.error;throw t}n.bufferedEmit("process-error",t)})),e&&e.component&&e.component.isLegacy()&&(t.on("connect",(function(){e.component.__openConnections||(e.component.__openConnections=0),e.component.__openConnections+=1})),t.on("disconnect",(function(){e.component.__openConnections-=1,e.component.__openConnections<0&&(e.component.__openConnections=0),0===e.component.__openConnections&&n.checkIfFinished()})))}},{key:"subscribeNode",value:function(t){var e=this;t.component.on("activate",(function(){e.debouncedEnd&&(e.abortDebounce=!0)})),t.component.on("deactivate",(function(t){t>0||e.checkIfFinished()})),t.component.getIcon&&t.component.on("icon",(function(){e.bufferedEmit("icon",{id:t.id,icon:t.component.getIcon()})}))}},{key:"addEdge",value:function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={});var o=l.createSocket(t.metadata);o.setDebug(this.debug);var i=this.getNode(t.from.node);if(i)if(i.component)if(i.component.isReady()){var a=this.getNode(t.to.node);a?a.component?a.component.isReady()?(this.subscribeSocket(o,i),m(o,a,t.to.port,t.to.index,!0,(function(e){e?n(e):m(o,i,t.from.port,t.from.index,!1,(function(t){t?n(t):(r.connections.push(o),n())}))}))):a.component.once("ready",(function(){r.addEdge(t,n)})):n(new Error("No component defined for inbound node ".concat(t.to.node))):n(new Error("No process defined for inbound node ".concat(t.to.node)))}else i.component.once("ready",(function(){r.addEdge(t,n)}));else n(new Error("No component defined for outbound node ".concat(t.from.node)));else n(new Error("No process defined for outbound node ".concat(t.from.node)))}},{key:"removeEdge",value:function(t,e){var n=this;this.connections.forEach((function(r){r&&t.to.node===r.to.process.id&&t.to.port===r.to.port&&(r.to.process.component.inPorts[r.to.port].detach(r),t.from.node&&r.from&&t.from.node===r.from.process.id&&t.from.port===r.from.port&&r.from.process.component.outPorts[r.from.port].detach(r),n.connections.splice(n.connections.indexOf(r),1),e())}))}},{key:"addDefaults",value:function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={});var o=this.getNode(t.id);if(o)if(o.component){if(!o.component.isReady())return o.component.setMaxListeners(0),void o.component.once("ready",(function(){r.addDefaults(o,n)}));Object.keys(o.component.inPorts.ports).forEach((function(t){var e=o.component.inPorts.ports[t];if(e.hasDefault()&&!e.isAttached()){var n=l.createSocket();n.setDebug(r.debug),r.subscribeSocket(n),m(n,o,t,void 0,!0,(function(){})),r.connections.push(n),r.defaults.push(n)}})),n()}else n(new Error("No component defined for node ".concat(t.id)));else n(new Error("Process ".concat(t.id," not defined")))}},{key:"addInitial",value:function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={});var o=l.createSocket(t.metadata);o.setDebug(this.debug),this.subscribeSocket(o);var i=this.getNode(t.to.node);if(i){if(i.component)return i.component.isReady()||i.component.inPorts[t.to.port]?void m(o,i,t.to.port,t.to.index,!0,(function(e){if(e)n(e);else{r.connections.push(o);var i={socket:o,data:t.from.data};r.initials.push(i),r.nextInitials.push(i),r.isRunning()?r.sendInitials():r.isStopped()||(r.setStarted(!0),r.sendInitials()),n()}})):(i.component.setMaxListeners(0),void i.component.once("ready",(function(){r.addInitial(t,n)})));n(new Error("No component defined for inbound node ".concat(t.to.node)))}else n(new Error("No process defined for inbound node ".concat(t.to.node)))}},{key:"removeInitial",value:function(t,e){var n=this;this.connections.forEach((function(e){if(e&&t.to.node===e.to.process.id&&t.to.port===e.to.port){e.to.process.component.inPorts[e.to.port].detach(e),n.connections.splice(n.connections.indexOf(e),1);for(var r=0;r<n.initials.length;r+=1){var o=n.initials[r];if(!o)return;if(o.socket!==e)return;n.initials.splice(n.initials.indexOf(o),1)}for(var i=0;i<n.nextInitials.length;i+=1){var a=n.nextInitials[i];if(!a)return;if(a.socket!==e)return;n.nextInitials.splice(n.nextInitials.indexOf(a),1)}}})),e()}},{key:"sendInitials",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=function(){t.initials.forEach((function(t){g(t)})),t.initials=[],n()};void 0!==e&&e.execPath&&-1!==e.execPath.indexOf("node")?e.nextTick(r):setTimeout(r,0)}},{key:"isStarted",value:function(){return this.started}},{key:"isStopped",value:function(){return this.stopped}},{key:"isRunning",value:function(){return this.getActiveProcesses().length>0}},{key:"startComponents",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=0,r=this.processes?Object.keys(this.processes).length:0,o=function(t){t?e(t):(n+=1)===r&&e()};this.processes&&Object.keys(this.processes).length?Object.keys(this.processes).forEach((function(e){var n=t.processes[e];if(!n.component.isStarted())return 0===n.component.start.length?(p.deprecated("component.start method without callback is deprecated"),n.component.start(),void o()):void n.component.start(o);o()})):e()}},{key:"sendDefaults",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.defaults.length?(this.defaults.forEach((function(t){1===t.to.process.component.inPorts[t.to.port].sockets.length&&(t.connect(),t.send(),t.disconnect())})),t()):t()}},{key:"start",value:function(t){var e=this;t||(p.deprecated("Calling network.start() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),this.started?this.stop((function(n){n?t(n):e.start(t)})):(this.initials=this.nextInitials.slice(0),this.eventBuffer=[],this.startComponents((function(n){n?t(n):e.sendInitials((function(n){n?t(n):e.sendDefaults((function(n){n?t(n):(e.setStarted(!0),t(null))}))}))})))}},{key:"stop",value:function(t){var e=this;if(t||(p.deprecated("Calling network.stop() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),!this.started)return this.stopped=!0,void t(null);this.connections.forEach((function(t){t.isConnected()&&t.disconnect()}));var n=0,r=this.processes?Object.keys(this.processes).length:0,o=function(o){o?t(o):(n+=1)===r&&(e.setStarted(!1),e.stopped=!0,t())};if(!this.processes||!Object.keys(this.processes).length)return this.setStarted(!1),this.stopped=!0,void t();Object.keys(this.processes).forEach((function(t){var n=e.processes[t];if(n.component.isStarted())return 0===n.component.shutdown.length?(p.deprecated("component.shutdown method without callback is deprecated"),n.component.shutdown(),void o()):void n.component.shutdown(o);o()}))}},{key:"setStarted",value:function(t){if(this.started!==t){if(!t)return this.started=!1,void this.bufferedEmit("end",{start:this.startupDate,end:new Date,uptime:this.uptime()});this.startupDate||(this.startupDate=new Date),this.started=!0,this.stopped=!1,this.bufferedEmit("start",{start:this.startupDate})}}},{key:"checkIfFinished",value:function(){var t=this;this.isRunning()||(delete this.abortDebounce,this.debouncedEnd||(this.debouncedEnd=f.debounce((function(){t.abortDebounce||t.isRunning()||t.setStarted(!1)}),50)),this.debouncedEnd())}},{key:"getDebug",value:function(){return this.debug}},{key:"setDebug",value:function(t){var e=this;t!==this.debug&&(this.debug=t,this.connections.forEach((function(e){e.setDebug(t)})),Object.keys(this.processes).forEach((function(n){var r=e.processes[n].component;r.isSubgraph()&&r.network.setDebug(t)})))}}])&&o(n.prototype,r),s&&o(n,s),u}(u);t.exports=v}).call(this,n(1))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=n(2).EventEmitter,p=n(4)("noflo:component"),d=n(4)("noflo:component:brackets"),f=n(4)("noflo:component:send"),h=n(24),m=n(103),g=n(104),v=n(105),y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,t);var e,n,r,c=s(u);function u(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,u),t=c.call(this);var n=e;return n.inPorts||(n.inPorts={}),n.inPorts instanceof h.InPorts?t.inPorts=n.inPorts:t.inPorts=new h.InPorts(n.inPorts),n.outPorts||(n.outPorts={}),n.outPorts instanceof h.OutPorts?t.outPorts=n.outPorts:t.outPorts=new h.OutPorts(n.outPorts),t.icon=n.icon?n.icon:t.constructor.icon,t.description=n.description?n.description:t.constructor.description,t.started=!1,t.load=0,t.ordered=null!=n.ordered&&n.ordered,t.autoOrdering=null!=n.autoOrdering?n.autoOrdering:null,t.outputQ=[],t.bracketContext={in:{},out:{}},t.activateOnInput=null==n.activateOnInput||n.activateOnInput,t.forwardBrackets={in:["out","error"]},"forwardBrackets"in n&&(t.forwardBrackets=n.forwardBrackets),"function"==typeof n.process&&t.process(n.process),t}return e=u,(n=[{key:"getDescription",value:function(){return this.description}},{key:"isReady",value:function(){return!0}},{key:"isSubgraph",value:function(){return!1}},{key:"setIcon",value:function(t){this.icon=t,this.emit("icon",this.icon)}},{key:"getIcon",value:function(){return this.icon}},{key:"error",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"error",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.outPorts[r]&&(this.outPorts[r].isAttached()||!this.outPorts[r].isRequired()))return n.forEach((function(t){e.outPorts[r].openBracket(t,{scope:o})})),this.outPorts[r].data(t,{scope:o}),void n.forEach((function(t){e.outPorts[r].closeBracket(t,{scope:o})}));throw t}},{key:"setUp",value:function(t){t()}},{key:"tearDown",value:function(t){t()}},{key:"start",value:function(t){var e=this;this.isStarted()?t():this.setUp((function(n){n?t(n):(e.started=!0,e.emit("start"),t(null))}))}},{key:"shutdown",value:function(t){var e=this,n=function(){var n=e.inPorts.ports||e.inPorts;Object.keys(n).forEach((function(t){var e=n[t];"function"==typeof e.clear&&e.clear()})),e.bracketContext={in:{},out:{}},e.isStarted()?(e.started=!1,e.emit("end"),t()):t()};this.tearDown((function(r){r?t(r):e.load>0?e.on("deactivate",(function t(r){r>0||(e.removeListener("deactivate",t),n())})):n()}))}},{key:"isStarted",value:function(){return this.started}},{key:"prepareForwarding",value:function(){var t=this;Object.keys(this.forwardBrackets).forEach((function(e){var n=t.forwardBrackets[e];if(e in t.inPorts.ports){var r=[];n.forEach((function(e){e in t.outPorts.ports&&r.push(e)})),0===r.length?delete t.forwardBrackets[e]:t.forwardBrackets[e]=r}else delete t.forwardBrackets[e]}))}},{key:"isLegacy",value:function(){return!this.handle}},{key:"process",value:function(t){var e=this;if("function"!=typeof t)throw new Error("Process handler must be a function");if(!this.inPorts)throw new Error("Component ports must be defined before process function");return this.prepareForwarding(),this.handle=t,Object.keys(this.inPorts.ports).forEach((function(t){var n=e.inPorts.ports[t];n.name||(n.name=t),n.on("ip",(function(t){return e.handleIP(t,n)}))})),this}},{key:"isForwardingInport",value:function(t){return("string"==typeof t?t:t.name)in this.forwardBrackets}},{key:"isForwardingOutport",value:function(t,e){var n,r;return n="string"==typeof t?t:t.name,r="string"==typeof e?e:e.name,!!this.forwardBrackets[n]&&-1!==this.forwardBrackets[n].indexOf(r)}},{key:"isOrdered",value:function(){return!!this.ordered||!!this.autoOrdering}},{key:"handleIP",value:function(t,e){var n;if(e.options.triggering){"openBracket"!==t.type||null!==this.autoOrdering||this.ordered||(p("".concat(this.nodeId," port '").concat(e.name,"' entered auto-ordering mode")),this.autoOrdering=!0);var r={};if(this.isForwardingInport(e)){if("openBracket"===t.type)return;if("closeBracket"===t.type){var o=e.getBuffer(t.scope,t.index),i=o.filter((function(t){return"data"===t.type}));if(this.outputQ.length>=this.load&&0===i.length){if(o[0]!==t)return;e.get(t.scope,t.index),(n=this.getBracketContext("in",e.name,t.scope,t.index).pop()).closeIp=t,d("".concat(this.nodeId," closeBracket-C from '").concat(n.source,"' to ").concat(n.ports,": '").concat(t.data,"'")),r={__resolved:!0,__bracketClosingAfter:[n]},this.outputQ.push(r),this.processOutputQueue()}if(!i.length)return}}n=new m(t,this,e,r);var a=new g(this.inPorts,n),s=new v(this.outPorts,n);try{this.handle(a,s,n)}catch(t){this.deactivate(n),s.sendDone(t)}n.activated||(e.isAddressable()?p("".concat(this.nodeId," packet on '").concat(e.name,"[").concat(t.index,"]' didn't match preconditions: ").concat(t.type)):p("".concat(this.nodeId," packet on '").concat(e.name,"' didn't match preconditions: ").concat(t.type)))}}},{key:"getBracketContext",value:function(t,e,n,r){var o=h.normalizePortName(e),i=o.name,a=o.index;return null!=r&&(a=r),i=("in"===t?this.inPorts:this.outPorts)[i].isAddressable()?"".concat(i,"[").concat(a,"]"):e,this.bracketContext[t][i]||(this.bracketContext[t][i]={}),this.bracketContext[t][i][n]||(this.bracketContext[t][i][n]=[]),this.bracketContext[t][i][n]}},{key:"addToResult",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t,i=n,a=h.normalizePortName(e),s=a.name,c=a.index,u=r?"unshift":"push";if(this.outPorts[s].isAddressable()){var l=c?parseInt(c,10):i.index;return o[s]||(o[s]={}),o[s][l]||(o[s][l]=[]),i.index=l,void o[s][l][u](i)}o[s]||(o[s]=[]),o[s][u](i)}},{key:"getForwardableContexts",value:function(t,e,n){var r=this,o=h.normalizePortName(e),i=o.name,a=o.index,s=[];return n.forEach((function(n,o){if(r.isForwardingOutport(t,i)&&-1===n.ports.indexOf(e)){var c=r.getBracketContext("out",i,n.ip.scope,a)[o];c&&c.ip.data===n.ip.data&&-1!==c.ports.indexOf(e)||s.push(n)}})),s}},{key:"addBracketForwards",value:function(t){var e=this,n=t;(null!=n.__bracketClosingBefore?n.__bracketClosingBefore.length:void 0)&&n.__bracketClosingBefore.forEach((function(t){d("".concat(e.nodeId," closeBracket-A from '").concat(t.source,"' to ").concat(t.ports,": '").concat(t.closeIp.data,"'")),t.ports.length&&t.ports.forEach((function(r){var o=t.closeIp.clone();e.addToResult(n,r,o,!0),e.getBracketContext("out",r,o.scope).pop()}))})),n.__bracketContext&&Object.keys(n.__bracketContext).reverse().forEach((function(t){var r=n.__bracketContext[t];r.length&&Object.keys(n).forEach((function(o){var i,a,s=n[o];0!==o.indexOf("__")&&(e.outPorts[o].isAddressable()?Object.keys(s).forEach((function(c){var u=s[c];if(u.filter((function(t){return"data"===t.type})).length){var l="".concat(o,"[").concat(c,"]");(a=e.getForwardableContexts(t,l,r)).length&&(i=[],a.forEach((function(n){d("".concat(e.nodeId," openBracket from '").concat(t,"' to '").concat(l,"': '").concat(n.ip.data,"'"));var r=n.ip.clone();r.index=parseInt(c,10),i.push(r),n.ports.push(l),e.getBracketContext("out",o,n.ip.scope,c).push(n)})),i.reverse(),i.forEach((function(t){e.addToResult(n,o,t,!0)})))}})):s.filter((function(t){return"data"===t.type})).length&&(a=e.getForwardableContexts(t,o,r)).length&&(i=[],a.forEach((function(n){d("".concat(e.nodeId," openBracket from '").concat(t,"' to '").concat(o,"': '").concat(n.ip.data,"'")),i.push(n.ip.clone()),n.ports.push(o),e.getBracketContext("out",o,n.ip.scope).push(n)})),i.reverse(),i.forEach((function(t){e.addToResult(n,o,t,!0)}))))}))})),(null!=n.__bracketClosingAfter?n.__bracketClosingAfter.length:void 0)&&n.__bracketClosingAfter.forEach((function(t){d("".concat(e.nodeId," closeBracket-B from '").concat(t.source,"' to ").concat(t.ports,": '").concat(t.closeIp.data,"'")),t.ports.length&&t.ports.forEach((function(r){var o=t.closeIp.clone();e.addToResult(n,r,o,!1),e.getBracketContext("out",r,o.scope).pop()}))})),delete n.__bracketClosingBefore,delete n.__bracketContext,delete n.__bracketClosingAfter}},{key:"processOutputQueue",value:function(){for(var t=this,e=function(){if(!t.outputQ[0].__resolved)return"break";var e=t.outputQ.shift();t.addBracketForwards(e),Object.keys(e).forEach((function(n){var r,o=e[n];0!==n.indexOf("__")&&(t.outPorts.ports[n].isAddressable()?Object.keys(o).forEach((function(e){var i=o[e],a=parseInt(e,10);t.outPorts.ports[n].isAttached(a)&&i.forEach((function(e){var o=e;r="".concat(n,"[").concat(o.index,"]"),"openBracket"===o.type?f("".concat(t.nodeId," sending ").concat(r," < '").concat(o.data,"'")):"closeBracket"===o.type?f("".concat(t.nodeId," sending ").concat(r," > '").concat(o.data,"'")):f("".concat(t.nodeId," sending ").concat(r," DATA")),t.outPorts[n].options.scoped||(o.scope=null),t.outPorts[n].sendIP(o)}))})):t.outPorts.ports[n].isAttached()&&o.forEach((function(e){var o=e;r=n,"openBracket"===o.type?f("".concat(t.nodeId," sending ").concat(r," < '").concat(o.data,"'")):"closeBracket"===o.type?f("".concat(t.nodeId," sending ").concat(r," > '").concat(o.data,"'")):f("".concat(t.nodeId," sending ").concat(r," DATA")),t.outPorts[n].options.scoped||(o.scope=null),t.outPorts[n].sendIP(o)})))}))};this.outputQ.length>0&&"break"!==e(););}},{key:"activate",value:function(t){t.activated||(t.activated=!0,t.deactivated=!1,this.load+=1,this.emit("activate",this.load),(this.ordered||this.autoOrdering)&&this.outputQ.push(t.result))}},{key:"deactivate",value:function(t){t.deactivated||(t.deactivated=!0,t.activated=!1,this.isOrdered()&&this.processOutputQueue(),this.load-=1,this.emit("deactivate",this.load))}}])&&i(e.prototype,n),r&&i(e,r),u}(l);y.description="",y.icon=null,e.Component=y},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=n(2).EventEmitter,f=n(25),h=n(27),m=function(t){s(n,t);var e=u(n);function n(t,r){var i;return o(this,n),(i=e.call(this)).model=r,i.ports={},t?(Object.keys(t).forEach((function(e){var n=t[e];i.add(e,n)})),i):l(i)}return a(n,[{key:"add",value:function(t,e,n){if("add"===t||"remove"===t)throw new Error("Add and remove are restricted port names");if(!t.match(/^[a-z0-9_\.\/]+$/))throw new Error("Port names can only contain lowercase alphanumeric characters and underscores. '".concat(t,"' not allowed"));if(this.ports[t]&&this.remove(t),"object"===r(e)&&e.canAttach)this.ports[t]=e;else{var o=this.model;this.ports[t]=new o(e,n)}return this[t]=this.ports[t],this.emit("add",t),this}},{key:"remove",value:function(t){if(!this.ports[t])throw new Error("Port ".concat(t," not defined"));return delete this.ports[t],delete this[t],this.emit("remove",t),this}}]),n}(d);e.InPorts=function(t){s(n,t);var e=u(n);function n(t){return o(this,n),e.call(this,t,f)}return a(n,[{key:"on",value:function(t,e,n){if(!this.ports[t])throw new Error("Port ".concat(t," not available"));this.ports[t].on(e,n)}},{key:"once",value:function(t,e,n){if(!this.ports[t])throw new Error("Port ".concat(t," not available"));this.ports[t].once(e,n)}}]),n}(m),e.OutPorts=function(t){s(n,t);var e=u(n);function n(t){return o(this,n),e.call(this,t,h)}return a(n,[{key:"connect",value:function(t,e){if(!this.ports[t])throw new Error("Port ".concat(t," not available"));this.ports[t].connect(e)}},{key:"beginGroup",value:function(t,e,n){if(!this.ports[t])throw new Error("Port ".concat(t," not available"));this.ports[t].beginGroup(e,n)}},{key:"send",value:function(t,e,n){if(!this.ports[t])throw new Error("Port ".concat(t," not available"));this.ports[t].send(e,n)}},{key:"endGroup",value:function(t,e){if(!this.ports[t])throw new Error("Port ".concat(t," not available"));this.ports[t].endGroup(e)}},{key:"disconnect",value:function(t,e){if(!this.ports[t])throw new Error("Port ".concat(t," not available"));this.ports[t].disconnect(e)}}]),n}(m),e.normalizePortName=function(t){var e={name:t};if(-1===t.indexOf("["))return e;var n=t.match(/(.*)\[([0-9]+)\]/);return(null!=n?n.length:void 0)?{name:n[1],index:n[2]}:t}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=n(26);t.exports=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,t);var e,n,r,c=s(u);function u(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,u);var n=e;if(null==n.control&&(n.control=!1),null==n.scoped&&(n.scoped=!0),null==n.triggering&&(n.triggering=!0),n.process)throw new Error("InPort process callback is deprecated. Please use Process API");if(n.handle)throw new Error("InPort handle callback is deprecated. Please use Process API");return(t=c.call(this,n)).prepareBuffer(),t}return e=u,(n=[{key:"attachSocket",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.hasDefault()&&t.setDataDelegate((function(){return e.options.default})),t.on("connect",(function(){return e.handleSocketEvent("connect",t,n)})),t.on("begingroup",(function(t){return e.handleSocketEvent("begingroup",t,n)})),t.on("data",(function(t){return e.validateData(t),e.handleSocketEvent("data",t,n)})),t.on("endgroup",(function(t){return e.handleSocketEvent("endgroup",t,n)})),t.on("disconnect",(function(){return e.handleSocketEvent("disconnect",t,n)})),t.on("ip",(function(t){return e.handleIP(t,n)}))}},{key:"handleIP",value:function(t,e){if(!this.options.control||"data"===t.type){var n=t;n.owner=this.nodeInstance,this.isAddressable()&&(n.index=e),"all"===n.datatype&&(n.datatype=this.getDataType()),this.getSchema()&&!n.schema&&(n.schema=this.getSchema());var r=this.prepareBufferForIP(n);r.push(n),this.options.control&&r.length>1&&r.shift(),this.emit("ip",n,e)}}},{key:"handleSocketEvent",value:function(t,e,n){return this.isAddressable()?this.emit(t,e,n):this.emit(t,e)}},{key:"hasDefault",value:function(){return void 0!==this.options.default}},{key:"prepareBuffer",value:function(){if(this.isAddressable())return this.options.scoped&&(this.scopedBuffer={}),this.indexedBuffer={},void(this.iipBuffer={});this.options.scoped&&(this.scopedBuffer={}),this.iipBuffer=[],this.buffer=[]}},{key:"prepareBufferForIP",value:function(t){return this.isAddressable()?null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),t.index in this.scopedBuffer[t.scope]||(this.scopedBuffer[t.scope][t.index]=[]),this.scopedBuffer[t.scope][t.index]):t.initial?(t.index in this.iipBuffer||(this.iipBuffer[t.index]=[]),this.iipBuffer[t.index]):(t.index in this.indexedBuffer||(this.indexedBuffer[t.index]=[]),this.indexedBuffer[t.index]):null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),this.scopedBuffer[t.scope]):t.initial?this.iipBuffer:this.buffer}},{key:"validateData",value:function(t){if(this.options.values&&-1===this.options.values.indexOf(t))throw new Error("Invalid data='".concat(t,"' received, not in [").concat(this.options.values,"]"))}},{key:"getBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isAddressable()){if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;if(!(e in this.scopedBuffer[t]))return;return this.scopedBuffer[t][e]}if(n){if(!(e in this.iipBuffer))return;return this.iipBuffer[e]}if(!(e in this.indexedBuffer))return;return this.indexedBuffer[e]}if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;return this.scopedBuffer[t]}return n?this.iipBuffer:this.buffer}},{key:"getFromBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getBuffer(t,e,n);if(null!=r?r.length:void 0)return this.options.control?r[r.length-1]:r.shift()}},{key:"get",value:function(t,e){var n=this.getFromBuffer(t,e);return void 0!==n?n:this.getFromBuffer(null,e,!0)}},{key:"hasIPinBuffer",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.getBuffer(t,e,r);if(!(null!=o?o.length:void 0))return!1;for(var i=0;i<o.length;i+=1)if(n(o[i]))return!0;return!1}},{key:"hasIIP",value:function(t,e){return this.hasIPinBuffer(null,t,e,!0)}},{key:"has",value:function(t,e,n){var r=n,o=e;return this.isAddressable()||(r=o,o=null),!!this.hasIPinBuffer(t,o,r)||!!this.hasIIP(o,r)}},{key:"length",value:function(t,e){var n=this.getBuffer(t,e);return n?n.length:0}},{key:"ready",value:function(t){return this.length(t)>0}},{key:"clear",value:function(){return this.prepareBuffer()}}])&&i(e.prototype,n),r&&i(e,r),u}(l)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=c(t);if(e){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=n(2).EventEmitter,l=["all","string","number","int","object","array","boolean","color","date","bang","function","buffer","stream"];t.exports=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(c,t);var e,n,r,s=a(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=s.call(this)).options=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.datatype||"all";"integer"===e&&(e="int");var n=t.required||!1;if(-1===l.indexOf(e))throw new Error("Invalid port datatype '".concat(e,"' specified, valid are ").concat(l.join(", ")));var r=t.schema||t.type;if(r&&-1===r.indexOf("/"))throw new Error("Invalid port schema '".concat(r,"' specified. Should be URL or MIME type"));return Object.assign({},t,{datatype:e,required:n,schema:r})}(t),e.sockets=[],e.node=null,e.name=null,e}return e=c,(n=[{key:"getId",value:function(){return this.node&&this.name?"".concat(this.node," ").concat(this.name.toUpperCase()):"Port"}},{key:"getDataType",value:function(){return this.options.datatype}},{key:"getSchema",value:function(){return this.options.schema||null}},{key:"getDescription",value:function(){return this.options.description}},{key:"attach",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e;this.isAddressable()&&null!==e||(n=this.sockets.length),this.sockets[n]=t,this.attachSocket(t,n),this.isAddressable()?this.emit("attach",t,n):this.emit("attach",t)}},{key:"attachSocket",value:function(){}},{key:"detach",value:function(t){var e=this.sockets.indexOf(t);-1!==e&&(this.sockets[e]=void 0,this.isAddressable()?this.emit("detach",t,e):this.emit("detach",t))}},{key:"isAddressable",value:function(){return!!this.options.addressable}},{key:"isBuffered",value:function(){return!!this.options.buffered}},{key:"isRequired",value:function(){return!!this.options.required}},{key:"isAttached",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.isAddressable()&&null!==t?!!this.sockets[t]:!!this.sockets.length}},{key:"listAttached",value:function(){for(var t=[],e=0;e<this.sockets.length;e+=1)this.sockets[e]&&t.push(e);return t}},{key:"isConnected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.isAddressable()){if(null===t)throw new Error("".concat(this.getId(),": Socket ID required"));if(!this.sockets[t])throw new Error("".concat(this.getId(),": Socket ").concat(t," not available"));return this.sockets[t].isConnected()}var e=!1;return this.sockets.forEach((function(t){t&&t.isConnected()&&(e=!0)})),e}},{key:"canAttach",value:function(){return!0}}])&&o(e.prototype,n),r&&o(e,r),c}(u)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=n(26),d=n(6);t.exports=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,t);var e,n,r,u=c(p);function p(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,p);var n=e;return null==n.scoped&&(n.scoped=!0),(t=u.call(this,n)).cache={},t}return e=p,(n=[{key:"attach",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a(l(p.prototype),"attach",this).call(this,t,e),this.isCaching()&&null!=this.cache[e]&&this.send(this.cache[e],e)}},{key:"connect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getSockets(t);this.checkRequired(e),e.forEach((function(t){t&&t.connect()}))}},{key:"beginGroup",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getSockets(e);this.checkRequired(n),n.forEach((function(e){e&&e.beginGroup(t)}))}},{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getSockets(e);this.checkRequired(n),this.isCaching()&&t!==this.cache[e]&&(this.cache[e]=t),n.forEach((function(e){e&&e.send(t)}))}},{key:"endGroup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getSockets(t);this.checkRequired(e),e.forEach((function(t){t&&t.endGroup()}))}},{key:"disconnect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getSockets(t);this.checkRequired(e),e.forEach((function(t){t&&t.disconnect()}))}},{key:"sendIP",value:function(t,e,n,r){var o,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=r;d.isIP(t)?a=(o=t).index:o=new d(t,e,n);var s=this.getSockets(a);this.checkRequired(s),"all"===o.datatype&&(o.datatype=this.getDataType()),this.getSchema()&&!o.schema&&(o.schema=this.getSchema());var c=null!=this.cache[a]?this.cache[a].data:void 0;this.isCaching()&&e!==c&&(this.cache[a]=o);var u=!0;return s.forEach((function(t){t&&(u?(t.post(o,i),u=!1):(o.clonable&&(o=o.clone()),t.post(o,i)))})),this}},{key:"openBracket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sendIP("openBracket",t,e,n)}},{key:"data",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sendIP("data",t,e,n)}},{key:"closeBracket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sendIP("closeBracket",t,e,n)}},{key:"checkRequired",value:function(t){if(0===t.length&&this.isRequired())throw new Error("".concat(this.getId(),": No connections available"))}},{key:"getSockets",value:function(t){if(this.isAddressable()){if(null===t)throw new Error("".concat(this.getId()," Socket ID required"));return this.sockets[t]?[this.sockets[t]]:[]}return this.sockets}},{key:"isCaching",value:function(){return!!this.options.caching}}])&&i(e.prototype,n),r&&i(e,r),p}(p)},function(t,e){t.exports={stringPatterns:[/'[^]*?'/g,/"[^]*?"/g,/`[^]*?`/g],prePatterns:[/\[[^]*?\]/,/{[^]*?}/,/=>\s*?\([^]*?\)/,/=\s*?function\s*?\([^]*(?=[^]*\))/,/=\s*?\([^]*(?=[^]*\))/,/\s*?=[^>][^,\)]*/],postPatterns:[/\([^]*?\)/]}},function(t,e,n){const{EventEmitter:r}=n(2),o={Runtime:n(113),Graph:n(114),Network:n(115),Component:n(116)},i=n(4)("noflo-runtime-base:messaging:receive"),a=n(4)("noflo-runtime-base:messaging:receive:payload"),s=n(4)("noflo-runtime-base:messaging:send"),c=n(4)("noflo-runtime-base:messaging:send:payload"),{withNamespace:u}=n(15);t.exports=class extends r{constructor(t){super(),this.options=t,this.options||(this.options={}),this.version="0.7",this.component=new o.Component(this),this.graph=new o.Graph(this),this.network=new o.Network(this),this.runtime=new o.Runtime(this),this.context=null,null!=this.options.captureOutput&&this.options.captureOutput&&this.startCapture(),this.options.capabilities||(this.options.capabilities=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource","graph:readonly","network:data","network:control","network:status"]),this.options.defaultPermissions||(this.options.defaultPermissions=[]),this.options.permissions||(this.options.permissions={}),setTimeout(()=>{this._startDefaultGraph()},0)}getGraphName(t){const e=this.options.namespace||"default",n=t.name||"main";return u(n,e)}_startDefaultGraph(){if(!this.options.defaultGraph)return void this.emit("ready",null);this.options.defaultGraph.baseDir=this.options.baseDir;const t=this.getGraphName(this.options.defaultGraph);this.context="none",this.network._startNetwork(this.options.defaultGraph,t,this.context,(e,n)=>{e?this.emit("error",e):(this.graph.registerGraph(t,this.options.defaultGraph,!1),this.runtime.setMainGraph(t,this.options.defaultGraph),this.emit("ready",n))})}canDo(t,e){let n;n="string"==typeof t?[t]:t;const r=this.getPermitted(e);return n.filter(t=>r.includes(t)).length>0}canInput(t,e,n){if("graph"===t)return this.canDo(["protocol:graph"],n);switch(`${t}:${e}`){case"component:list":return this.canDo(["protocol:component"],n);case"component:getsource":return this.canDo(["component:getsource"],n);case"component:source":return this.canDo(["component:setsource"],n);case"network:edges":return this.canDo(["network:data","protocol:network"],n);case"network:start":case"network:stop":case"network:debug":return this.canDo(["network:control","protocol:network"],n);case"network:getstatus":return this.canDo(["network:status","network:control","protocol:network"],n);case"runtime:getruntime":return!0;case"runtime:packet":return this.canDo(["protocol:runtime"],n);default:return!1}}getPermitted(t){return t?this.options.permissions[t]?this.options.permissions[t]:[]:this.options.defaultPermissions}send(t,e,n){return s(`${t} ${e}`),c(n)}sendAll(){}receive(t,e,n={},r){i(`${t} ${e}`),a(n);const o=n?n.secret:null;if(this.canInput(t,e,o))switch(this.context=r,t){case"runtime":return void this.runtime.receive(e,n,r);case"graph":return void this.graph.receive(e,n,r);case"network":return void this.network.receive(e,n,r);case"component":return void this.component.receive(e,n,r);default:this.send(t,"error",new Error(`Protocol ${t} is not supported`),r)}else this.send(t,"error",new Error(`${t}:${e} is not permitted`),r)}},t.exports.trace=n(118),t.exports.direct=n(133)},function(t,e,n){(function(e){t.exports=b;var r=n(3),o=n(31),i=n(17),a=(i.Minimatch,n(129)),s=n(2).EventEmitter,c=n(5),u=n(16),l=n(18),p=n(130),d=n(32),f=(d.alphasort,d.alphasorti,d.setopts),h=d.ownProp,m=n(131),g=(n(9),d.childrenIgnored),v=d.isIgnored,y=n(34);function b(t,e,n){if("function"==typeof e&&(n=e,e={}),e||(e={}),e.sync){if(n)throw new TypeError("callback provided to sync glob");return p(t,e)}return new E(t,e,n)}b.sync=p;var w=b.GlobSync=p.GlobSync;function E(t,e,n){if("function"==typeof e&&(n=e,e=null),e&&e.sync){if(n)throw new TypeError("callback provided to sync glob");return new w(t,e)}if(!(this instanceof E))return new E(t,e,n);f(this,t,e),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),"function"==typeof n&&(n=y(n),this.on("error",n),this.on("end",(function(t){n(null,t)})));var o=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===r)return a();for(var i=0;i<r;i++)this._process(this.minimatch.set[i],i,!1,a);function a(){--o._processing,o._processing<=0&&o._finish()}}b.glob=b,b.hasMagic=function(t,e){var n=function(t,e){if(null===e||"object"!=typeof e)return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}({},e);n.noprocess=!0;var r=new E(t,n).minimatch.set;if(!t)return!1;if(r.length>1)return!0;for(var o=0;o<r[0].length;o++)if("string"!=typeof r[0][o])return!0;return!1},b.Glob=E,a(E,s),E.prototype._finish=function(){if(u(this instanceof E),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();d.finish(this),this.emit("end",this.found)}},E.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,n=0;n<this.matches.length;n++)this._realpathSet(n,r)}function r(){0==--t&&e._finish()}},E.prototype._realpathSet=function(t,e){var n=this.matches[t];if(!n)return e();var r=Object.keys(n),i=this,a=r.length;if(0===a)return e();var s=this.matches[t]=Object.create(null);r.forEach((function(n,r){n=i._makeAbs(n),o.realpath(n,i.realpathCache,(function(r,o){r?"stat"===r.syscall?s[n]=!0:i.emit("error",r):s[o]=!0,0==--a&&(i.matches[t]=s,e())}))}))},E.prototype._mark=function(t){return d.mark(this,t)},E.prototype._makeAbs=function(t){return d.makeAbs(this,t)},E.prototype.abort=function(){this.aborted=!0,this.emit("abort")},E.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},E.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var n=t[e];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<r.length;e++){var o=r[e];this._processing--,this._process(o[0],o[1],o[2],o[3])}}}},E.prototype._process=function(t,e,n,r){if(u(this instanceof E),u("function"==typeof r),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,n,r]);else{for(var o,a=0;"string"==typeof t[a];)a++;switch(a){case t.length:return void this._processSimple(t.join("/"),e,r);case 0:o=null;break;default:o=t.slice(0,a).join("/")}var s,c=t.slice(a);null===o?s=".":l(o)||l(t.join("/"))?(o&&l(o)||(o="/"+o),s=o):s=o;var p=this._makeAbs(s);if(g(this,s))return r();c[0]===i.GLOBSTAR?this._processGlobStar(o,s,p,c,e,n,r):this._processReaddir(o,s,p,c,e,n,r)}},E.prototype._processReaddir=function(t,e,n,r,o,i,a){var s=this;this._readdir(n,i,(function(c,u){return s._processReaddir2(t,e,n,r,o,i,u,a)}))},E.prototype._processReaddir2=function(t,e,n,r,o,i,a,s){if(!a)return s();for(var u=r[0],l=!!this.minimatch.negate,p=u._glob,d=this.dot||"."===p.charAt(0),f=[],h=0;h<a.length;h++){if("."!==(g=a[h]).charAt(0)||d)(l&&!t?!g.match(u):g.match(u))&&f.push(g)}var m=f.length;if(0===m)return s();if(1===r.length&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(h=0;h<m;h++){var g=f[h];t&&(g="/"!==t?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=c.join(this.root,g)),this._emitMatch(o,g)}return s()}r.shift();for(h=0;h<m;h++){g=f[h];t&&(g="/"!==t?t+"/"+g:t+g),this._process([g].concat(r),o,i,s)}s()},E.prototype._emitMatch=function(t,e){if(!this.aborted&&!v(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var n=l(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=n),!this.matches[t][e]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[t][e]=!0;var o=this.statCache[n];o&&this.emit("stat",e,o),this.emit("match",e)}}},E.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var n=this,o=m("lstat\0"+t,(function(r,o){if(r&&"ENOENT"===r.code)return e();var i=o&&o.isSymbolicLink();n.symlinks[t]=i,i||!o||o.isDirectory()?n._readdir(t,!1,e):(n.cache[t]="FILE",e())}));o&&r.lstat(t,o)}},E.prototype._readdir=function(t,e,n){if(!this.aborted&&(n=m("readdir\0"+t+"\0"+e,n))){if(e&&!h(this.symlinks,t))return this._readdirInGlobStar(t,n);if(h(this.cache,t)){var o=this.cache[t];if(!o||"FILE"===o)return n();if(Array.isArray(o))return n(null,o)}r.readdir(t,function(t,e,n){return function(r,o){r?t._readdirError(e,r,n):t._readdirEntries(e,o,n)}}(this,t,n))}},E.prototype._readdirEntries=function(t,e,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var o=e[r];o="/"===t?t+o:t+"/"+o,this.cache[o]=!0}return this.cache[t]=e,n(null,e)}},E.prototype._readdirError=function(t,e,n){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var o=new Error(e.code+" invalid cwd "+this.cwd);o.path=this.cwd,o.code=e.code,this.emit("error",o),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return n()}},E.prototype._processGlobStar=function(t,e,n,r,o,i,a){var s=this;this._readdir(n,i,(function(c,u){s._processGlobStar2(t,e,n,r,o,i,u,a)}))},E.prototype._processGlobStar2=function(t,e,n,r,o,i,a,s){if(!a)return s();var c=r.slice(1),u=t?[t]:[],l=u.concat(c);this._process(l,o,!1,s);var p=this.symlinks[n],d=a.length;if(p&&i)return s();for(var f=0;f<d;f++){if("."!==a[f].charAt(0)||this.dot){var h=u.concat(a[f],c);this._process(h,o,!0,s);var m=u.concat(a[f],r);this._process(m,o,!0,s)}}s()},E.prototype._processSimple=function(t,e,n){var r=this;this._stat(t,(function(o,i){r._processSimple2(t,e,o,i,n)}))},E.prototype._processSimple2=function(t,n,r,o,i){if(this.matches[n]||(this.matches[n]=Object.create(null)),!o)return i();if(t&&l(t)&&!this.nomount){var a=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=c.join(this.root,t):(t=c.resolve(this.root,t),a&&(t+="/"))}"win32"===e.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(n,t),i()},E.prototype._stat=function(t,e){var n=this._makeAbs(t),o="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&h(this.cache,n)){var i=this.cache[n];if(Array.isArray(i)&&(i="DIR"),!o||"DIR"===i)return e(null,i);if(o&&"FILE"===i)return e()}var a=this.statCache[n];if(void 0!==a){if(!1===a)return e(null,a);var s=a.isDirectory()?"DIR":"FILE";return o&&"FILE"===s?e():e(null,s,a)}var c=this,u=m("stat\0"+n,(function(o,i){if(i&&i.isSymbolicLink())return r.stat(n,(function(r,o){r?c._stat2(t,n,null,i,e):c._stat2(t,n,r,o,e)}));c._stat2(t,n,o,i,e)}));u&&r.lstat(n,u)},E.prototype._stat2=function(t,e,n,r,o){if(n&&("ENOENT"===n.code||"ENOTDIR"===n.code))return this.statCache[e]=!1,o();var i="/"===t.slice(-1);if(this.statCache[e]=r,"/"===e.slice(-1)&&r&&!r.isDirectory())return o(null,!1,r);var a=!0;return r&&(a=r.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,i&&"FILE"===a?o():o(null,a,r)}}).call(this,n(1))},function(t,e,n){(function(e){t.exports=l,l.realpath=l,l.sync=p,l.realpathSync=p,l.monkeypatch=function(){r.realpath=l,r.realpathSync=p},l.unmonkeypatch=function(){r.realpath=o,r.realpathSync=i};var r=n(3),o=r.realpath,i=r.realpathSync,a=e.version,s=/^v[0-5]\./.test(a),c=n(125);function u(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function l(t,e,n){if(s)return o(t,e,n);"function"==typeof e&&(n=e,e=null),o(t,e,(function(r,o){u(r)?c.realpath(t,e,n):n(r,o)}))}function p(t,e){if(s)return i(t,e);try{return i(t,e)}catch(n){if(u(n))return c.realpathSync(t,e);throw n}}}).call(this,n(1))},function(t,e,n){(function(t){function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.alphasort=u,e.alphasorti=c,e.setopts=function(e,n,i){i||(i={});if(i.matchBase&&-1===n.indexOf("/")){if(i.noglobstar)throw new Error("base matching requires globstar");n="**/"+n}e.silent=!!i.silent,e.pattern=n,e.strict=!1!==i.strict,e.realpath=!!i.realpath,e.realpathCache=i.realpathCache||Object.create(null),e.follow=!!i.follow,e.dot=!!i.dot,e.mark=!!i.mark,e.nodir=!!i.nodir,e.nodir&&(e.mark=!0);e.sync=!!i.sync,e.nounique=!!i.nounique,e.nonull=!!i.nonull,e.nosort=!!i.nosort,e.nocase=!!i.nocase,e.stat=!!i.stat,e.noprocess=!!i.noprocess,e.absolute=!!i.absolute,e.maxLength=i.maxLength||1/0,e.cache=i.cache||Object.create(null),e.statCache=i.statCache||Object.create(null),e.symlinks=i.symlinks||Object.create(null),function(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]);t.ignore.length&&(t.ignore=t.ignore.map(l))}(e,i),e.changedCwd=!1;var c=t.cwd();r(i,"cwd")?(e.cwd=o.resolve(i.cwd),e.changedCwd=e.cwd!==c):e.cwd=c;e.root=i.root||o.resolve(e.cwd,"/"),e.root=o.resolve(e.root),"win32"===t.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=a(e.cwd)?e.cwd:p(e,e.cwd),"win32"===t.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!i.nomount,i.nonegate=!0,i.nocomment=!0,e.minimatch=new s(n,i),e.options=e.minimatch.options},e.ownProp=r,e.makeAbs=p,e.finish=function(t){for(var e=t.nounique,n=e?[]:Object.create(null),r=0,o=t.matches.length;r<o;r++){var i=t.matches[r];if(i&&0!==Object.keys(i).length){var a=Object.keys(i);e?n.push.apply(n,a):a.forEach((function(t){n[t]=!0}))}else if(t.nonull){var s=t.minimatch.globSet[r];e?n.push(s):n[s]=!0}}e||(n=Object.keys(n));t.nosort||(n=n.sort(t.nocase?c:u));if(t.mark){for(r=0;r<n.length;r++)n[r]=t._mark(n[r]);t.nodir&&(n=n.filter((function(e){var n=!/\/$/.test(e),r=t.cache[e]||t.cache[p(t,e)];return n&&r&&(n="DIR"!==r&&!Array.isArray(r)),n})))}t.ignore.length&&(n=n.filter((function(e){return!d(t,e)})));t.found=n},e.mark=function(t,e){var n=p(t,e),r=t.cache[n],o=e;if(r){var i="DIR"===r||Array.isArray(r),a="/"===e.slice(-1);if(i&&!a?o+="/":!i&&a&&(o=o.slice(0,-1)),o!==e){var s=p(t,o);t.statCache[s]=t.statCache[n],t.cache[s]=t.cache[n]}}return o},e.isIgnored=d,e.childrenIgnored=function(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return!(!t.gmatcher||!t.gmatcher.match(e))}))};var o=n(5),i=n(17),a=n(18),s=i.Minimatch;function c(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function u(t,e){return t.localeCompare(e)}function l(t){var e=null;if("/**"===t.slice(-3)){var n=t.replace(/(\/\*\*)+$/,"");e=new s(n,{dot:!0})}return{matcher:new s(t,{dot:!0}),gmatcher:e}}function p(e,n){var r=n;return r="/"===n.charAt(0)?o.join(e.root,n):a(n)||""===n?n:e.changedCwd?o.resolve(e.cwd,n):o.resolve(n),"win32"===t.platform&&(r=r.replace(/\\/g,"/")),r}function d(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))}))}}).call(this,n(1))},function(t,e){t.exports=function t(e,n){if(e&&n)return t(e)(n);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){r[t]=e[t]})),r;function r(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];var r=e.apply(this,t),o=t[t.length-1];return"function"==typeof r&&r!==o&&Object.keys(o).forEach((function(t){r[t]=o[t]})),r}}},function(t,e,n){var r=n(33);function o(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function i(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},n=t.name||"Function wrapped with `once`";return e.onceError=n+" shouldn't be called more than once",e.called=!1,e}t.exports=r(o),t.exports.strict=r(i),o.proto=o((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return o(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})}))},function(t,e){e.normalizeOptions=function(t){const e=t;return void 0===t.catchExceptions&&(e.catchExceptions=!0,window.location.search&&"debug"===window.location.search.substring(1)&&(e.catchExceptions=!1)),e},e.subscribe=function(t,e){t.addEventListener("message",t=>{let{data:n}=t;"string"==typeof t.data&&(n=JSON.parse(t.data)),n.protocol&&n.command&&e(n,t)})}},function(t){t.exports=JSON.parse('{"properties":{"name":"main","environment":{"type":"noflo-browser","content":"<button id=\'button\'>Go!</button>\\n<p id=\'message\'></p>"},"icon":""},"inports":{},"outports":{},"groups":[],"processes":{"dom/GetElement_7amk2":{"component":"dom/GetElement","metadata":{"label":"dom/GetElement","x":252,"y":180,"width":72,"height":72}},"core/Output_cg49":{"component":"core/Output","metadata":{"label":"core/Output","x":432,"y":360,"width":72,"height":72}},"dom/WriteHtml_fpz6j":{"component":"dom/WriteHtml","metadata":{"label":"dom/WriteHtml","x":684,"y":288,"width":72,"height":72}},"dom/GetElement_xvz54":{"component":"dom/GetElement","metadata":{"label":"dom/GetElement","x":252,"y":288,"width":72,"height":72}},"interaction/ListenMouse_1l373":{"component":"interaction/ListenMouse","metadata":{"label":"interaction/ListenMouse","x":432,"y":180,"width":72,"height":72}},"core/Kick_ey1nh":{"component":"core/Kick","metadata":{"label":"core/Kick","x":576,"y":180,"width":72,"height":72}}},"connections":[{"src":{"process":"dom/GetElement_xvz54","port":"element"},"tgt":{"process":"dom/WriteHtml_fpz6j","port":"container"},"metadata":{}},{"src":{"process":"dom/GetElement_7amk2","port":"element"},"tgt":{"process":"interaction/ListenMouse_1l373","port":"element"},"metadata":{"route":0}},{"src":{"process":"dom/GetElement_7amk2","port":"error"},"tgt":{"process":"core/Output_cg49","port":"in"},"metadata":{"route":1}},{"src":{"process":"dom/GetElement_xvz54","port":"error"},"tgt":{"process":"core/Output_cg49","port":"in"},"metadata":{"route":1}},{"src":{"process":"interaction/ListenMouse_1l373","port":"click"},"tgt":{"process":"core/Kick_ey1nh","port":"in"},"metadata":{}},{"src":{"process":"core/Kick_ey1nh","port":"out"},"tgt":{"process":"dom/WriteHtml_fpz6j","port":"html"},"metadata":{}},{"data":"#button","tgt":{"process":"dom/GetElement_7amk2","port":"selector"}},{"data":"#message","tgt":{"process":"dom/GetElement_xvz54","port":"selector"}},{"data":"Hello World!","tgt":{"process":"core/Kick_ey1nh","port":"data"}}]}')},function(t,e,n){var r,o,i,a,s,c;({EventEmitter:r}=n(2)),i=n(19),s=n(41),o=function(){class t extends r{constructor(t="",e={}){super(),this.setMaxListeners(0),this.name=t,this.properties={},this.nodes=[],this.edges=[],this.initializers=[],this.inports={},this.outports={},this.groups=[],this.transaction={id:null,depth:0},this.caseSensitive=e.caseSensitive||!1}getPortName(t){return this.caseSensitive?t:t.toLowerCase()}startTransaction(t,e){if(this.transaction.id)throw Error("Nested transactions not supported");return this.transaction.id=t,this.transaction.depth=1,this.emit("startTransaction",t,e)}endTransaction(t,e){if(!this.transaction.id)throw Error("Attempted to end non-existing transaction");return this.transaction.id=null,this.transaction.depth=0,this.emit("endTransaction",t,e)}checkTransactionStart(){return this.transaction.id?"implicit"===this.transaction.id?this.transaction.depth+=1:void 0:this.startTransaction("implicit")}checkTransactionEnd(){if("implicit"===this.transaction.id&&(this.transaction.depth-=1),0===this.transaction.depth)return this.endTransaction("implicit")}setProperties(t){var e,n,r;for(n in this.checkTransactionStart(),e=i(this.properties),t)r=t[n],this.properties[n]=r;return this.emit("changeProperties",this.properties,e),this.checkTransactionEnd()}addInport(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.inports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addInport",t,this.inports[t]),this.checkTransactionEnd()}removeInport(t){var e;if(t=this.getPortName(t),this.inports[t])return this.checkTransactionStart(),e=this.inports[t],this.setInportMetadata(t,{}),delete this.inports[t],this.emit("removeInport",t,e),this.checkTransactionEnd()}renameInport(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.inports[t]&&e!==t)return this.checkTransactionStart(),this.inports[e]=this.inports[t],delete this.inports[t],this.emit("renameInport",t,e),this.checkTransactionEnd()}setInportMetadata(t,e){var n,r,o;if(t=this.getPortName(t),this.inports[t]){for(r in this.checkTransactionStart(),n=i(this.inports[t].metadata),this.inports[t].metadata||(this.inports[t].metadata={}),e)null!=(o=e[r])?this.inports[t].metadata[r]=o:delete this.inports[t].metadata[r];return this.emit("changeInport",t,this.inports[t],n,e),this.checkTransactionEnd()}}addOutport(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.outports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addOutport",t,this.outports[t]),this.checkTransactionEnd()}removeOutport(t){var e;if(t=this.getPortName(t),this.outports[t])return this.checkTransactionStart(),e=this.outports[t],this.setOutportMetadata(t,{}),delete this.outports[t],this.emit("removeOutport",t,e),this.checkTransactionEnd()}renameOutport(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.outports[t])return this.checkTransactionStart(),this.outports[e]=this.outports[t],delete this.outports[t],this.emit("renameOutport",t,e),this.checkTransactionEnd()}setOutportMetadata(t,e){var n,r,o;if(t=this.getPortName(t),this.outports[t]){for(r in this.checkTransactionStart(),n=i(this.outports[t].metadata),this.outports[t].metadata||(this.outports[t].metadata={}),e)null!=(o=e[r])?this.outports[t].metadata[r]=o:delete this.outports[t].metadata[r];return this.emit("changeOutport",t,this.outports[t],n,e),this.checkTransactionEnd()}}addGroup(t,e,n){var r;return this.checkTransactionStart(),r={name:t,nodes:e,metadata:n},this.groups.push(r),this.emit("addGroup",r),this.checkTransactionEnd()}renameGroup(t,e){var n,r,o,i;for(this.checkTransactionStart(),r=0,o=(i=this.groups).length;r<o;r++)(n=i[r])&&n.name===t&&(n.name=e,this.emit("renameGroup",t,e));return this.checkTransactionEnd()}removeGroup(t){var e,n,r,o;for(this.checkTransactionStart(),n=0,r=(o=this.groups).length;n<r;n++)(e=o[n])&&e.name===t&&(this.setGroupMetadata(e.name,{}),this.groups.splice(this.groups.indexOf(e),1),this.emit("removeGroup",e));return this.checkTransactionEnd()}setGroupMetadata(t,e){var n,r,o,a,s,c,u;for(this.checkTransactionStart(),o=0,s=(c=this.groups).length;o<s;o++)if((r=c[o])&&r.name===t){for(a in n=i(r.metadata),e)null!=(u=e[a])?r.metadata[a]=u:delete r.metadata[a];this.emit("changeGroup",r,n,e)}return this.checkTransactionEnd()}addNode(t,e,n){var r;return this.checkTransactionStart(),n||(n={}),r={id:t,component:e,metadata:n},this.nodes.push(r),this.emit("addNode",r),this.checkTransactionEnd(),r}removeNode(t){var e,n,r,o,i,a,s,c,u,l,p,d,f,h,m,g,v,y,b,w,E,k,S,P,O,_;if(y=this.getNode(t)){for(this.checkTransactionStart(),_=[],r=0,u=(E=this.edges).length;r<u;r++)(e=E[r]).from.node!==y.id&&e.to.node!==y.id||_.push(e);for(a=0,l=_.length;a<l;a++)e=_[a],this.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(_=[],s=0,p=(k=this.initializers).length;s<p;s++)(i=k[s]).to.node===y.id&&_.push(i);for(c=0,d=_.length;c<d;c++)i=_[c],this.removeInitial(i.to.node,i.to.port);for(w in _=[],S=this.inports)S[w].process===t&&_.push(w);for(g=0,f=_.length;g<f;g++)w=_[g],this.removeInport(w);for(w in _=[],P=this.outports)P[w].process===t&&_.push(w);for(v=0,h=_.length;v<h;v++)w=_[v],this.removeOutport(w);for(b=0,m=(O=this.groups).length;b<m;b++)(n=O[b])&&-1!==(o=n.nodes.indexOf(t))&&n.nodes.splice(o,1);return this.setNodeMetadata(t,{}),-1!==this.nodes.indexOf(y)&&this.nodes.splice(this.nodes.indexOf(y),1),this.emit("removeNode",y),this.checkTransactionEnd()}}getNode(t){var e,n,r,o;for(e=0,n=(o=this.nodes).length;e<n;e++)if((r=o[e])&&r.id===t)return r;return null}renameNode(t,e){var n,r,o,i,a,s,c,u,l,p,d,f,h,m,g,v,y,b;if(this.checkTransactionStart(),d=this.getNode(t)){for(d.id=e,o=0,u=(m=this.edges).length;o<u;o++)(n=m[o])&&(n.from.node===t&&(n.from.node=e),n.to.node===t&&(n.to.node=e));for(s=0,l=(g=this.initializers).length;s<l;s++)(i=g[s])&&i.to.node===t&&(i.to.node=e);for(h in v=this.inports)(f=v[h]).process===t&&(f.process=e);for(h in y=this.outports)(f=y[h]).process===t&&(f.process=e);for(c=0,p=(b=this.groups).length;c<p;c++)(r=b[c])&&-1!==(a=r.nodes.indexOf(t))&&(r.nodes[a]=e);return this.emit("renameNode",t,e),this.checkTransactionEnd()}}setNodeMetadata(t,e){var n,r,o,a;if(o=this.getNode(t)){for(r in this.checkTransactionStart(),n=i(o.metadata),o.metadata||(o.metadata={}),e)null!=(a=e[r])?o.metadata[r]=a:delete o.metadata[r];return this.emit("changeNode",o,n,e),this.checkTransactionEnd()}}addEdge(t,e,n,r,o={}){var i,a,s,c;for(e=this.getPortName(e),r=this.getPortName(r),a=0,s=(c=this.edges).length;a<s;a++)if((i=c[a]).from.node===t&&i.from.port===e&&i.to.node===n&&i.to.port===r)return;if(this.getNode(t)&&this.getNode(n))return this.checkTransactionStart(),i={from:{node:t,port:e},to:{node:n,port:r},metadata:o},this.edges.push(i),this.emit("addEdge",i),this.checkTransactionEnd(),i}addEdgeIndex(t,e,n,r,o,i,a={}){var s;if(this.getNode(t)&&this.getNode(r))return e=this.getPortName(e),o=this.getPortName(o),null===i&&(i=void 0),null===n&&(n=void 0),a||(a={}),this.checkTransactionStart(),s={from:{node:t,port:e,index:n},to:{node:r,port:o,index:i},metadata:a},this.edges.push(s),this.emit("addEdge",s),this.checkTransactionEnd(),s}removeEdge(t,e,n,r){var o,i,a,s,c,u,l,p,d,f,h,m;if(this.checkTransactionStart(),e=this.getPortName(e),r=this.getPortName(r),m=[],h=[],n&&r)for(a=i=0,u=(d=this.edges).length;i<u;a=++i)(o=d[a]).from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),m.push(o)):h.push(o);else for(a=s=0,l=(f=this.edges).length;s<l;a=++s)(o=f[a]).from.node===t&&o.from.port===e||o.to.node===t&&o.to.port===e?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),m.push(o)):h.push(o);for(this.edges=h,c=0,p=m.length;c<p;c++)o=m[c],this.emit("removeEdge",o);return this.checkTransactionEnd()}getEdge(t,e,n,r){var o,i,a,s,c;for(e=this.getPortName(e),r=this.getPortName(r),a=i=0,s=(c=this.edges).length;i<s;a=++i)if((o=c[a])&&o.from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r)return o;return null}setEdgeMetadata(t,e,n,r,o){var a,s,c,u;if(s=this.getEdge(t,e,n,r)){for(c in this.checkTransactionStart(),a=i(s.metadata),s.metadata||(s.metadata={}),o)null!=(u=o[c])?s.metadata[c]=u:delete s.metadata[c];return this.emit("changeEdge",s,a,o),this.checkTransactionEnd()}}addInitial(t,e,n,r){var o;if(this.getNode(e))return n=this.getPortName(n),this.checkTransactionStart(),o={from:{data:t},to:{node:e,port:n},metadata:r},this.initializers.push(o),this.emit("addInitial",o),this.checkTransactionEnd(),o}addInitialIndex(t,e,n,r,o){var i;if(this.getNode(e))return null===r&&(r=void 0),n=this.getPortName(n),this.checkTransactionStart(),i={from:{data:t},to:{node:e,port:n,index:r},metadata:o},this.initializers.push(i),this.emit("addInitial",i),this.checkTransactionEnd(),i}addGraphInitial(t,e,n){var r;if(r=this.inports[e])return this.addInitial(t,r.process,r.port,n)}addGraphInitialIndex(t,e,n,r){var o;if(o=this.inports[e])return this.addInitialIndex(t,o.process,o.port,n,r)}removeInitial(t,e){var n,r,o,i,a,s,c,u,l;for(e=this.getPortName(e),this.checkTransactionStart(),l=[],u=[],o=r=0,a=(c=this.initializers).length;r<a;o=++r)(n=c[o]).to.node===t&&n.to.port===e?l.push(n):u.push(n);for(this.initializers=u,i=0,s=l.length;i<s;i++)n=l[i],this.emit("removeInitial",n);return this.checkTransactionEnd()}removeGraphInitial(t){var e;if(e=this.inports[t])return this.removeInitial(e.process,e.port)}toDOT(){var t,e,n,r,o,i,a,s,c,u,l,p,d,f,h,m;for(t=function(t){return t.replace(/\s*/g,"")},e=function(t){return t.replace(/\./g,"")},n="digraph {\n",o=0,u=(f=this.nodes).length;o<u;o++)n+=`    ${t((d=f[o]).id)} [label=${d.id} shape=box]\n`;for(i=s=0,l=(h=this.initializers).length;s<l;i=++s)n+=`    data${i} [label="'${"function"==typeof(a=h[i]).from.data?"Function":a.from.data}'" shape=plaintext]\n`,n+=`    data${i} -> ${t(a.to.node)}[headlabel=${e(a.to.port)} labelfontcolor=blue labelfontsize=8.0]\n`;for(c=0,p=(m=this.edges).length;c<p;c++)n+=`    ${t((r=m[c]).from.node)} -> ${t(r.to.node)}[taillabel=${e(r.from.port)} headlabel=${e(r.to.port)} labelfontcolor=blue labelfontsize=8.0]\n`;return n+="}"}toYUML(){var t,e,n,r,o,i,a,s,c;for(c=[],e=0,o=(a=this.initializers).length;e<o;e++)n=a[e],c.push(`(start)[${n.to.port}]->(${n.to.node})`);for(r=0,i=(s=this.edges).length;r<i;r++)t=s[r],c.push(`(${t.from.node})[${t.from.port}]->(${t.to.node})`);return c.join(",")}toJSON(){var t,e,n,r,o,i,a,s,c,u,l,p,d,f,h,m,g,v,y,b,w,E,k,S,P,O;for(g in s={caseSensitive:this.caseSensitive,properties:{},inports:{},outports:{},groups:[],processes:{},connections:[]},this.name&&(s.properties.name=this.name),y=this.properties)O=y[g],s.properties[g]=O;for(v in b=this.inports)m=b[v],s.inports[v]=m;for(v in w=this.outports)m=w[v],s.outports[v]=m;for(o=0,l=(E=this.groups).length;o<l;o++)r={name:(n=E[o]).name,nodes:n.nodes},Object.keys(n.metadata).length&&(r.metadata=n.metadata),s.groups.push(r);for(a=0,p=(k=this.nodes).length;a<p;a++)h=k[a],s.processes[h.id]={component:h.component},h.metadata&&(s.processes[h.id].metadata=h.metadata);for(c=0,d=(S=this.edges).length;c<d;c++)t={src:{process:(e=S[c]).from.node,port:e.from.port,index:e.from.index},tgt:{process:e.to.node,port:e.to.port,index:e.to.index}},Object.keys(e.metadata).length&&(t.metadata=e.metadata),s.connections.push(t);for(u=0,f=(P=this.initializers).length;u<f;u++)i=P[u],s.connections.push({data:i.from.data,tgt:{process:i.to.node,port:i.to.port,index:i.to.index}});return s}save(t,e){var r;return s.isBrowser()?e(new Error("Saving graphs not supported on browser")):(r=JSON.stringify(this.toJSON(),null,4),t.match(/\.json$/)||(t+=".json"),n(3).writeFile(t,r,"utf-8",(function(n,r){return n?e(n):e(null,t)})))}}return t.prototype.name="",t.prototype.caseSensitive=!1,t.prototype.properties={},t.prototype.nodes=[],t.prototype.edges=[],t.prototype.initializers=[],t.prototype.inports={},t.prototype.outports={},t.prototype.groups=[],t}.call(this),e.Graph=o,e.createGraph=function(t,e){return new o(t,e)},e.loadJSON=function(t,e,n={}){var r,i,a,s,c,u,l,p,d,f,h,m,g,v,y,b,w,E,k,S,P,O;for(v in(s="string"==typeof t?JSON.parse(t):JSON.parse(JSON.stringify(t))).properties||(s.properties={}),s.processes||(s.processes={}),s.connections||(s.connections=[]),r=s.caseSensitive||!1,(c=new o(s.properties.name,{caseSensitive:r})).startTransaction("loadJSON",n),g={},b=s.properties)O=b[v],"name"!==v&&(g[v]=O);for(p in c.setProperties(g),w=s.processes)(a=w[p]).metadata||(a.metadata={}),c.addNode(p,a.component,a.metadata);for(l=0,f=(E=s.connections).length;l<f;l++)n=(i=E[l]).metadata?i.metadata:{},void 0===i.data?"number"!=typeof i.src.index&&"number"!=typeof i.tgt.index?c.addEdge(i.src.process,c.getPortName(i.src.port),i.tgt.process,c.getPortName(i.tgt.port),n):c.addEdgeIndex(i.src.process,c.getPortName(i.src.port),i.src.index,i.tgt.process,c.getPortName(i.tgt.port),i.tgt.index,n):"number"==typeof i.tgt.index?c.addInitialIndex(i.data,i.tgt.process,c.getPortName(i.tgt.port),i.tgt.index,n):c.addInitial(i.data,i.tgt.process,c.getPortName(i.tgt.port),n);if(s.inports)for(y in k=s.inports)m=k[y],c.addInport(y,m.process,c.getPortName(m.port),m.metadata);if(s.outports)for(y in S=s.outports)m=S[y],c.addOutport(y,m.process,c.getPortName(m.port),m.metadata);if(s.groups)for(d=0,h=(P=s.groups).length;d<h;d++)u=P[d],c.addGroup(u.name,u.nodes,u.metadata||{});return c.endTransaction("loadJSON"),e(null,c)},e.loadFBP=function(t,r,o={},i=!1){var a;try{a=n(42).parse(t,{caseSensitive:i})}catch(t){return r(t)}return e.loadJSON(a,r,o)},e.loadHTTP=function(t,e){var n;return(n=new XMLHttpRequest).onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?e(new Error(`Failed to load ${t}: HTTP ${n.status}`)):e(null,n.responseText)},n.open("GET",t,!0),n.send()},e.loadFile=function(t,r,o={},i=!1){if(!s.isBrowser())return n(3).readFile(t,"utf-8",(function(n,o){var a;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(o,r,{},i):(a=JSON.parse(o),e.loadJSON(a,r,{}))}));e.loadHTTP(t,(function(n,i){var a;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(i,r,o):(a=JSON.parse(i),e.loadJSON(a,r,o))}))},c=function(t){var e,n,r,o,a,s,c,u,l,p,d,f,h,m,g,v,y,b,w,E;for(r=0,u=(m=i(t.groups).reverse()).length;r<u;r++)null!=(n=m[r])&&t.removeGroup(n.name);for(h in g=i(t.outports))g[h],t.removeOutport(h);for(h in v=i(t.inports))v[h],t.removeInport(h);for(t.setProperties({}),a=0,l=(y=i(t.initializers).reverse()).length;a<l;a++)o=y[a],t.removeInitial(o.to.node,o.to.port);for(s=0,p=(b=i(t.edges).reverse()).length;s<p;s++)e=b[s],t.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(E=[],c=0,d=(w=i(t.nodes).reverse()).length;c<d;c++)f=w[c],E.push(t.removeNode(f.id));return E},a=function(t,e){var n,r,o,i,a,s,u,l,p,d,f,h,m,g,v,y,b,w,E,k,S;for(c(t),o=0,l=(v=e.nodes).length;o<l;o++)h=v[o],t.addNode(h.id,h.component,h.metadata);for(a=0,p=(y=e.edges).length;a<p;a++)n=y[a],t.addEdge(n.from.node,n.from.port,n.to.node,n.to.port,n.metadata);for(s=0,d=(b=e.initializers).length;s<d;s++)i=b[s],t.addInitial(i.from.data,i.to.node,i.to.port,i.metadata);for(g in t.setProperties(e.properties),w=e.inports)m=w[g],t.addInport(g,m.process,m.port,m.metadata);for(g in E=e.outports)m=E[g],t.addOutport(g,m.process,m.port,m.metadata);for(S=[],u=0,f=(k=e.groups).length;u<f;u++)r=k[u],S.push(t.addGroup(r.name,r.nodes,r.metadata));return S},e.equivalent=function(t,e,n={}){return JSON.stringify(t)===JSON.stringify(e)},e.mergeResolveTheirs=a},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=u(t),a=r[0],s=r[1],c=new i(function(t,e,n){return 3*(e+n)/4-n}(0,a,s)),l=0,p=s>0?a-4:a;for(n=0;n<p;n+=4)e=o[t.charCodeAt(n)]<<18|o[t.charCodeAt(n+1)]<<12|o[t.charCodeAt(n+2)]<<6|o[t.charCodeAt(n+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;2===s&&(e=o[t.charCodeAt(n)]<<2|o[t.charCodeAt(n+1)]>>4,c[l++]=255&e);1===s&&(e=o[t.charCodeAt(n)]<<10|o[t.charCodeAt(n+1)]<<4|o[t.charCodeAt(n+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e);return c},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(l(t,a,a+16383>s?s:a+16383));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var o,i,a=[],s=e;s<n;s+=3)o=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,u=c>>1,l=-7,p=n?o-1:0,d=n?-1:1,f=t[e+p];for(p+=d,i=f&(1<<-l)-1,f>>=-l,l+=s;l>0;i=256*i+t[e+p],p+=d,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+t[e+p],p+=d,l-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),i-=u}return(f?-1:1)*a*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var a,s,c,u=8*i-o-1,l=(1<<u)-1,p=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,h=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),(e+=a+p>=1?d/c:d*Math.pow(2,1-p))*c>=2&&(a++,c/=2),a+p>=l?(s=0,a=l):a+p>=1?(s=(e*c-1)*Math.pow(2,o),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,o),a=0));o>=8;t[n+f]=255&s,f+=h,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;t[n+f]=255&a,f+=h,a/=256,u-=8);t[n+f-h]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(t){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(!e.isBrowser()){if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);return console.warn(n)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}).call(this,n(1))},function(t,e,n){t.exports=function(){"use strict";function t(e,n,r,o){this.message=e,this.expected=n,this.found=r,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(t,Error),{SyntaxError:t,parse:function(e){var r,o,i=arguments.length>1?arguments[1]:{},a=this,s={},c={start:pn},u=pn,l=function(){return a.getResult()},p="INPORT=",d={type:"literal",value:"INPORT=",description:'"INPORT="'},f=".",h={type:"literal",value:".",description:'"."'},m=":",g={type:"literal",value:":",description:'":"'},v=function(t,e,n){return a.registerInports(t,e,n)},y="OUTPORT=",b={type:"literal",value:"OUTPORT=",description:'"OUTPORT="'},w=function(t,e,n){return a.registerOutports(t,e,n)},E="DEFAULT_INPORT=",k={type:"literal",value:"DEFAULT_INPORT=",description:'"DEFAULT_INPORT="'},S=function(t){yr=t},P="DEFAULT_OUTPORT=",O={type:"literal",value:"DEFAULT_OUTPORT=",description:'"DEFAULT_OUTPORT="'},_=function(t){br=t},C=function(t){return a.registerAnnotation(t[0],t[1])},A=function(t){return a.registerEdges(t)},x=",",I={type:"literal",value:",",description:'","'},D=/^[\n\r\u2028\u2029]/,N={type:"class",value:"[\\n\\r\\u2028\\u2029]",description:"[\\n\\r\\u2028\\u2029]"},R="#",T={type:"literal",value:"#",description:'"#"'},j="->",L={type:"literal",value:"->",description:'"->"'},M=function(t,e){return[t,e]},B=function(t,e,n){return[{tgt:_r(e,t)},{src:Cr(e,n)}]},U=function(t,e){return{src:Cr(t,e)}},F=function(t,e){return{tgt:_r(e,t)}},G="'",H={type:"literal",value:"'",description:'"\'"'},q=function(t){return{data:t.join("")}},z=function(t){return{data:t}},$=function(t){return t},X=/^[a-zA-Z_]/,Y={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},J=/^[a-zA-Z0-9_\-]/,K={type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},W=function(t){return Pr(t)},V=function(t,e){return a.addNode(t,e),t},Z=function(t){return a.addAnonymousNode(t,an().start.offset)},Q="(",tt={type:"literal",value:"(",description:'"("'},et=/^[a-zA-Z\/\-0-9_]/,nt={type:"class",value:"[a-zA-Z/\\-0-9_]",description:"[a-zA-Z/\\-0-9_]"},rt=")",ot={type:"literal",value:")",description:'")"'},it=function(t,e){var n={};return n.comp=t?t.join(""):"",e&&(n.meta=e.join("").split(",")),n},at=/^[a-zA-Z\/=_,0-9]/,st={type:"class",value:"[a-zA-Z/=_,0-9]",description:"[a-zA-Z/=_,0-9]"},ct=function(t){return t},ut="@",lt={type:"literal",value:"@",description:'"@"'},pt=/^[a-zA-Z0-9\-_]/,dt={type:"class",value:"[a-zA-Z0-9\\-_]",description:"[a-zA-Z0-9\\-_]"},ft=/^[a-zA-Z0-9\-_ .]/,ht={type:"class",value:"[a-zA-Z0-9\\-_ \\.]",description:"[a-zA-Z0-9\\-_ \\.]"},mt=function(t,e){return[t.join(""),e.join("")]},gt=function(t,e){return{port:i.caseSensitive?t:t.toLowerCase(),index:null!=e?e:void 0}},vt=function(t){return t},yt=/^[a-zA-Z.0-9_]/,bt={type:"class",value:"[a-zA-Z.0-9_]",description:"[a-zA-Z.0-9_]"},wt=function(t){return Pr(t)},Et="[",kt={type:"literal",value:"[",description:'"["'},St=/^[0-9]/,Pt={type:"class",value:"[0-9]",description:"[0-9]"},Ot="]",_t={type:"literal",value:"]",description:'"]"'},Ct=function(t){return parseInt(t.join(""))},At=/^[^\n\r\u2028\u2029]/,xt={type:"class",value:"[^\\n\\r\\u2028\\u2029]",description:"[^\\n\\r\\u2028\\u2029]"},It=/^[\\]/,Dt={type:"class",value:"[\\\\]",description:"[\\\\]"},Nt=/^[']/,Rt={type:"class",value:"[']",description:"[']"},Tt=function(){return"'"},jt=/^[^']/,Lt={type:"class",value:"[^']",description:"[^']"},Mt=" ",Bt={type:"literal",value:" ",description:'" "'},Ut=function(t){return t},Ft="{",Gt={type:"literal",value:"{",description:'"{"'},Ht="}",qt={type:"literal",value:"}",description:'"}"'},zt={type:"other",description:"whitespace"},$t=/^[ \t\n\r]/,Xt={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},Yt="false",Jt={type:"literal",value:"false",description:'"false"'},Kt=function(){return!1},Wt="null",Vt={type:"literal",value:"null",description:'"null"'},Zt=function(){return null},Qt="true",te={type:"literal",value:"true",description:'"true"'},ee=function(){return!0},ne=function(t,e){return e},re=function(t,e){var n,r={};for(r[t.name]=t.value,n=0;n<e.length;n++)r[e[n].name]=e[n].value;return r},oe=function(t){return null!==t?t:{}},ie=function(t,e){return{name:t,value:e}},ae=function(t,e){return e},se=function(t,e){return[t].concat(e)},ce=function(t){return null!==t?t:[]},ue={type:"other",description:"number"},le=function(){return parseFloat(on())},pe=/^[1-9]/,de={type:"class",value:"[1-9]",description:"[1-9]"},fe=/^[eE]/,he={type:"class",value:"[eE]",description:"[eE]"},me="-",ge={type:"literal",value:"-",description:'"-"'},ve="+",ye={type:"literal",value:"+",description:'"+"'},be="0",we={type:"literal",value:"0",description:'"0"'},Ee={type:"other",description:"string"},ke=function(t){return t.join("")},Se='"',Pe={type:"literal",value:'"',description:'"\\""'},Oe="\\",_e={type:"literal",value:"\\",description:'"\\\\"'},Ce="/",Ae={type:"literal",value:"/",description:'"/"'},xe="b",Ie={type:"literal",value:"b",description:'"b"'},De=function(){return"\b"},Ne="f",Re={type:"literal",value:"f",description:'"f"'},Te=function(){return"\f"},je="n",Le={type:"literal",value:"n",description:'"n"'},Me=function(){return"\n"},Be="r",Ue={type:"literal",value:"r",description:'"r"'},Fe=function(){return"\r"},Ge="t",He={type:"literal",value:"t",description:'"t"'},qe=function(){return"\t"},ze="u",$e={type:"literal",value:"u",description:'"u"'},Xe=function(t){return String.fromCharCode(parseInt(t,16))},Ye=function(t){return t},Je=/^[^\0-\x1F"\\]/,Ke={type:"class",value:"[^\\0-\\x1F\\x22\\x5C]",description:"[^\\0-\\x1F\\x22\\x5C]"},We=/^[0-9a-f]/i,Ve={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},Ze=0,Qe=0,tn=[{line:1,column:1,seenCR:!1}],en=0,nn=[],rn=0;if("startRule"in i){if(!(i.startRule in c))throw new Error("Can't start parsing from rule \""+i.startRule+'".');u=c[i.startRule]}function on(){return e.substring(Qe,Ze)}function an(){return cn(Qe,Ze)}function sn(t){var n,r,o=tn[t];if(o)return o;for(n=t-1;!tn[n];)n--;for(o={line:(o=tn[n]).line,column:o.column,seenCR:o.seenCR};n<t;)"\n"===(r=e.charAt(n))?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),n++;return tn[t]=o,o}function cn(t,e){var n=sn(t),r=sn(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function un(t){Ze<en||(Ze>en&&(en=Ze,nn=[]),nn.push(t))}function ln(e,n,r,o){return null!==n&&function(t){var e=1;for(t.sort((function(t,e){return t.description<e.description?-1:t.description>e.description?1:0}));e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}(n),new t(null!==e?e:function(t,e){var n,r=new Array(t.length);for(n=0;n<t.length;n++)r[n]=t[n].description;return"Expected "+(t.length>1?r.slice(0,-1).join(", ")+" or "+r[t.length-1]:r[0])+" but "+(e?'"'+function(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,(function(t){return"\\x0"+e(t)})).replace(/[\x10-\x1F\x80-\xFF]/g,(function(t){return"\\x"+e(t)})).replace(/[\u0100-\u0FFF]/g,(function(t){return"\\u0"+e(t)})).replace(/[\u1000-\uFFFF]/g,(function(t){return"\\u"+e(t)}))}(e)+'"':"end of input")+" found."}(n,r),n,r,o)}function pn(){var t,e,n;for(t=Ze,e=[],n=dn();n!==s;)e.push(n),n=dn();return e!==s&&(Qe=t,e=l()),t=e}function dn(){var t,n,r,o,i,a,c,u,l;return t=Ze,(n=Bn())!==s?(e.substr(Ze,7)===p?(r=p,Ze+=7):(r=s,0===rn&&un(d)),r!==s&&(o=Sn())!==s?(46===e.charCodeAt(Ze)?(i=f,Ze++):(i=s,0===rn&&un(h)),i!==s&&(a=Tn())!==s?(58===e.charCodeAt(Ze)?(c=m,Ze++):(c=s,0===rn&&un(g)),c!==s&&(u=Tn())!==s&&Bn()!==s?((l=fn())===s&&(l=null),l!==s?(Qe=t,t=n=v(o,a,u)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s),t===s&&(t=Ze,(n=Bn())!==s?(e.substr(Ze,8)===y?(r=y,Ze+=8):(r=s,0===rn&&un(b)),r!==s&&(o=Sn())!==s?(46===e.charCodeAt(Ze)?(i=f,Ze++):(i=s,0===rn&&un(h)),i!==s&&(a=Tn())!==s?(58===e.charCodeAt(Ze)?(c=m,Ze++):(c=s,0===rn&&un(g)),c!==s&&(u=Tn())!==s&&Bn()!==s?((l=fn())===s&&(l=null),l!==s?(Qe=t,t=n=w(o,a,u)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s),t===s&&(t=Ze,(n=Bn())!==s?(e.substr(Ze,15)===E?(r=E,Ze+=15):(r=s,0===rn&&un(k)),r!==s&&(o=Tn())!==s&&(i=Bn())!==s?((a=fn())===s&&(a=null),a!==s?(Qe=t,t=n=S(o)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s),t===s&&(t=Ze,(n=Bn())!==s?(e.substr(Ze,16)===P?(r=P,Ze+=16):(r=s,0===rn&&un(O)),r!==s&&(o=Tn())!==s&&(i=Bn())!==s?((a=fn())===s&&(a=null),a!==s?(Qe=t,t=n=_(o)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s),t===s&&(t=Ze,(n=In())!==s&&(r=hn())!==s?(Qe=t,t=n=C(n)):(Ze=t,t=s),t===s&&(t=Ze,(n=mn())!==s?((r=hn())===s&&(r=null),r!==s?t=n=[n,r]:(Ze=t,t=s)):(Ze=t,t=s),t===s&&(t=Ze,(n=Bn())!==s&&(r=hn())!==s?t=n=[n,r]:(Ze=t,t=s),t===s&&(t=Ze,(n=Bn())!==s&&(r=gn())!==s&&(o=Bn())!==s?((i=fn())===s&&(i=null),i!==s?(Qe=t,t=n=A(r)):(Ze=t,t=s)):(Ze=t,t=s)))))))),t}function fn(){var t,n,r,o,i;return t=Ze,(n=Bn())!==s?(44===e.charCodeAt(Ze)?(r=x,Ze++):(r=s,0===rn&&un(I)),r===s&&(r=null),r!==s?((o=mn())===s&&(o=null),o!==s?((i=hn())===s&&(i=null),i!==s?t=n=[n,r,o,i]:(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s),t}function hn(){var t;return D.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(N)),t}function mn(){var t,n,r,o,i;if(t=Ze,(n=Bn())!==s)if(35===e.charCodeAt(Ze)?(r=R,Ze++):(r=s,0===rn&&un(T)),r!==s){for(o=[],i=Ln();i!==s;)o.push(i),i=Ln();o!==s?t=n=[n,r,o]:(Ze=t,t=s)}else Ze=t,t=s;else Ze=t,t=s;return t}function gn(){var t,n,r,o;return t=Ze,(n=vn())!==s&&Bn()!==s?(e.substr(Ze,2)===j?(r=j,Ze+=2):(r=s,0===rn&&un(L)),r!==s&&Bn()!==s&&(o=gn())!==s?(Qe=t,t=n=M(n,o)):(Ze=t,t=s)):(Ze=t,t=s),t===s&&(t=yn()),t}function vn(){var t;return(t=bn())===s&&(t=wn())===s&&(t=kn()),t}function yn(){var t;return(t=En())===s&&(t=bn()),t}function bn(){var t,e,n,r;return t=Ze,(e=Nn())!==s&&(n=Sn())!==s&&(r=Rn())!==s?(Qe=t,t=e=B(e,n,r)):(Ze=t,t=s),t===s&&(t=Ze,(e=Nn())===s&&(e=null),e!==s&&(n=Cn())!==s?((r=Rn())===s&&(r=null),r!==s?(Qe=t,t=e=B(e,n,r)):(Ze=t,t=s)):(Ze=t,t=s)),t}function wn(){var t,e,n;return t=Ze,(e=Sn())!==s?((n=Rn())===s&&(n=null),n!==s?(Qe=t,t=e=U(e,n)):(Ze=t,t=s)):(Ze=t,t=s),t}function En(){var t,e,n;return t=Ze,(e=Nn())===s&&(e=null),e!==s&&(n=Sn())!==s?(Qe=t,t=e=F(e,n)):(Ze=t,t=s),t}function kn(){var t,n,r,o;if(t=Ze,39===e.charCodeAt(Ze)?(n=G,Ze++):(n=s,0===rn&&un(H)),n!==s){for(r=[],o=Mn();o!==s;)r.push(o),o=Mn();r!==s?(39===e.charCodeAt(Ze)?(o=G,Ze++):(o=s,0===rn&&un(H)),o!==s?(Qe=t,t=n=q(r)):(Ze=t,t=s)):(Ze=t,t=s)}else Ze=t,t=s;return t===s&&(t=Ze,(n=Fn())!==s&&(Qe=t,n=z(n)),t=n),t}function Sn(){var t,e;return t=Ze,(e=On())!==s&&(Qe=t,e=$(e)),(t=e)===s&&(t=Ze,(e=Pn())!==s&&(Qe=t,e=$(e)),(t=e)===s&&(t=Ze,(e=_n())!==s&&(Qe=t,e=$(e)),t=e)),t}function Pn(){var t,n,r,o,i;if(t=Ze,n=Ze,X.test(e.charAt(Ze))?(r=e.charAt(Ze),Ze++):(r=s,0===rn&&un(Y)),r!==s){for(o=[],J.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=s,0===rn&&un(K));i!==s;)o.push(i),J.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=s,0===rn&&un(K));o!==s?n=r=[r,o]:(Ze=n,n=s)}else Ze=n,n=s;return n!==s&&(Qe=t,n=W(n)),t=n}function On(){var t,e,n;return t=Ze,(e=Pn())!==s&&(n=An())!==s?(Qe=t,t=e=V(e,n)):(Ze=t,t=s),t}function _n(){var t,e;return t=Ze,(e=An())!==s&&(Qe=t,e=Z(e)),t=e}function Cn(){var t;return(t=On())===s&&(t=_n()),t}function An(){var t,n,r,o,i;if(t=Ze,40===e.charCodeAt(Ze)?(n=Q,Ze++):(n=s,0===rn&&un(tt)),n!==s){for(r=[],et.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=s,0===rn&&un(nt));o!==s;)r.push(o),et.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=s,0===rn&&un(nt));r===s&&(r=null),r!==s?((o=xn())===s&&(o=null),o!==s?(41===e.charCodeAt(Ze)?(i=rt,Ze++):(i=s,0===rn&&un(ot)),i!==s?(Qe=t,t=n=it(r,o)):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s)}else Ze=t,t=s;return t}function xn(){var t,n,r,o;if(t=Ze,58===e.charCodeAt(Ze)?(n=m,Ze++):(n=s,0===rn&&un(g)),n!==s){if(r=[],at.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=s,0===rn&&un(st)),o!==s)for(;o!==s;)r.push(o),at.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=s,0===rn&&un(st));else r=s;r!==s?(Qe=t,t=n=ct(r)):(Ze=t,t=s)}else Ze=t,t=s;return t}function In(){var t,n,r,o,i,a,c;if(t=Ze,35===e.charCodeAt(Ze)?(n=R,Ze++):(n=s,0===rn&&un(T)),n!==s)if(Un()!==s)if(64===e.charCodeAt(Ze)?(r=ut,Ze++):(r=s,0===rn&&un(lt)),r!==s){if(o=[],pt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=s,0===rn&&un(dt)),i!==s)for(;i!==s;)o.push(i),pt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=s,0===rn&&un(dt));else o=s;if(o!==s)if((i=Un())!==s){if(a=[],ft.test(e.charAt(Ze))?(c=e.charAt(Ze),Ze++):(c=s,0===rn&&un(ht)),c!==s)for(;c!==s;)a.push(c),ft.test(e.charAt(Ze))?(c=e.charAt(Ze),Ze++):(c=s,0===rn&&un(ht));else a=s;a!==s?(Qe=t,t=n=mt(o,a)):(Ze=t,t=s)}else Ze=t,t=s;else Ze=t,t=s}else Ze=t,t=s;else Ze=t,t=s;else Ze=t,t=s;return t}function Dn(){var t,e,n;return t=Ze,(e=Tn())!==s?((n=jn())===s&&(n=null),n!==s?(Qe=t,t=e=gt(e,n)):(Ze=t,t=s)):(Ze=t,t=s),t}function Nn(){var t,e;return t=Ze,(e=Dn())!==s&&Un()!==s?(Qe=t,t=e=vt(e)):(Ze=t,t=s),t}function Rn(){var t,e;return t=Ze,Un()!==s&&(e=Dn())!==s?(Qe=t,t=vt(e)):(Ze=t,t=s),t}function Tn(){var t,n,r,o,i;if(t=Ze,n=Ze,X.test(e.charAt(Ze))?(r=e.charAt(Ze),Ze++):(r=s,0===rn&&un(Y)),r!==s){for(o=[],yt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=s,0===rn&&un(bt));i!==s;)o.push(i),yt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=s,0===rn&&un(bt));o!==s?n=r=[r,o]:(Ze=n,n=s)}else Ze=n,n=s;return n!==s&&(Qe=t,n=wt(n)),t=n}function jn(){var t,n,r,o;if(t=Ze,91===e.charCodeAt(Ze)?(n=Et,Ze++):(n=s,0===rn&&un(kt)),n!==s){if(r=[],St.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=s,0===rn&&un(Pt)),o!==s)for(;o!==s;)r.push(o),St.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=s,0===rn&&un(Pt));else r=s;r!==s?(93===e.charCodeAt(Ze)?(o=Ot,Ze++):(o=s,0===rn&&un(_t)),o!==s?(Qe=t,t=n=Ct(r)):(Ze=t,t=s)):(Ze=t,t=s)}else Ze=t,t=s;return t}function Ln(){var t;return At.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(xt)),t}function Mn(){var t,n,r;return t=Ze,It.test(e.charAt(Ze))?(n=e.charAt(Ze),Ze++):(n=s,0===rn&&un(Dt)),n!==s?(Nt.test(e.charAt(Ze))?(r=e.charAt(Ze),Ze++):(r=s,0===rn&&un(Rt)),r!==s?(Qe=t,t=n=Tt()):(Ze=t,t=s)):(Ze=t,t=s),t===s&&(jt.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(Lt))),t}function Bn(){var t,n;for(t=[],32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=s,0===rn&&un(Bt));n!==s;)t.push(n),32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=s,0===rn&&un(Bt));return t===s&&(t=null),t}function Un(){var t,n;if(t=[],32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=s,0===rn&&un(Bt)),n!==s)for(;n!==s;)t.push(n),32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=s,0===rn&&un(Bt));else t=s;return t}function Fn(){var t,e;return t=Ze,Yn()!==s&&(e=Jn())!==s&&Yn()!==s?(Qe=t,t=Ut(e)):(Ze=t,t=s),t}function Gn(){var t,n,r,o;return t=Ze,(n=Yn())!==s?(91===e.charCodeAt(Ze)?(r=Et,Ze++):(r=s,0===rn&&un(kt)),r!==s&&(o=Yn())!==s?t=n=[n,r,o]:(Ze=t,t=s)):(Ze=t,t=s),t}function Hn(){var t,n,r,o;return t=Ze,(n=Yn())!==s?(123===e.charCodeAt(Ze)?(r=Ft,Ze++):(r=s,0===rn&&un(Gt)),r!==s&&(o=Yn())!==s?t=n=[n,r,o]:(Ze=t,t=s)):(Ze=t,t=s),t}function qn(){var t,n,r,o;return t=Ze,(n=Yn())!==s?(93===e.charCodeAt(Ze)?(r=Ot,Ze++):(r=s,0===rn&&un(_t)),r!==s&&(o=Yn())!==s?t=n=[n,r,o]:(Ze=t,t=s)):(Ze=t,t=s),t}function zn(){var t,n,r,o;return t=Ze,(n=Yn())!==s?(125===e.charCodeAt(Ze)?(r=Ht,Ze++):(r=s,0===rn&&un(qt)),r!==s&&(o=Yn())!==s?t=n=[n,r,o]:(Ze=t,t=s)):(Ze=t,t=s),t}function $n(){var t,n,r,o;return t=Ze,(n=Yn())!==s?(58===e.charCodeAt(Ze)?(r=m,Ze++):(r=s,0===rn&&un(g)),r!==s&&(o=Yn())!==s?t=n=[n,r,o]:(Ze=t,t=s)):(Ze=t,t=s),t}function Xn(){var t,n,r,o;return t=Ze,(n=Yn())!==s?(44===e.charCodeAt(Ze)?(r=x,Ze++):(r=s,0===rn&&un(I)),r!==s&&(o=Yn())!==s?t=n=[n,r,o]:(Ze=t,t=s)):(Ze=t,t=s),t}function Yn(){var t,n;for(rn++,t=[],$t.test(e.charAt(Ze))?(n=e.charAt(Ze),Ze++):(n=s,0===rn&&un(Xt));n!==s;)t.push(n),$t.test(e.charAt(Ze))?(n=e.charAt(Ze),Ze++):(n=s,0===rn&&un(Xt));return rn--,t===s&&(n=s,0===rn&&un(zt)),t}function Jn(){var t;return(t=Kn())===s&&(t=Wn())===s&&(t=Vn())===s&&(t=Zn())===s&&(t=tr())===s&&(t=er())===s&&(t=pr()),t}function Kn(){var t,n;return t=Ze,e.substr(Ze,5)===Yt?(n=Yt,Ze+=5):(n=s,0===rn&&un(Jt)),n!==s&&(Qe=t,n=Kt()),t=n}function Wn(){var t,n;return t=Ze,e.substr(Ze,4)===Wt?(n=Wt,Ze+=4):(n=s,0===rn&&un(Vt)),n!==s&&(Qe=t,n=Zt()),t=n}function Vn(){var t,n;return t=Ze,e.substr(Ze,4)===Qt?(n=Qt,Ze+=4):(n=s,0===rn&&un(te)),n!==s&&(Qe=t,n=ee()),t=n}function Zn(){var t,e,n,r,o,i;if(t=Ze,Hn()!==s){if(e=Ze,(n=Qn())!==s){for(r=[],o=Ze,Xn()!==s&&(i=Qn())!==s?(Qe=o,o=ne(n,i)):(Ze=o,o=s);o!==s;)r.push(o),o=Ze,Xn()!==s&&(i=Qn())!==s?(Qe=o,o=ne(n,i)):(Ze=o,o=s);r!==s?(Qe=e,e=n=re(n,r)):(Ze=e,e=s)}else Ze=e,e=s;e===s&&(e=null),e!==s&&(n=zn())!==s?(Qe=t,t=oe(e)):(Ze=t,t=s)}else Ze=t,t=s;return t}function Qn(){var t,e,n;return t=Ze,(e=pr())!==s&&$n()!==s&&(n=Jn())!==s?(Qe=t,t=e=ie(e,n)):(Ze=t,t=s),t}function tr(){var t,e,n,r,o,i;if(t=Ze,Gn()!==s){if(e=Ze,(n=Jn())!==s){for(r=[],o=Ze,Xn()!==s&&(i=Jn())!==s?(Qe=o,o=ae(n,i)):(Ze=o,o=s);o!==s;)r.push(o),o=Ze,Xn()!==s&&(i=Jn())!==s?(Qe=o,o=ae(n,i)):(Ze=o,o=s);r!==s?(Qe=e,e=n=se(n,r)):(Ze=e,e=s)}else Ze=e,e=s;e===s&&(e=null),e!==s&&(n=qn())!==s?(Qe=t,t=ce(e)):(Ze=t,t=s)}else Ze=t,t=s;return t}function er(){var t,e,n,r;return rn++,t=Ze,(e=cr())===s&&(e=null),e!==s&&sr()!==s?((n=ar())===s&&(n=null),n!==s?((r=ir())===s&&(r=null),r!==s?(Qe=t,t=e=le()):(Ze=t,t=s)):(Ze=t,t=s)):(Ze=t,t=s),rn--,t===s&&(e=s,0===rn&&un(ue)),t}function nr(){var t;return 46===e.charCodeAt(Ze)?(t=f,Ze++):(t=s,0===rn&&un(h)),t}function rr(){var t;return pe.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(de)),t}function or(){var t;return fe.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(he)),t}function ir(){var t,e,n,r,o;if(t=Ze,(e=or())!==s)if((n=cr())===s&&(n=ur()),n===s&&(n=null),n!==s){if(r=[],(o=gr())!==s)for(;o!==s;)r.push(o),o=gr();else r=s;r!==s?t=e=[e,n,r]:(Ze=t,t=s)}else Ze=t,t=s;else Ze=t,t=s;return t}function ar(){var t,e,n,r;if(t=Ze,(e=nr())!==s){if(n=[],(r=gr())!==s)for(;r!==s;)n.push(r),r=gr();else n=s;n!==s?t=e=[e,n]:(Ze=t,t=s)}else Ze=t,t=s;return t}function sr(){var t,e,n,r;if((t=lr())===s)if(t=Ze,(e=rr())!==s){for(n=[],r=gr();r!==s;)n.push(r),r=gr();n!==s?t=e=[e,n]:(Ze=t,t=s)}else Ze=t,t=s;return t}function cr(){var t;return 45===e.charCodeAt(Ze)?(t=me,Ze++):(t=s,0===rn&&un(ge)),t}function ur(){var t;return 43===e.charCodeAt(Ze)?(t=ve,Ze++):(t=s,0===rn&&un(ye)),t}function lr(){var t;return 48===e.charCodeAt(Ze)?(t=be,Ze++):(t=s,0===rn&&un(we)),t}function pr(){var t,e,n;if(rn++,t=Ze,hr()!==s){for(e=[],n=dr();n!==s;)e.push(n),n=dr();e!==s&&(n=hr())!==s?(Qe=t,t=ke(e)):(Ze=t,t=s)}else Ze=t,t=s;return rn--,t===s&&(s,0===rn&&un(Ee)),t}function dr(){var t,n,r,o,i,a,c,u,l;return(t=mr())===s&&(t=Ze,fr()!==s?(34===e.charCodeAt(Ze)?(n=Se,Ze++):(n=s,0===rn&&un(Pe)),n===s&&(92===e.charCodeAt(Ze)?(n=Oe,Ze++):(n=s,0===rn&&un(_e)),n===s&&(47===e.charCodeAt(Ze)?(n=Ce,Ze++):(n=s,0===rn&&un(Ae)),n===s&&(n=Ze,98===e.charCodeAt(Ze)?(r=xe,Ze++):(r=s,0===rn&&un(Ie)),r!==s&&(Qe=n,r=De()),(n=r)===s&&(n=Ze,102===e.charCodeAt(Ze)?(r=Ne,Ze++):(r=s,0===rn&&un(Re)),r!==s&&(Qe=n,r=Te()),(n=r)===s&&(n=Ze,110===e.charCodeAt(Ze)?(r=je,Ze++):(r=s,0===rn&&un(Le)),r!==s&&(Qe=n,r=Me()),(n=r)===s&&(n=Ze,114===e.charCodeAt(Ze)?(r=Be,Ze++):(r=s,0===rn&&un(Ue)),r!==s&&(Qe=n,r=Fe()),(n=r)===s&&(n=Ze,116===e.charCodeAt(Ze)?(r=Ge,Ze++):(r=s,0===rn&&un(He)),r!==s&&(Qe=n,r=qe()),(n=r)===s&&(n=Ze,117===e.charCodeAt(Ze)?(r=ze,Ze++):(r=s,0===rn&&un($e)),r!==s?(o=Ze,i=Ze,(a=vr())!==s&&(c=vr())!==s&&(u=vr())!==s&&(l=vr())!==s?i=a=[a,c,u,l]:(Ze=i,i=s),(o=i!==s?e.substring(o,Ze):i)!==s?(Qe=n,n=r=Xe(o)):(Ze=n,n=s)):(Ze=n,n=s))))))))),n!==s?(Qe=t,t=Ye(n)):(Ze=t,t=s)):(Ze=t,t=s)),t}function fr(){var t;return 92===e.charCodeAt(Ze)?(t=Oe,Ze++):(t=s,0===rn&&un(_e)),t}function hr(){var t;return 34===e.charCodeAt(Ze)?(t=Se,Ze++):(t=s,0===rn&&un(Pe)),t}function mr(){var t;return Je.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(Ke)),t}function gr(){var t;return St.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(Pt)),t}function vr(){var t;return We.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=s,0===rn&&un(Ve)),t}var yr="IN",br="OUT";delete(a=this).properties,delete a.inports,delete a.outports,delete a.groups,a.edges=[],o={};var wr=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};a.validateContents=function(t,e){t.processes&&Object.keys(t.processes).forEach((function(e){if(!t.processes[e].component)throw new Error('Node "'+e+'" does not have a component defined')})),t.inports&&Object.keys(t.inports).forEach((function(e){var n=t.inports[e];if(!t.processes[n.process])throw new Error('Inport "'+e+'" is connected to an undefined target node "'+n.process+'"')})),t.outports&&Object.keys(t.outports).forEach((function(e){var n=t.outports[e];if(!t.processes[n.process])throw new Error('Outport "'+e+'" is connected to an undefined source node "'+n.process+'"')})),t.connections&&t.connections.forEach((function(e){if(e.tgt&&!t.processes[e.tgt.process]){if(e.data)throw new Error('IIP containing "'+e.data+'" is connected to an undefined target node "'+e.tgt.process+'"');throw new Error('Edge from "'+e.src.process+'" port "'+e.src.port+'" is connected to an undefined target node "'+e.tgt.process+'"')}if(e.src&&!t.processes[e.src.process])throw new Error('Edge to "'+e.tgt.process+'" port "'+e.tgt.port+'" is connected to an undefined source node "'+e.src.process+'"')}))},a.serialize=function(t){var e,n,r,o,a,s,c,u,l,p,d,f,h,m,g,v,y,b,w,E,k,S,P;for(u in null==i&&(i={}),s="string"==typeof t?JSON.parse(t):t,l=[],d="",r=function(t){return null!=s.processes[t].metadata&&(t=s.processes[t].metadata.label),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},n=function(t,e){return null!=e.process&&null!=s.processes[e.process].metadata?t=s.processes[e.process].metadata.label:null!=e.process&&(t=e.process),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},s.properties&&(s.properties.environment&&s.properties.environment.type&&(d+="# @runtime "+s.properties.environment.type+"\n"),Object.keys(s.properties).forEach((function(t){if(t.match(/^[a-zA-Z0-9\-_]+$/)){var e=s.properties[t];"string"==typeof e&&e.match(/^[a-zA-Z0-9\-_\s\.]+$/)&&(d+="# @"+t+" "+e+"\n")}}))),h=s.inports)f=n(u,a=h[u]),u=s.caseSensitive?u:u.toUpperCase(),a.port=s.caseSensitive?a.port:a.port.toUpperCase(),d+="INPORT="+f+"."+a.port+":"+u+"\n";for(u in m=s.outports)p=m[u],f=n(u,a),u=s.caseSensitive?u:u.toUpperCase(),p.port=s.caseSensitive?p.port:p.port.toUpperCase(),d+="OUTPORT="+f+"."+p.port+":"+u+"\n";for(d+="\n",o=0,c=(g=s.connections).length;o<c;o++)null!=(e=g[o]).data?(S=s.caseSensitive?e.tgt.port:e.tgt.port.toUpperCase(),k=e.tgt.process,P=s.processes[k].component,E=r(k),wr.call(l,P)<0&&(E+="("+P+")",l.push(P)),d+='"'+e.data+'" -> '+S+" "+E+"\n"):(b=s.caseSensitive?e.src.port:e.src.port.toUpperCase(),y=e.src.process,w=s.processes[y].component,v=r(y),wr.call(l,w)<0&&(v+="("+w+")",l.push(w)),S=s.caseSensitive?e.tgt.port:e.tgt.port.toUpperCase(),k=e.tgt.process,P=s.processes[k].component,E=r(k),wr.call(l,P)<0&&(E+="("+P+")",l.push(P)),d+=v+" "+b+" -> "+S+" "+E+"\n");return d},a.addNode=function(t,e){if(o[t]||(o[t]={}),e.comp&&(o[t].component=e.comp),e.meta){for(var n={},r=0;r<e.meta.length;r++){var i=e.meta[r].split("=");1===i.length&&(i=["routes",i[0]]);var a=i[0],s=i[1];"x"!==a&&"y"!==a||(s=parseFloat(s)),n[a]=s}o[t].metadata=n}};var Er={},kr={};a.addAnonymousNode=function(t,e){if(!kr[e]){var n=t.comp.replace(/[^a-zA-Z0-9]+/,"_");Er[n]=(Er[n]||0)+1,kr[e]="_"+n+"_"+Er[n],this.addNode(kr[e],t)}return kr[e]},a.getResult=function(){var t={inports:a.inports||{},outports:a.outports||{},groups:a.groups||[],processes:o||{},connections:a.processEdges()};a.properties&&(t.properties=a.properties),t.caseSensitive=i.caseSensitive||!1;var e=a.validateSchema;if(void 0!==i.validateSchema&&(e=i.validateSchema),e){if(void 0===r)var r=n(43);var s=n(44),c=r.validateMultiple(t,s);if(!c.valid)throw new Error("fbp: Did not validate againt graph schema:\n"+JSON.stringify(c.errors,null,2))}return(void 0===i.validateContents||i.validateContents)&&a.validateContents(t),t};var Sr=function(t,e){for(var n=-1,r=t?t.length:0,o=[];++n<r;){var i=t[n];i instanceof Array?Array.prototype.push.apply(o,e?i:Sr(i)):o.push(i)}return o};function Pr(t){return t[0]+t[1].join("")}function Or(t,e,n){i.caseSensitive||(n=n.toLowerCase());var r={process:t,port:e?e.port:n};return e&&null!=e.index&&(r.index=e.index),r}function _r(t,e){return Or(t,e,yr)}function Cr(t,e){return Or(t,e,br)}if(a.registerAnnotation=function(t,e){if(a.properties||(a.properties={}),"runtime"===t)return a.properties.environment={},void(a.properties.environment.type=e);a.properties[t]=e},a.registerInports=function(t,e,n){a.inports||(a.inports={}),i.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),a.inports[n]={process:t,port:e}},a.registerOutports=function(t,e,n){a.outports||(a.outports={}),i.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),a.outports[n]={process:t,port:e}},a.registerEdges=function(t){Array.isArray(t)&&t.forEach((function(t,e){a.edges.push(t)}))},a.processEdges=function(){var t,e;t=Sr(a.edges),e=[];for(var n=1;n<t.length;n+=1)("src"in t[n-1]||"data"in t[n-1])&&"tgt"in t[n]&&(t[n-1].tgt=t[n].tgt,e.push(t[n-1]),n++);return e},(r=u())!==s&&Ze===e.length)return r;throw r!==s&&Ze<e.length&&un({type:"end",description:"end of input"}),ln(null,nn,en<e.length?e.charAt(en):null,en<e.length?cn(en,en+1):cn(en,en))}}}()},function(t,e,n){var r,o,i;o=[],void 0===(i="function"==typeof(r=function(){var t,e,n,r;Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(o){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError("Object.keys called on non-object");var i=[];for(var a in o)t.call(o,a)&&i.push(a);if(e)for(var s=0;s<r;s++)t.call(o,n[s])&&i.push(n[s]);return i})),Object.create||(Object.create=function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return t.prototype=e,new t}}()),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(null===this)throw new TypeError;var e=Object(this),n=e.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&((r=Number(arguments[1]))!=r?r=0:0!==r&&r!==1/0&&r!==-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var o=r>=0?r:Math.max(n-Math.abs(r),0);o<n;o++)if(o in e&&e[o]===t)return o;return-1}),Object.isFrozen||(Object.isFrozen=function(t){for(var e="tv4_test_frozen_key";t.hasOwnProperty(e);)e+=Math.random();try{return t[e]=!0,delete t[e],!1}catch(t){return!0}});var o={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},i={"*":!0};function a(t){return encodeURI(t).replace(/%25[0-9][0-9]/g,(function(t){return"%"+t.substring(3)}))}function s(t){var e="";o[t.charAt(0)]&&(e=t.charAt(0),t=t.substring(1));var n="",r="",s=!0,c=!1,u=!1;"+"===e?s=!1:"."===e?(r=".",n="."):"/"===e?(r="/",n="/"):"#"===e?(r="#",s=!1):";"===e?(r=";",n=";",c=!0,u=!0):"?"===e?(r="?",n="&",c=!0):"&"===e&&(r="&",n="&",c=!0);for(var l=[],p=t.split(","),d=[],f={},h=0;h<p.length;h++){var m=p[h],g=null;if(-1!==m.indexOf(":")){var v=m.split(":");m=v[0],g=parseInt(v[1],10)}for(var y={};i[m.charAt(m.length-1)];)y[m.charAt(m.length-1)]=!0,m=m.substring(0,m.length-1);var b={truncate:g,name:m,suffices:y};d.push(b),f[m]=b,l.push(m)}var w=function(t){for(var e="",o=0,i=0;i<d.length;i++){var l=d[i],p=t(l.name);if(null==p||Array.isArray(p)&&0===p.length||"object"==typeof p&&0===Object.keys(p).length)o++;else if(e+=i===o?r:n||",",Array.isArray(p)){c&&(e+=l.name+"=");for(var f=0;f<p.length;f++)f>0&&(e+=l.suffices["*"]&&n||",",l.suffices["*"]&&c&&(e+=l.name+"=")),e+=s?encodeURIComponent(p[f]).replace(/!/g,"%21"):a(p[f])}else if("object"==typeof p){c&&!l.suffices["*"]&&(e+=l.name+"=");var h=!0;for(var m in p)h||(e+=l.suffices["*"]&&n||","),h=!1,e+=s?encodeURIComponent(m).replace(/!/g,"%21"):a(m),e+=l.suffices["*"]?"=":",",e+=s?encodeURIComponent(p[m]).replace(/!/g,"%21"):a(p[m])}else c&&(e+=l.name,u&&""===p||(e+="=")),null!=l.truncate&&(p=p.substring(0,l.truncate)),e+=s?encodeURIComponent(p).replace(/!/g,"%21"):a(p)}return e};return w.varNames=l,{prefix:r,substitution:w}}function c(t){if(!(this instanceof c))return new c(t);for(var e=t.split("{"),n=[e.shift()],r=[],o=[],i=[];e.length>0;){var a=e.shift(),u=a.split("}")[0],l=a.substring(u.length+1),p=s(u);o.push(p.substitution),r.push(p.prefix),n.push(l),i=i.concat(p.substitution.varNames)}this.fill=function(t){for(var e=n[0],r=0;r<o.length;r++)e+=(0,o[r])(t),e+=n[r+1];return e},this.varNames=i,this.template=t}c.prototype={toString:function(){return this.template},fillFromObject:function(t){return this.fill((function(e){return t[e]}))}};var u=function(t,e,n,r,o){if(this.missing=[],this.missingMap={},this.formatValidators=t?Object.create(t.formatValidators):{},this.schemas=t?Object.create(t.schemas):{},this.collectMultiple=e,this.errors=[],this.handleError=e?this.collectError:this.returnError,r&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),o&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=n||v("en"),"string"==typeof this.errorReporter)throw new Error("debug");if(this.definedKeywords={},t)for(var i in t.definedKeywords)this.definedKeywords[i]=t.definedKeywords[i].slice(0)};function l(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)!==Array.isArray(e))return!1;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!l(t[n],e[n]))return!1}else{var r;for(r in t)if(void 0===e[r]&&void 0!==t[r])return!1;for(r in e)if(void 0===t[r]&&void 0!==e[r])return!1;for(r in t)if(!l(t[r],e[r]))return!1}return!0}return!1}u.prototype.defineKeyword=function(t,e){this.definedKeywords[t]=this.definedKeywords[t]||[],this.definedKeywords[t].push(e)},u.prototype.createError=function(t,e,n,r,o,i,a){var s=new k(t,e,n,r,o);return s.message=this.errorReporter(s,i,a),s},u.prototype.returnError=function(t){return t},u.prototype.collectError=function(t){return t&&this.errors.push(t),null},u.prototype.prefixErrors=function(t,e,n){for(var r=t;r<this.errors.length;r++)this.errors[r]=this.errors[r].prefixWith(e,n);return this},u.prototype.banUnknownProperties=function(t,e){for(var n in this.unknownPropertyPaths){var r=this.createError(y.UNKNOWN_PROPERTY,{path:n},n,"",null,t,e),o=this.handleError(r);if(o)return o}return null},u.prototype.addFormat=function(t,e){if("object"==typeof t){for(var n in t)this.addFormat(n,t[n]);return this}this.formatValidators[t]=e},u.prototype.resolveRefs=function(t,e){if(void 0!==t.$ref){if((e=e||{})[t.$ref])return this.createError(y.CIRCULAR_REFERENCE,{urls:Object.keys(e).join(", ")},"","",null,void 0,t);e[t.$ref]=!0,t=this.getSchema(t.$ref,e)}return t},u.prototype.getSchema=function(t,e){var n;if(void 0!==this.schemas[t])return n=this.schemas[t],this.resolveRefs(n,e);var r=t,o="";if(-1!==t.indexOf("#")&&(o=t.substring(t.indexOf("#")+1),r=t.substring(0,t.indexOf("#"))),"object"==typeof this.schemas[r]){n=this.schemas[r];var i=decodeURIComponent(o);if(""===i)return this.resolveRefs(n,e);if("/"!==i.charAt(0))return;for(var a=i.split("/").slice(1),s=0;s<a.length;s++){var c=a[s].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===n[c]){n=void 0;break}n=n[c]}if(void 0!==n)return this.resolveRefs(n,e)}void 0===this.missing[r]&&(this.missing.push(r),this.missing[r]=r,this.missingMap[r]=r)},u.prototype.searchSchemas=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.searchSchemas(t[n],e);else if(t&&"object"==typeof t)for(var r in"string"==typeof t.id&&function(t,e){if(e.substring(0,t.length)===t){var n=e.substring(t.length);if(e.length>0&&"/"===e.charAt(t.length-1)||"#"===n.charAt(0)||"?"===n.charAt(0))return!0}return!1}(e,t.id)&&void 0===this.schemas[t.id]&&(this.schemas[t.id]=t),t)if("enum"!==r)if("object"==typeof t[r])this.searchSchemas(t[r],e);else if("$ref"===r){var o=m(t[r]);o&&void 0===this.schemas[o]&&void 0===this.missingMap[o]&&(this.missingMap[o]=o)}},u.prototype.addSchema=function(t,e){if("string"!=typeof t||void 0===e){if("object"!=typeof t||"string"!=typeof t.id)return;t=(e=t).id}t===m(t)+"#"&&(t=m(t)),this.schemas[t]=e,delete this.missingMap[t],g(e,t),this.searchSchemas(e,t)},u.prototype.getSchemaMap=function(){var t={};for(var e in this.schemas)t[e]=this.schemas[e];return t},u.prototype.getSchemaUris=function(t){var e=[];for(var n in this.schemas)t&&!t.test(n)||e.push(n);return e},u.prototype.getMissingUris=function(t){var e=[];for(var n in this.missingMap)t&&!t.test(n)||e.push(n);return e},u.prototype.dropSchemas=function(){this.schemas={},this.reset()},u.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},u.prototype.validateAll=function(t,e,n,r,o){var i;if(!(e=this.resolveRefs(e)))return null;if(e instanceof k)return this.errors.push(e),e;var a,s=this.errors.length,c=null,u=null;if(this.checkRecursive&&t&&"object"==typeof t){if(i=!this.scanned.length,t[this.validatedSchemasKey]){var l=t[this.validatedSchemasKey].indexOf(e);if(-1!==l)return this.errors=this.errors.concat(t[this.validationErrorsKey][l]),null}if(Object.isFrozen(t)&&-1!==(a=this.scannedFrozen.indexOf(t))){var p=this.scannedFrozenSchemas[a].indexOf(e);if(-1!==p)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[a][p]),null}if(this.scanned.push(t),Object.isFrozen(t))-1===a&&(a=this.scannedFrozen.length,this.scannedFrozen.push(t),this.scannedFrozenSchemas.push([])),c=this.scannedFrozenSchemas[a].length,this.scannedFrozenSchemas[a][c]=e,this.scannedFrozenValidationErrors[a][c]=[];else{if(!t[this.validatedSchemasKey])try{Object.defineProperty(t,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(t,this.validationErrorsKey,{value:[],configurable:!0})}catch(e){t[this.validatedSchemasKey]=[],t[this.validationErrorsKey]=[]}u=t[this.validatedSchemasKey].length,t[this.validatedSchemasKey][u]=e,t[this.validationErrorsKey][u]=[]}}var d=this.errors.length,f=this.validateBasic(t,e,o)||this.validateNumeric(t,e,o)||this.validateString(t,e,o)||this.validateArray(t,e,o)||this.validateObject(t,e,o)||this.validateCombinations(t,e,o)||this.validateHypermedia(t,e,o)||this.validateFormat(t,e,o)||this.validateDefinedKeywords(t,e,o)||null;if(i){for(;this.scanned.length;)delete this.scanned.pop()[this.validatedSchemasKey];this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(f||d!==this.errors.length)for(;n&&n.length||r&&r.length;){var h=n&&n.length?""+n.pop():null,m=r&&r.length?""+r.pop():null;f&&(f=f.prefixWith(h,m)),this.prefixErrors(d,h,m)}return null!==c?this.scannedFrozenValidationErrors[a][c]=this.errors.slice(s):null!==u&&(t[this.validationErrorsKey][u]=this.errors.slice(s)),this.handleError(f)},u.prototype.validateFormat=function(t,e){if("string"!=typeof e.format||!this.formatValidators[e.format])return null;var n=this.formatValidators[e.format].call(null,t,e);return"string"==typeof n||"number"==typeof n?this.createError(y.FORMAT_CUSTOM,{message:n},"","/format",null,t,e):n&&"object"==typeof n?this.createError(y.FORMAT_CUSTOM,{message:n.message||"?"},n.dataPath||"",n.schemaPath||"/format",null,t,e):null},u.prototype.validateDefinedKeywords=function(t,e,n){for(var r in this.definedKeywords)if(void 0!==e[r])for(var o=this.definedKeywords[r],i=0;i<o.length;i++){var a=(0,o[i])(t,e[r],e,n);if("string"==typeof a||"number"==typeof a)return this.createError(y.KEYWORD_CUSTOM,{key:r,message:a},"","",null,t,e).prefixWith(null,r);if(a&&"object"==typeof a){var s=a.code;if("string"==typeof s){if(!y[s])throw new Error("Undefined error code (use defineError): "+s);s=y[s]}else"number"!=typeof s&&(s=y.KEYWORD_CUSTOM);var c="object"==typeof a.message?a.message:{key:r,message:a.message||"?"},u=a.schemaPath||"/"+r.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(s,c,a.dataPath||null,u,null,t,e)}}return null},u.prototype.validateBasic=function(t,e,n){var r;return(r=this.validateType(t,e,n))||(r=this.validateEnum(t,e,n))?r.prefixWith(null,"type"):null},u.prototype.validateType=function(t,e){if(void 0===e.type)return null;var n=typeof t;null===t?n="null":Array.isArray(t)&&(n="array");var r=e.type;Array.isArray(r)||(r=[r]);for(var o=0;o<r.length;o++){var i=r[o];if(i===n||"integer"===i&&"number"===n&&t%1==0)return null}return this.createError(y.INVALID_TYPE,{type:n,expected:r.join("/")},"","",null,t,e)},u.prototype.validateEnum=function(t,e){if(void 0===e.enum)return null;for(var n=0;n<e.enum.length;n++)if(l(t,e.enum[n]))return null;return this.createError(y.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(t):t},"","",null,t,e)},u.prototype.validateNumeric=function(t,e,n){return this.validateMultipleOf(t,e,n)||this.validateMinMax(t,e,n)||this.validateNaN(t,e,n)||null};var p=Math.pow(2,-51),d=1-p;function f(t){var e=String(t).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return e?{href:e[0]||"",protocol:e[1]||"",authority:e[2]||"",host:e[3]||"",hostname:e[4]||"",port:e[5]||"",pathname:e[6]||"",search:e[7]||"",hash:e[8]||""}:null}function h(t,e){return e=f(e||""),t=f(t||""),e&&t?(e.protocol||t.protocol)+(e.protocol||e.authority?e.authority:t.authority)+(n=e.protocol||e.authority||"/"===e.pathname.charAt(0)?e.pathname:e.pathname?(t.authority&&!t.pathname?"/":"")+t.pathname.slice(0,t.pathname.lastIndexOf("/")+1)+e.pathname:t.pathname,r=[],n.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,(function(t){"/.."===t?r.pop():r.push(t)})),r.join("").replace(/^\//,"/"===n.charAt(0)?"/":""))+(e.protocol||e.authority||e.pathname?e.search:e.search||t.search)+e.hash:null;var n,r}function m(t){return t.split("#")[0]}function g(t,e){if(t&&"object"==typeof t)if(void 0===e?e=t.id:"string"==typeof t.id&&(e=h(e,t.id),t.id=e),Array.isArray(t))for(var n=0;n<t.length;n++)g(t[n],e);else for(var r in"string"==typeof t.$ref&&(t.$ref=h(e,t.$ref)),t)"enum"!==r&&g(t[r],e)}function v(t){var e=S[t=t||"en"];return function(t){var n=e[t.code]||E[t.code];if("string"!=typeof n)return"Unknown error code "+t.code+": "+JSON.stringify(t.messageParams);var r=t.params;return n.replace(/\{([^{}]*)\}/g,(function(t,e){var n=r[e];return"string"==typeof n||"number"==typeof n?n:t}))}}u.prototype.validateMultipleOf=function(t,e){var n=e.multipleOf||e.divisibleBy;if(void 0===n)return null;if("number"==typeof t){var r=t/n%1;if(r>=p&&r<d)return this.createError(y.NUMBER_MULTIPLE_OF,{value:t,multipleOf:n},"","",null,t,e)}return null},u.prototype.validateMinMax=function(t,e){if("number"!=typeof t)return null;if(void 0!==e.minimum){if(t<e.minimum)return this.createError(y.NUMBER_MINIMUM,{value:t,minimum:e.minimum},"","/minimum",null,t,e);if(e.exclusiveMinimum&&t===e.minimum)return this.createError(y.NUMBER_MINIMUM_EXCLUSIVE,{value:t,minimum:e.minimum},"","/exclusiveMinimum",null,t,e)}if(void 0!==e.maximum){if(t>e.maximum)return this.createError(y.NUMBER_MAXIMUM,{value:t,maximum:e.maximum},"","/maximum",null,t,e);if(e.exclusiveMaximum&&t===e.maximum)return this.createError(y.NUMBER_MAXIMUM_EXCLUSIVE,{value:t,maximum:e.maximum},"","/exclusiveMaximum",null,t,e)}return null},u.prototype.validateNaN=function(t,e){return"number"!=typeof t?null:!0===isNaN(t)||t===1/0||t===-1/0?this.createError(y.NUMBER_NOT_A_NUMBER,{value:t},"","/type",null,t,e):null},u.prototype.validateString=function(t,e,n){return this.validateStringLength(t,e,n)||this.validateStringPattern(t,e,n)||null},u.prototype.validateStringLength=function(t,e){return"string"!=typeof t?null:void 0!==e.minLength&&t.length<e.minLength?this.createError(y.STRING_LENGTH_SHORT,{length:t.length,minimum:e.minLength},"","/minLength",null,t,e):void 0!==e.maxLength&&t.length>e.maxLength?this.createError(y.STRING_LENGTH_LONG,{length:t.length,maximum:e.maxLength},"","/maxLength",null,t,e):null},u.prototype.validateStringPattern=function(t,e){if("string"!=typeof t||"string"!=typeof e.pattern&&!(e.pattern instanceof RegExp))return null;var n;if(e.pattern instanceof RegExp)n=e.pattern;else{var r,o="",i=e.pattern.match(/^\/(.+)\/([img]*)$/);i?(r=i[1],o=i[2]):r=e.pattern,n=new RegExp(r,o)}return n.test(t)?null:this.createError(y.STRING_PATTERN,{pattern:e.pattern},"","/pattern",null,t,e)},u.prototype.validateArray=function(t,e,n){return Array.isArray(t)&&(this.validateArrayLength(t,e,n)||this.validateArrayUniqueItems(t,e,n)||this.validateArrayItems(t,e,n))||null},u.prototype.validateArrayLength=function(t,e){var n;return void 0!==e.minItems&&t.length<e.minItems&&(n=this.createError(y.ARRAY_LENGTH_SHORT,{length:t.length,minimum:e.minItems},"","/minItems",null,t,e),this.handleError(n))||void 0!==e.maxItems&&t.length>e.maxItems&&(n=this.createError(y.ARRAY_LENGTH_LONG,{length:t.length,maximum:e.maxItems},"","/maxItems",null,t,e),this.handleError(n))?n:null},u.prototype.validateArrayUniqueItems=function(t,e){if(e.uniqueItems)for(var n=0;n<t.length;n++)for(var r=n+1;r<t.length;r++)if(l(t[n],t[r])){var o=this.createError(y.ARRAY_UNIQUE,{match1:n,match2:r},"","/uniqueItems",null,t,e);if(this.handleError(o))return o}return null},u.prototype.validateArrayItems=function(t,e,n){if(void 0===e.items)return null;var r,o;if(Array.isArray(e.items)){for(o=0;o<t.length;o++)if(o<e.items.length){if(r=this.validateAll(t[o],e.items[o],[o],["items",o],n+"/"+o))return r}else if(void 0!==e.additionalItems)if("boolean"==typeof e.additionalItems){if(!e.additionalItems&&(r=this.createError(y.ARRAY_ADDITIONAL_ITEMS,{},"/"+o,"/additionalItems",null,t,e),this.handleError(r)))return r}else if(r=this.validateAll(t[o],e.additionalItems,[o],["additionalItems"],n+"/"+o))return r}else for(o=0;o<t.length;o++)if(r=this.validateAll(t[o],e.items,[o],["items"],n+"/"+o))return r;return null},u.prototype.validateObject=function(t,e,n){return"object"!=typeof t||null===t||Array.isArray(t)?null:this.validateObjectMinMaxProperties(t,e,n)||this.validateObjectRequiredProperties(t,e,n)||this.validateObjectProperties(t,e,n)||this.validateObjectDependencies(t,e,n)||null},u.prototype.validateObjectMinMaxProperties=function(t,e){var n,r=Object.keys(t);return void 0!==e.minProperties&&r.length<e.minProperties&&(n=this.createError(y.OBJECT_PROPERTIES_MINIMUM,{propertyCount:r.length,minimum:e.minProperties},"","/minProperties",null,t,e),this.handleError(n))||void 0!==e.maxProperties&&r.length>e.maxProperties&&(n=this.createError(y.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:r.length,maximum:e.maxProperties},"","/maxProperties",null,t,e),this.handleError(n))?n:null},u.prototype.validateObjectRequiredProperties=function(t,e){if(void 0!==e.required)for(var n=0;n<e.required.length;n++){var r=e.required[n];if(void 0===t[r]){var o=this.createError(y.OBJECT_REQUIRED,{key:r},"","/required/"+n,null,t,e);if(this.handleError(o))return o}}return null},u.prototype.validateObjectProperties=function(t,e,n){var r;for(var o in t){var i=n+"/"+o.replace(/~/g,"~0").replace(/\//g,"~1"),a=!1;if(void 0!==e.properties&&void 0!==e.properties[o]&&(a=!0,r=this.validateAll(t[o],e.properties[o],[o],["properties",o],i)))return r;if(void 0!==e.patternProperties)for(var s in e.patternProperties)if(new RegExp(s).test(o)&&(a=!0,r=this.validateAll(t[o],e.patternProperties[s],[o],["patternProperties",s],i)))return r;if(a)this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]);else if(void 0!==e.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]),"boolean"==typeof e.additionalProperties){if(!e.additionalProperties&&(r=this.createError(y.OBJECT_ADDITIONAL_PROPERTIES,{key:o},"","/additionalProperties",null,t,e).prefixWith(o,null),this.handleError(r)))return r}else if(r=this.validateAll(t[o],e.additionalProperties,[o],["additionalProperties"],i))return r}else this.trackUnknownProperties&&!this.knownPropertyPaths[i]&&(this.unknownPropertyPaths[i]=!0)}return null},u.prototype.validateObjectDependencies=function(t,e,n){var r;if(void 0!==e.dependencies)for(var o in e.dependencies)if(void 0!==t[o]){var i=e.dependencies[o];if("string"==typeof i){if(void 0===t[i]&&(r=this.createError(y.OBJECT_DEPENDENCY_KEY,{key:o,missing:i},"","",null,t,e).prefixWith(null,o).prefixWith(null,"dependencies"),this.handleError(r)))return r}else if(Array.isArray(i))for(var a=0;a<i.length;a++){var s=i[a];if(void 0===t[s]&&(r=this.createError(y.OBJECT_DEPENDENCY_KEY,{key:o,missing:s},"","/"+a,null,t,e).prefixWith(null,o).prefixWith(null,"dependencies"),this.handleError(r)))return r}else if(r=this.validateAll(t,i,[],["dependencies",o],n))return r}return null},u.prototype.validateCombinations=function(t,e,n){return this.validateAllOf(t,e,n)||this.validateAnyOf(t,e,n)||this.validateOneOf(t,e,n)||this.validateNot(t,e,n)||null},u.prototype.validateAllOf=function(t,e,n){if(void 0===e.allOf)return null;for(var r,o=0;o<e.allOf.length;o++){var i=e.allOf[o];if(r=this.validateAll(t,i,[],["allOf",o],n))return r}return null},u.prototype.validateAnyOf=function(t,e,n){if(void 0===e.anyOf)return null;var r,o,i=[],a=this.errors.length;this.trackUnknownProperties&&(r=this.unknownPropertyPaths,o=this.knownPropertyPaths);for(var s=!0,c=0;c<e.anyOf.length;c++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var u=e.anyOf[c],l=this.errors.length,p=this.validateAll(t,u,[],["anyOf",c],n);if(null===p&&l===this.errors.length){if(this.errors=this.errors.slice(0,a),this.trackUnknownProperties){for(var d in this.knownPropertyPaths)o[d]=!0,delete r[d];for(var f in this.unknownPropertyPaths)o[f]||(r[f]=!0);s=!1;continue}return null}p&&i.push(p.prefixWith(null,""+c).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=r,this.knownPropertyPaths=o),s?(i=i.concat(this.errors.slice(a)),this.errors=this.errors.slice(0,a),this.createError(y.ANY_OF_MISSING,{},"","/anyOf",i,t,e)):void 0},u.prototype.validateOneOf=function(t,e,n){if(void 0===e.oneOf)return null;var r,o,i=null,a=[],s=this.errors.length;this.trackUnknownProperties&&(r=this.unknownPropertyPaths,o=this.knownPropertyPaths);for(var c=0;c<e.oneOf.length;c++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var u=e.oneOf[c],l=this.errors.length,p=this.validateAll(t,u,[],["oneOf",c],n);if(null===p&&l===this.errors.length){if(null!==i)return this.errors=this.errors.slice(0,s),this.createError(y.ONE_OF_MULTIPLE,{index1:i,index2:c},"","/oneOf",null,t,e);if(i=c,this.trackUnknownProperties){for(var d in this.knownPropertyPaths)o[d]=!0,delete r[d];for(var f in this.unknownPropertyPaths)o[f]||(r[f]=!0)}}else p&&a.push(p)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=r,this.knownPropertyPaths=o),null===i?(a=a.concat(this.errors.slice(s)),this.errors=this.errors.slice(0,s),this.createError(y.ONE_OF_MISSING,{},"","/oneOf",a,t,e)):(this.errors=this.errors.slice(0,s),null)},u.prototype.validateNot=function(t,e,n){if(void 0===e.not)return null;var r,o,i=this.errors.length;this.trackUnknownProperties&&(r=this.unknownPropertyPaths,o=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var a=this.validateAll(t,e.not,null,null,n),s=this.errors.slice(i);return this.errors=this.errors.slice(0,i),this.trackUnknownProperties&&(this.unknownPropertyPaths=r,this.knownPropertyPaths=o),null===a&&0===s.length?this.createError(y.NOT_PASSED,{},"","/not",null,t,e):null},u.prototype.validateHypermedia=function(t,e,n){if(!e.links)return null;for(var r,o=0;o<e.links.length;o++){var i=e.links[o];if("describedby"===i.rel){for(var a=new c(i.href),s=!0,u=0;u<a.varNames.length;u++)if(!(a.varNames[u]in t)){s=!1;break}if(s){var l={$ref:a.fillFromObject(t)};if(r=this.validateAll(t,l,[],["links",o],n))return r}}}};var y={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},b={};for(var w in y)b[y[w]]=w;var E={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};function k(t,e,n,r,o){if(Error.call(this),void 0===t)throw new Error("No error code supplied: "+r);this.message="",this.params=e,this.code=t,this.dataPath=n||"",this.schemaPath=r||"",this.subErrors=o||null;var i=new Error(this.message);if(this.stack=i.stack||i.stacktrace,!this.stack)try{throw i}catch(i){this.stack=i.stack||i.stacktrace}}k.prototype=Object.create(Error.prototype),k.prototype.constructor=k,k.prototype.name="ValidationError",k.prototype.prefixWith=function(t,e){if(null!==t&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+t+this.dataPath),null!==e&&(e=e.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+e+this.schemaPath),null!==this.subErrors)for(var n=0;n<this.subErrors.length;n++)this.subErrors[n].prefixWith(t,e);return this};var S={},P=function t(e){var n,r,o=new u,i={setErrorReporter:function(t){return"string"==typeof t?this.language(t):(r=t,!0)},addFormat:function(){o.addFormat.apply(o,arguments)},language:function(t){return t?(S[t]||(t=t.split("-")[0]),!!S[t]&&(n=t,t)):n},addLanguage:function(t,e){var n;for(n in y)e[n]&&!e[y[n]]&&(e[y[n]]=e[n]);var r=t.split("-")[0];if(S[r])for(n in S[t]=Object.create(S[r]),e)void 0===S[r][n]&&(S[r][n]=e[n]),S[t][n]=e[n];else S[t]=e,S[r]=e;return this},freshApi:function(e){var n=t();return e&&n.language(e),n},validate:function(t,e,i,a){var s=v(n),c=new u(o,!1,r?function(t,e,n){return r(t,e,n)||s(t,e,n)}:s,i,a);"string"==typeof e&&(e={$ref:e}),c.addSchema("",e);var l=c.validateAll(t,e,null,null,"");return!l&&a&&(l=c.banUnknownProperties(t,e)),this.error=l,this.missing=c.missing,this.valid=null===l,this.valid},validateResult:function(){var t={toString:function(){return this.valid?"valid":this.error.message}};return this.validate.apply(t,arguments),t},validateMultiple:function(t,e,i,a){var s=v(n),c=new u(o,!0,r?function(t,e,n){return r(t,e,n)||s(t,e,n)}:s,i,a);"string"==typeof e&&(e={$ref:e}),c.addSchema("",e),c.validateAll(t,e,null,null,""),a&&c.banUnknownProperties(t,e);var l={toString:function(){return this.valid?"valid":this.error.message}};return l.errors=c.errors,l.missing=c.missing,l.valid=0===l.errors.length,l},addSchema:function(){return o.addSchema.apply(o,arguments)},getSchema:function(){return o.getSchema.apply(o,arguments)},getSchemaMap:function(){return o.getSchemaMap.apply(o,arguments)},getSchemaUris:function(){return o.getSchemaUris.apply(o,arguments)},getMissingUris:function(){return o.getMissingUris.apply(o,arguments)},dropSchemas:function(){o.dropSchemas.apply(o,arguments)},defineKeyword:function(){o.defineKeyword.apply(o,arguments)},defineError:function(t,e,n){if("string"!=typeof t||!/^[A-Z]+(_[A-Z]+)*$/.test(t))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof e||e%1!=0||e<1e4)throw new Error("Code number must be an integer > 10000");if(void 0!==y[t])throw new Error("Error already defined: "+t+" as "+y[t]);if(void 0!==b[e])throw new Error("Error code already used: "+b[e]+" as "+e);for(var r in y[t]=e,b[e]=t,E[t]=E[e]=n,S){var o=S[r];o[t]&&(o[e]=o[e]||o[t])}},reset:function(){o.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:g,resolveUrl:h,getDocumentUri:m,errorCodes:y};return i.language(e||"en"),i}();return P.addLanguage("en-gb",E),P.tv4=P,P})?r.apply(e,o):r)||(t.exports=i)},function(t){t.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-04/schema","id":"graph.json","title":"FBP graph","description":"A graph of FBP processes and connections between them.\\nThis is the primary way of specifying FBP programs.\\n","name":"graph","type":"object","additionalProperties":false,"properties":{"caseSensitive":{"type":"boolean","description":"Whether the graph port identifiers should be treated as case-sensitive"},"properties":{"type":"object","description":"User-defined properties attached to the graph.","additionalProperties":true,"properties":{"name":{"type":"string","description":"Name of the graph"},"environment":{"type":"object","description":"Information about the execution environment for the graph","additionalProperties":true,"required":["type"],"properties":{"type":{"type":"string","description":"Runtime type the graph is for","example":"noflo-nodejs"},"content":{"type":"string","description":"HTML fixture for browser-based graphs"}}},"description":{"type":"string","description":"Graph description"},"icon":{"type":"string","description":"Name of the icon that can be used for depicting the graph"}}},"inports":{"type":["object","undefined"],"description":"Exported inports of the graph","additionalProperties":true,"patternProperties":{"[a-z0-9]+":{"type":"object","properties":{"process":{"type":"string"},"port":{"type":"string"},"metadata":{"type":"object","additionalProperties":true,"required":[],"properties":{"x":{"type":"integer","description":"X coordinate of a graph inport"},"y":{"type":"integer","description":"Y coordinate of a graph inport"}}}}}}},"outports":{"type":["object","undefined"],"description":"Exported outports of the graph","additionalProperties":true,"patternProperties":{"[a-z0-9]+":{"type":"object","properties":{"process":{"type":"string"},"port":{"type":"string"},"metadata":{"type":"object","required":[],"additionalProperties":true,"properties":{"x":{"type":"integer","description":"X coordinate of a graph outport"},"y":{"type":"integer","description":"Y coordinate of a graph outport"}}}}}}},"groups":{"type":"array","description":"List of groups of processes","items":{"type":"object","additionalProperties":false,"properties":{"name":{"type":"string"},"nodes":{"type":"array","items":{"type":"string"}},"metadata":{"type":"object","additionalProperties":true,"required":[],"properties":{"description":{"type":"string"}}}}}},"processes":{"type":"object","description":"The processes of this graph.\\nEach process is an instance of a component.\\n","additionalProperties":false,"patternProperties":{"[a-zA-Z0-9_]+":{"type":"object","properties":{"component":{"type":"string"},"metadata":{"type":"object","additionalProperties":true,"required":[],"properties":{"x":{"type":"integer","description":"X coordinate of a graph node"},"y":{"type":"integer","description":"Y coordinate of a graph node"}}}}}}},"connections":{"type":"array","description":"Connections of the graph.\\nA connection either connects ports of two processes, or specifices an IIP as initial input packet to a port.\\n","items":{"type":"object","additionalProperties":false,"properties":{"src":{"type":"object","additionalProperties":false,"properties":{"process":{"type":"string"},"port":{"type":"string"},"index":{"type":"integer"}}},"tgt":{"type":"object","additionalProperties":false,"properties":{"process":{"type":"string"},"port":{"type":"string"},"index":{"type":"integer"}}},"data":{},"metadata":{"type":"object","additionalProperties":true,"required":[],"properties":{"route":{"type":"integer","description":"Route identifier of a graph edge"},"schema":{"type":"string","format":"uri","description":"JSON schema associated with a graph edge"},"secure":{"type":"boolean","description":"Whether edge data should be treated as secure"}}}}}}}}')},function(t,e,n){var r,o,i,a,s,c,u,l=function(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")};({EventEmitter:r}=n(2)),c=n(19),u=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return`${e.id}(${e.component})`;case"removeNode":return`DEL ${e.id}(${e.component})`;case"renameNode":return`RENAME ${e.oldId} ${e.newId}`;case"changeNode":return"META "+e.id;case"addEdge":return`${e.from.node} ${e.from.port} -> ${e.to.port} ${e.to.node}`;case"removeEdge":return`${e.from.node} ${e.from.port} -X> ${e.to.port} ${e.to.node}`;case"changeEdge":return`META ${e.from.node} ${e.from.port} -> ${e.to.port} ${e.to.node}`;case"addInitial":return`'${e.from.data}' -> ${e.to.port} ${e.to.node}`;case"removeInitial":return`'${e.from.data}' -X> ${e.to.port} ${e.to.node}`;case"startTransaction":return`>>> ${t.rev}: ${e.id}`;case"endTransaction":return`<<< ${t.rev}: ${e.id}`;case"changeProperties":return"PROPERTIES";case"addGroup":return"GROUP "+e.name;case"renameGroup":return`RENAME GROUP ${e.oldName} ${e.newName}`;case"removeGroup":return"DEL GROUP "+e.name;case"changeGroup":return"META GROUP "+e.name;case"addInport":return"INPORT "+e.name;case"removeInport":return"DEL INPORT "+e.name;case"renameInport":return`RENAME INPORT ${e.oldId} ${e.newId}`;case"changeInport":return"META INPORT "+e.name;case"addOutport":return"OUTPORT "+e.name;case"removeOutport":return"DEL OUTPORT "+e.name;case"renameOutport":return`RENAME OUTPORT ${e.oldId} ${e.newId}`;case"changeOutport":return"META OUTPORT "+e.name;default:throw new Error("Unknown journal entry: "+t.cmd)}},s=function(t,e){var n,r,o;for(n in r={},t)o=t[n],r[n]=null;for(n in e)o=e[n],r[n]=o;return r},i=function(){class t extends r{constructor(t){super(),this.graph=t,this.lastRevision=0}putTransaction(t,e){return t>this.lastRevision&&(this.lastRevision=t),this.emit("transaction",t)}fetchTransaction(t,e){}}return t.prototype.lastRevision=0,t}.call(this),a=class extends i{constructor(t){super(t),this.transactions=[]}putTransaction(t,e){return super.putTransaction(t,e),this.transactions[t]=e}fetchTransaction(t){return this.transactions[t]}},o=function(){class t extends r{constructor(t,e,n){var r,o,i,s,c,u,l,p,d,f,h,m,g,v,y,b,w,E,k,S;if(super(),this.startTransaction=this.startTransaction.bind(this),this.endTransaction=this.endTransaction.bind(this),this.graph=t,this.entries=[],this.subscribed=!0,this.store=n||new a(this.graph),0===this.store.transactions.length){for(this.currentRevision=-1,this.startTransaction("initial",e),s=0,l=(v=this.graph.nodes).length;s<l;s++)g=v[s],this.appendCommand("addNode",g);for(u=0,p=(y=this.graph.edges).length;u<p;u++)r=y[u],this.appendCommand("addEdge",r);for(h=0,d=(b=this.graph.initializers).length;h<d;h++)i=b[h],this.appendCommand("addInitial",i);for(c in Object.keys(this.graph.properties).length>0&&this.appendCommand("changeProperties",this.graph.properties,{}),w=this.graph.inports)S=w[c],this.appendCommand("addInport",{name:c,port:S});for(c in E=this.graph.outports)S=E[c],this.appendCommand("addOutport",{name:c,port:S});for(m=0,f=(k=this.graph.groups).length;m<f;m++)o=k[m],this.appendCommand("addGroup",o);this.endTransaction("initial",e)}else this.currentRevision=this.store.lastRevision;this.graph.on("addNode",t=>this.appendCommand("addNode",t)),this.graph.on("removeNode",t=>this.appendCommand("removeNode",t)),this.graph.on("renameNode",(t,e)=>{var n;return n={oldId:t,newId:e},this.appendCommand("renameNode",n)}),this.graph.on("changeNode",(t,e)=>this.appendCommand("changeNode",{id:t.id,new:t.metadata,old:e})),this.graph.on("addEdge",t=>this.appendCommand("addEdge",t)),this.graph.on("removeEdge",t=>this.appendCommand("removeEdge",t)),this.graph.on("changeEdge",(t,e)=>this.appendCommand("changeEdge",{from:t.from,to:t.to,new:t.metadata,old:e})),this.graph.on("addInitial",t=>this.appendCommand("addInitial",t)),this.graph.on("removeInitial",t=>this.appendCommand("removeInitial",t)),this.graph.on("changeProperties",(t,e)=>this.appendCommand("changeProperties",{new:t,old:e})),this.graph.on("addGroup",t=>this.appendCommand("addGroup",t)),this.graph.on("renameGroup",(t,e)=>this.appendCommand("renameGroup",{oldName:t,newName:e})),this.graph.on("removeGroup",t=>this.appendCommand("removeGroup",t)),this.graph.on("changeGroup",(t,e)=>this.appendCommand("changeGroup",{name:t.name,new:t.metadata,old:e})),this.graph.on("addExport",t=>this.appendCommand("addExport",t)),this.graph.on("removeExport",t=>this.appendCommand("removeExport",t)),this.graph.on("addInport",(t,e)=>this.appendCommand("addInport",{name:t,port:e})),this.graph.on("removeInport",(t,e)=>this.appendCommand("removeInport",{name:t,port:e})),this.graph.on("renameInport",(t,e)=>this.appendCommand("renameInport",{oldId:t,newId:e})),this.graph.on("changeInport",(t,e,n)=>this.appendCommand("changeInport",{name:t,new:e.metadata,old:n})),this.graph.on("addOutport",(t,e)=>this.appendCommand("addOutport",{name:t,port:e})),this.graph.on("removeOutport",(t,e)=>this.appendCommand("removeOutport",{name:t,port:e})),this.graph.on("renameOutport",(t,e)=>this.appendCommand("renameOutport",{oldId:t,newId:e})),this.graph.on("changeOutport",(t,e,n)=>this.appendCommand("changeOutport",{name:t,new:e.metadata,old:n})),this.graph.on("startTransaction",(t,e)=>this.startTransaction(t,e)),this.graph.on("endTransaction",(t,e)=>this.endTransaction(t,e))}startTransaction(e,n){if(l(this,t),this.subscribed){if(this.entries.length>0)throw Error("Inconsistent @entries");return this.currentRevision++,this.appendCommand("startTransaction",{id:e,metadata:n},this.currentRevision)}}endTransaction(e,n){if(l(this,t),this.subscribed)return this.appendCommand("endTransaction",{id:e,metadata:n},this.currentRevision),this.store.putTransaction(this.currentRevision,this.entries),this.entries=[]}appendCommand(t,e,n){var r;if(this.subscribed)return r={cmd:t,args:c(e)},null!=n&&(r.rev=n),this.entries.push(r)}executeEntry(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.addNode(e.id,e.component);case"removeNode":return this.graph.removeNode(e.id);case"renameNode":return this.graph.renameNode(e.oldId,e.newId);case"changeNode":return this.graph.setNodeMetadata(e.id,s(e.old,e.new));case"addEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,s(e.old,e.new));case"addInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"removeInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.new);case"addGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"renameGroup":return this.graph.renameGroup(e.oldName,e.newName);case"removeGroup":return this.graph.removeGroup(e.name);case"changeGroup":return this.graph.setGroupMetadata(e.name,s(e.old,e.new));case"addInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"removeInport":return this.graph.removeInport(e.name);case"renameInport":return this.graph.renameInport(e.oldId,e.newId);case"changeInport":return this.graph.setInportMetadata(e.name,s(e.old,e.new));case"addOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata(e.name));case"removeOutport":return this.graph.removeOutport;case"renameOutport":return this.graph.renameOutport(e.oldId,e.newId);case"changeOutport":return this.graph.setOutportMetadata(e.name,s(e.old,e.new));default:throw new Error("Unknown journal entry: "+t.cmd)}}executeEntryInversed(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.removeNode(e.id);case"removeNode":return this.graph.addNode(e.id,e.component);case"renameNode":return this.graph.renameNode(e.newId,e.oldId);case"changeNode":return this.graph.setNodeMetadata(e.id,s(e.new,e.old));case"addEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,s(e.new,e.old));case"addInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"removeInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.old);case"addGroup":return this.graph.removeGroup(e.name);case"renameGroup":return this.graph.renameGroup(e.newName,e.oldName);case"removeGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"changeGroup":return this.graph.setGroupMetadata(e.name,s(e.new,e.old));case"addInport":return this.graph.removeInport(e.name);case"removeInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameInport":return this.graph.renameInport(e.newId,e.oldId);case"changeInport":return this.graph.setInportMetadata(e.name,s(e.new,e.old));case"addOutport":return this.graph.removeOutport(e.name);case"removeOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameOutport":return this.graph.renameOutport(e.newId,e.oldId);case"changeOutport":return this.graph.setOutportMetadata(e.name,s(e.new,e.old));default:throw new Error("Unknown journal entry: "+t.cmd)}}moveToRevision(t){var e,n,r,o,i,a,s,c,u,l,p,d,f;if(t!==this.currentRevision){if(this.subscribed=!1,t>this.currentRevision)for(u=o=l=this.currentRevision+1,p=t;l<=p?o<=p:o>=p;u=l<=p?++o:--o)for(i=0,a=(d=this.store.fetchTransaction(u)).length;i<a;i++)n=d[i],this.executeEntry(n);else for(u=s=this.currentRevision,f=t+1;s>=f;u=s+=-1)for(r=c=(e=this.store.fetchTransaction(u)).length-1;c>=0;r=c+=-1)this.executeEntryInversed(e[r]);return this.currentRevision=t,this.subscribed=!0}}undo(){if(this.canUndo())return this.moveToRevision(this.currentRevision-1)}canUndo(){return this.currentRevision>0}redo(){if(this.canRedo())return this.moveToRevision(this.currentRevision+1)}canRedo(){return this.currentRevision<this.store.lastRevision}toPrettyString(t,e){var n,r,o,i,a,s,c,l,p;for(s=[],c=o=l=t|=0,p=e|=this.store.lastRevision;l<=p?o<p:o>p;c=l<=p?++o:--o)for(i=0,a=(n=this.store.fetchTransaction(c)).length;i<a;i++)r=n[i],s.push(u(r));return s.join("\n")}toJSON(t,e){var n,r,o,i,a,s,c,l;for(n=[],s=o=t|=0,c=e|=this.store.lastRevision;o<c;s=o+=1)for(i=0,a=(l=this.store.fetchTransaction(s)).length;i<a;i++)r=l[i],n.push(u(r));return n}save(t,e){var r;return r=JSON.stringify(this.toJSON(),null,4),n(3).writeFile(t+".json",r,"utf-8",(function(n,r){if(n)throw n;return e(t)}))}}return t.prototype.graph=null,t.prototype.entries=[],t.prototype.subscribed=!0,t}.call(this),e.Journal=o,e.JournalStore=i,e.MemoryJournalStore=a},function(t,e,n){var r=n(47),o={"browser-app/DoSomething":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  // Define a meaningful icon for component from http://fontawesome.io/icons/\n  c.icon = 'cog';\n  // Provide a description on component usage\n  c.description = 'do X';\n  // Add input ports\n  c.inPorts.add('in', {\n    datatype: 'string',\n  });\n  // Add output ports\n  c.outPorts.add('out', {\n    datatype: 'string',\n  });\n  // What to do when port receives a packet\n  c.process((input, output) => {\n    // Check that input has received data packet\n    if (!input.hasData('in')) {\n      return;\n    }\n    // Read the contents of the data packet\n    const data = input.getData('in');\n    // Send the contents to output port\n    output.send({\n      out: data,\n    });\n    // Finish processing\n    output.done();\n  });\n  return c;\n};\n",tests:"topic: \"browser-app/DoSomething\"\ncases:\n-\n  name: 'sending a boolean'\n  assertion: 'should repeat the same'\n  inputs:\n    in: true\n  expect:\n    out:\n     equals: true\n-\n  name: 'sending a number'\n  assertion: 'should repeat the same'\n  inputs:\n    in: 1000\n  expect:\n    out:\n      equals: 1000\n-\n  name: 'sending a string'\n  assertion: 'should repeat the same'\n  inputs:\n    in: \"my string\"\n  expect:\n    out:\n      equals: \"my string\"\n"},Graph:{language:"javascript",source:'"use strict";\n\nfunction _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n//     NoFlo - Flow-Based Programming for JavaScript\n//     (c) 2013-2017 Flowhub UG\n//     (c) 2011-2012 Henri Bergius, Nemein\n//     NoFlo may be freely distributed under the MIT license\n\n/* eslint-disable\n    class-methods-use-this,\n    import/no-unresolved,\n*/\nvar noflo = require(\'../lib/NoFlo\'); // The Graph component is used to wrap NoFlo Networks into components inside\n// another network.\n\n\nvar Graph = /*#__PURE__*/function (_noflo$Component) {\n  _inherits(Graph, _noflo$Component);\n\n  var _super = _createSuper(Graph);\n\n  function Graph(metadata) {\n    var _this;\n\n    _classCallCheck(this, Graph);\n\n    _this = _super.call(this);\n    _this.metadata = metadata;\n    _this.network = null;\n    _this.ready = true;\n    _this.started = false;\n    _this.starting = false;\n    _this.baseDir = null;\n    _this.loader = null;\n    _this.load = 0;\n    _this.inPorts = new noflo.InPorts({\n      graph: {\n        datatype: \'all\',\n        description: \'NoFlo graph definition to be used with the subgraph component\',\n        required: true\n      }\n    });\n    _this.outPorts = new noflo.OutPorts();\n\n    _this.inPorts.graph.on(\'ip\', function (packet) {\n      if (packet.type !== \'data\') {\n        return;\n      }\n\n      _this.setGraph(packet.data, function (err) {\n        // TODO: Port this part to Process API and use output.error method instead\n        if (err) {\n          _this.error(err);\n        }\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Graph, [{\n    key: "setGraph",\n    value: function setGraph(graph, callback) {\n      var _this2 = this;\n\n      this.ready = false;\n\n      if (_typeof(graph) === \'object\') {\n        if (typeof graph.addNode === \'function\') {\n          // Existing Graph object\n          this.createNetwork(graph, callback);\n          return;\n        } // JSON definition of a graph\n\n\n        noflo.graph.loadJSON(graph, function (err, instance) {\n          var inst = instance;\n\n          if (err) {\n            callback(err);\n            return;\n          }\n\n          inst.baseDir = _this2.baseDir;\n\n          _this2.createNetwork(inst, callback);\n        });\n        return;\n      }\n\n      var graphName = graph;\n\n      if (graphName.substr(0, 1) !== \'/\' && graphName.substr(1, 1) !== \':\' && process && process.cwd) {\n        graphName = "".concat(process.cwd(), "/").concat(graphName);\n      }\n\n      noflo.graph.loadFile(graphName, function (err, instance) {\n        var inst = instance;\n\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        inst.baseDir = _this2.baseDir;\n\n        _this2.createNetwork(inst, callback);\n      });\n    }\n  }, {\n    key: "createNetwork",\n    value: function createNetwork(graph, callback) {\n      var _this3 = this;\n\n      this.description = graph.properties.description || \'\';\n      this.icon = graph.properties.icon || this.icon;\n      var graphObj = graph;\n\n      if (!graphObj.name) {\n        graphObj.name = this.nodeId;\n      }\n\n      graphObj.componentLoader = this.loader;\n      noflo.createNetwork(graphObj, {\n        delay: true,\n        subscribeGraph: false\n      }, function (err, network) {\n        _this3.network = network;\n\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        _this3.emit(\'network\', _this3.network); // Subscribe to network lifecycle\n\n\n        _this3.subscribeNetwork(_this3.network); // Wire the network up\n\n\n        _this3.network.connect(function (err2) {\n          if (err2) {\n            callback(err2);\n            return;\n          }\n\n          Object.keys(_this3.network.processes).forEach(function (name) {\n            // Map exported ports to local component\n            var node = _this3.network.processes[name];\n\n            _this3.findEdgePorts(name, node);\n          }); // Finally set ourselves as "ready"\n\n          _this3.setToReady();\n\n          callback();\n        });\n      });\n    }\n  }, {\n    key: "subscribeNetwork",\n    value: function subscribeNetwork() {\n      var _this4 = this;\n\n      var contexts = [];\n      this.network.on(\'start\', function () {\n        var ctx = {};\n        contexts.push(ctx);\n        return _this4.activate(ctx);\n      });\n      return this.network.on(\'end\', function () {\n        var ctx = contexts.pop();\n\n        if (!ctx) {\n          return;\n        }\n\n        _this4.deactivate(ctx);\n      });\n    }\n  }, {\n    key: "isExportedInport",\n    value: function isExportedInport(port, nodeName, portName) {\n      // First we check disambiguated exported ports\n      var keys = Object.keys(this.network.graph.inports);\n\n      for (var i = 0; i < keys.length; i += 1) {\n        var pub = keys[i];\n        var priv = this.network.graph.inports[pub];\n\n        if (priv.process === nodeName && priv.port === portName) {\n          return pub;\n        }\n      } // Component has exported ports and this isn\'t one of them\n\n\n      return false;\n    }\n  }, {\n    key: "isExportedOutport",\n    value: function isExportedOutport(port, nodeName, portName) {\n      // First we check disambiguated exported ports\n      var keys = Object.keys(this.network.graph.outports);\n\n      for (var i = 0; i < keys.length; i += 1) {\n        var pub = keys[i];\n        var priv = this.network.graph.outports[pub];\n\n        if (priv.process === nodeName && priv.port === portName) {\n          return pub;\n        }\n      } // Component has exported ports and this isn\'t one of them\n\n\n      return false;\n    }\n  }, {\n    key: "setToReady",\n    value: function setToReady() {\n      var _this5 = this;\n\n      if (typeof process !== \'undefined\' && process.execPath && process.execPath.indexOf(\'node\') !== -1) {\n        process.nextTick(function () {\n          _this5.ready = true;\n          return _this5.emit(\'ready\');\n        });\n      } else {\n        setTimeout(function () {\n          _this5.ready = true;\n          return _this5.emit(\'ready\');\n        }, 0);\n      }\n    }\n  }, {\n    key: "findEdgePorts",\n    value: function findEdgePorts(name, process) {\n      var _this6 = this;\n\n      var inPorts = process.component.inPorts.ports;\n      var outPorts = process.component.outPorts.ports;\n      Object.keys(inPorts).forEach(function (portName) {\n        var port = inPorts[portName];\n\n        var targetPortName = _this6.isExportedInport(port, name, portName);\n\n        if (targetPortName === false) {\n          return;\n        }\n\n        _this6.inPorts.add(targetPortName, port);\n\n        _this6.inPorts[targetPortName].on(\'connect\', function () {\n          // Start the network implicitly if we\'re starting to get data\n          if (_this6.starting) {\n            return;\n          }\n\n          if (_this6.network.isStarted()) {\n            return;\n          }\n\n          if (_this6.network.startupDate) {\n            // Network was started, but did finish. Re-start simply\n            _this6.network.setStarted(true);\n\n            return;\n          } // Network was never started, start properly\n\n\n          _this6.setUp(function () {});\n        });\n      });\n      Object.keys(outPorts).forEach(function (portName) {\n        var port = outPorts[portName];\n\n        var targetPortName = _this6.isExportedOutport(port, name, portName);\n\n        if (targetPortName === false) {\n          return;\n        }\n\n        _this6.outPorts.add(targetPortName, port);\n      });\n      return true;\n    }\n  }, {\n    key: "isReady",\n    value: function isReady() {\n      return this.ready;\n    }\n  }, {\n    key: "isSubgraph",\n    value: function isSubgraph() {\n      return true;\n    }\n  }, {\n    key: "isLegacy",\n    value: function isLegacy() {\n      return false;\n    }\n  }, {\n    key: "setUp",\n    value: function setUp(callback) {\n      var _this7 = this;\n\n      this.starting = true;\n\n      if (!this.isReady()) {\n        this.once(\'ready\', function () {\n          _this7.setUp(callback);\n        });\n        return;\n      }\n\n      if (!this.network) {\n        callback(null);\n        return;\n      }\n\n      this.network.start(function (err) {\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        _this7.starting = false;\n        callback();\n      });\n    }\n  }, {\n    key: "tearDown",\n    value: function tearDown(callback) {\n      this.starting = false;\n\n      if (!this.network) {\n        callback(null);\n        return;\n      }\n\n      this.network.stop(function (err) {\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        callback();\n      });\n    }\n  }]);\n\n  return Graph;\n}(noflo.Component);\n\nexports.getComponent = function (metadata) {\n  return new Graph(metadata);\n};'},"core/Callback":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = `This component calls a given callback function for each\nIP it receives.  The Callback component is typically used to connect\nNoFlo with external Node.js code.`;\n  c.icon = 'sign-out';\n\n  c.inPorts.add('in', {\n    description: 'Object passed as argument of the callback',\n    datatype: 'all',\n  });\n  c.inPorts.add('callback', {\n    description: 'Callback to invoke',\n    datatype: 'function',\n    control: true,\n    required: true,\n  });\n  c.outPorts.add(\n    'error',\n    { datatype: 'object' },\n  );\n\n  return c.process((input, output) => {\n    if (!input.hasData('callback', 'in')) {\n      return;\n    }\n    const [callback, data] = input.getData('callback', 'in');\n    if (typeof callback !== 'function') {\n      output.done(new Error('The provided callback must be a function'));\n      return;\n    }\n\n    // Call the callback when receiving data\n    try {\n      callback(data);\n    } catch (e) {\n      output.done(e);\n      return;\n    }\n    output.done();\n  });\n};\n"},"core/Copy":{language:"javascript",source:"const noflo = require('noflo');\nconst owl = require('owl-deepcopy');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'deep (i.e. recursively) copy an object';\n  c.icon = 'copy';\n\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to be copied',\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n    description: 'Copy of the original packet',\n  });\n\n  return c.process((input, output) => {\n    if (!input.hasData('in')) {\n      return;\n    }\n    const data = input.getData('in');\n\n    const copy = owl.deepCopy(data);\n    output.sendDone({ out: copy });\n  });\n};\n"},"core/DisconnectAfterPacket":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'Makes each data packet a stream of its own';\n  c.icon = 'pause';\n  c.forwardBrackets = {};\n  c.autoOrdering = false;\n\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to be forward with disconnection',\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  let brackets = {};\n  c.tearDown = (callback) => {\n    brackets = {};\n    callback();\n  };\n  return c.process((input, output) => {\n    // Force auto-ordering to be off for this one\n    c.autoOrdering = false;\n\n    const data = input.get('in');\n    if (!brackets[input.scope]) { brackets[input.scope] = []; }\n    if (data.type === 'openBracket') {\n      brackets[input.scope].push(data.data);\n      output.done();\n      return;\n    }\n    if (data.type === 'closeBracket') {\n      brackets[input.scope].pop();\n      output.done();\n      return;\n    }\n\n    if (data.type !== 'data') { return; }\n\n    brackets[input.scope].forEach((bracket) => {\n      output.sendIP('out', new noflo.IP('openBracket', bracket));\n    });\n    output.sendIP('out', data);\n    const closes = brackets[input.scope].slice(0);\n    closes.reverse();\n    brackets[input.scope].forEach((bracket) => {\n      output.sendIP('out', new noflo.IP('closeBracket', bracket));\n    });\n\n    output.done();\n  });\n};\n"},"core/Drop":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'This component drops every packet it receives with no action';\n  c.icon = 'trash-o';\n\n  c.inPorts.add('in', {\n    datatypes: 'all',\n    description: 'Packet to be dropped',\n  });\n\n  return c.process((input, output) => {\n    const data = input.get('in');\n    data.drop();\n    output.done();\n  });\n};\n"},"core/Kick":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = `This component generates a single packet and sends it to\nthe output port. Mostly usable for debugging, but can also be useful\nfor starting up networks.`;\n  c.icon = 'share';\n\n  c.inPorts.add('in', {\n    datatype: 'bang',\n    description: 'Signal to send the data packet',\n  });\n  c.inPorts.add('data', {\n    datatype: 'all',\n    description: 'Packet to be sent',\n    control: true,\n    default: null,\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  return c.process((input, output) => {\n    if (!input.hasStream('in')) { return; }\n    if (input.attached('data').length && !input.hasData('data')) { return; }\n    input.getData('in');\n    const data = input.getData('data');\n    output.send({ out: data });\n    output.done();\n  });\n};\n"},"core/MakeFunction":{language:"javascript",source:"/* eslint no-new-func: \"warn\" */\nconst noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = `Evaluates a function each time data hits the \"in\" port \nand sends the return value to \"out\". Within the function \"x\" will \nbe the variable from the in port. For example, to make a ^2 function \ninput \"return x*x;\" to the function port.`;\n  c.icon = 'code';\n\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to be processed',\n  });\n  c.inPorts.add('function', {\n    datatype: 'string',\n    description: 'Function to evaluate',\n    control: true,\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n  c.outPorts.add('function', {\n    datatype: 'function',\n  });\n  c.outPorts.add('error', {\n    datatype: 'object',\n  });\n\n  const prepareFunction = (func, callback) => {\n    let newFunc;\n    if (typeof func === 'function') {\n      callback(null, func);\n      return;\n    }\n    try {\n      newFunc = Function('x', func);\n    } catch (e) {\n      callback(e);\n      return;\n    }\n    callback(null, newFunc);\n  };\n\n  return c.process((input, output) => {\n    if (input.attached('in').length && !input.hasData('in')) { return; }\n    if (input.hasData('function', 'in')) {\n      // Both function and input data\n      prepareFunction(input.getData('function'), (err, func) => {\n        let result;\n        if (err) {\n          output.done(err);\n          return;\n        }\n        const data = input.getData('in');\n        try {\n          result = func(data);\n        } catch (error) {\n          output.done(error);\n          return;\n        }\n        output.sendDone({\n          function: func,\n          out: result,\n        });\n      });\n      return;\n    }\n    if (!input.hasData('function')) { return; }\n    prepareFunction(input.getData('function'), (err, func) => {\n      if (err) {\n        output.done(err);\n        return;\n      }\n      output.sendDone({ function: func });\n    });\n  });\n};\n"},"core/Merge":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = `This component receives data on multiple input ports and \nsends the same data out to the connected output port`;\n  c.icon = 'compress';\n\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to be forwarded',\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  return c.process((input, output) => {\n    const data = input.get('in');\n    return output.sendDone({ out: data });\n  });\n};\n"},"core/Output":{language:"javascript",source:"const noflo = require('noflo');\nconst { inspect } = require('util');\n\nconst log = (options, data) => {\n  if (options != null) {\n    return console.log(inspect(\n      data,\n      options.showHidden,\n      options.depth,\n      options.colors,\n    ));\n  }\n  return console.log(data);\n};\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'Sends the data items to console.log';\n  c.icon = 'bug';\n\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to be printed through console.log',\n  });\n  c.inPorts.add('options', {\n    datatype: 'object',\n    description: 'Options to be passed to console.log',\n    control: true,\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  return c.process((input, output) => {\n    if (!input.hasData('in')) { return; }\n    if (input.attached('options').length && !input.hasData('options')) { return; }\n\n    let options = null;\n    if (input.has('options')) {\n      options = input.getData('options');\n    }\n\n    const data = input.getData('in');\n    log(options, data);\n    output.sendDone({ out: data });\n  });\n};\n"},"core/ReadGlobal":{language:"javascript",source:"/* global window: true */\nconst noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'Returns the value of a global variable.';\n  c.icon = 'usd';\n\n  c.inPorts.add('name', {\n    description: 'The name of the global variable.',\n    datatype: 'string',\n  });\n\n  c.outPorts.add('value', {\n    description: 'The value of the variable.',\n  });\n  c.outPorts.add('error', {\n    description: 'Any errors that occured reading the variables value.',\n    datatype: 'object',\n  });\n\n  c.forwardBrackets = { name: ['value', 'error'] };\n\n  return c.process((input, output) => {\n    if (!input.hasData('name')) { return; }\n    const data = input.getData('name');\n\n    const value = !noflo.isBrowser() ? global[data] : window[data];\n\n    if (typeof value === 'undefined') {\n      const err = new Error(`\"${data}\" is undefined on the global object.`);\n      output.sendDone(err);\n      return;\n    }\n    output.sendDone({ value });\n  });\n};\n"},"core/Repeat":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = `Forwards packets and metadata in the same way \nit receives them`;\n  c.icon = 'forward';\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to forward',\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  return c.process((input, output) => {\n    const data = input.get('in');\n    output.sendDone({ out: data });\n  });\n};\n",tests:"topic: \"core/Repeat\"\ncases:\n-\n  name: 'sending a boolean'\n  assertion: 'should repeat the same'\n  inputs:\n    in: true\n  expect:\n    out:\n     equals: true\n-\n  name: 'sending a number'\n  assertion: 'should repeat the same'\n  inputs:\n    in: 1000\n  expect:\n    out:\n      equals: 1000\n-\n  name: 'sending a string'\n  assertion: 'should repeat the same'\n  inputs:\n    in: \"my string\"\n  expect:\n    out:\n      equals: \"my string\"\n"},"core/RepeatAsync":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = \"Like 'Repeat', except repeat on next tick\";\n  c.icon = 'step-forward';\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to forward',\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  return c.process((input, output) => {\n    const data = input.get('in');\n    setTimeout(() => output.sendDone({ out: data }), 0);\n  });\n};\n"},"core/RepeatDelayed":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'Forward packet after a set delay';\n  c.icon = 'clock-o';\n\n  c.timers = [];\n\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to be forwarded with a delay',\n  });\n  c.inPorts.add('delay', {\n    datatype: 'number',\n    description: 'How much to delay',\n    default: 500,\n    control: true,\n  });\n\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  c.tearDown = (callback) => {\n    c.timers.forEach(timer => clearTimeout(timer));\n    c.timers = [];\n    return callback();\n  };\n\n  return c.process((input, output) => {\n    if (!input.hasData('in')) { return; }\n    if (input.attached('delay').length && !input.hasData('delay')) { return; }\n\n    let delay = 500;\n    if (input.hasData('delay')) {\n      delay = input.getData('delay');\n    }\n    const payload = input.get('in');\n\n    const timer = setTimeout(() => {\n      c.timers.splice(c.timers.indexOf(timer), 1);\n      return output.sendDone({ out: payload });\n    }, delay);\n    c.timers.push(timer);\n  });\n};\n",tests:"topic: \"core/RepeatDelayed\"\ncases:\n-\n  name: 'sending a boolean'\n  assertion: 'should repeat the same'\n  inputs:\n    in: true\n  expect:\n    out:\n     equals: true\n-\n  name: 'sending a number'\n  assertion: 'should repeat the same'\n  inputs:\n    in: 1000\n  expect:\n    out:\n      equals: 1000\n-\n  name: 'sending a string'\n  assertion: 'should repeat the same'\n  inputs:\n    in: \"my string\"\n  expect:\n    out:\n      equals: \"my string\"\n\n"},"core/RunInterval":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'Send a packet at the given interval';\n  c.icon = 'clock-o';\n  c.inPorts.add('interval', {\n    datatype: 'number',\n    description: 'Interval at which output packets are emitted (ms)',\n    required: true,\n    control: true,\n  });\n  c.inPorts.add('start', {\n    datatype: 'bang',\n    description: 'Start the emission',\n  });\n  c.inPorts.add('stop', {\n    datatype: 'bang',\n    description: 'Stop the emission',\n  });\n  c.outPorts.add('out', {\n    datatype: 'bang',\n  });\n\n  c.timers = {};\n\n  const cleanUp = (scope) => {\n    if (!c.timers[scope]) { return; }\n    clearInterval(c.timers[scope].interval);\n    c.timers[scope].deactivate();\n    c.timers[scope] = null;\n  };\n\n  c.tearDown = (callback) => {\n    Object.keys(c.timers).forEach(cleanUp);\n    c.timers = {};\n    callback();\n  };\n\n  c.forwardBrackets = {};\n  return c.process((input, output, context) => {\n    if (input.hasData('start')) {\n      if (!input.hasData('interval')) { return; }\n      const start = input.get('start');\n      if (start.type !== 'data') { return; }\n      const interval = parseInt(input.getData('interval'), 10);\n      // Ensure we deactivate previous interval in this scope, if any\n      cleanUp(start.scope);\n\n      // Set up interval\n      const ctx = context;\n      ctx.interval = setInterval(() => {\n        const bang = new noflo.IP('data', true);\n        bang.scope = start.scope;\n        return c.outPorts.out.sendIP(bang);\n      }, interval);\n\n      // Register scope, we keep it active until stopped\n      c.timers[start.scope] = context;\n      return;\n    }\n\n    if (input.hasData('stop')) {\n      const stop = input.get('stop');\n      if (stop.type !== 'data') { return; }\n      // Deactivate interval in this scope\n      cleanUp(stop.scope);\n      output.done();\n    }\n  });\n};\n"},"core/RunTimeout":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'Send a packet after the given time in ms';\n  c.icon = 'clock-o';\n\n  c.timer = {};\n\n  c.inPorts.add('time', {\n    datatype: 'number',\n    description: 'Time after which a packet will be sent',\n    required: true,\n    control: true,\n  });\n  c.inPorts.add('start', {\n    datatype: 'bang',\n    description: 'Start the timeout before sending a packet',\n  });\n  c.outPorts.add('out', {\n    datatype: 'bang',\n  });\n\n  c.forwardBrackets = { start: ['out'] };\n\n  c.stopTimer = (scope) => {\n    if (!c.timer[scope]) { return; }\n    clearTimeout(c.timer[scope].timeout);\n    c.timer[scope].deactivate();\n    delete c.timer[scope];\n  };\n\n  c.tearDown = (callback) => {\n    Object.keys(c.timer).forEach(scope => c.stopTimer(scope));\n    callback();\n  };\n\n  return c.process((input, output, context) => {\n    if (!input.hasData('time', 'start')) { return; }\n    const time = parseInt(input.getData('time'), 10);\n    input.getData('start');\n    // Ensure we deactivate previous timeout, if any\n    c.stopTimer(input.scope);\n    // Set up new timer\n    const ctx = context;\n    ctx.timeout = setTimeout(() => {\n      c.timer = null;\n      output.sendDone({ out: true });\n    }, time);\n    c.timer[input.scope] = context;\n  });\n};\n"},"core/SendNext":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.description = 'Sends next packet in buffer when receiving a bang';\n  c.icon = 'forward';\n\n  c.inPorts.add('data', {\n    datatype: 'all',\n  });\n  c.inPorts.add('in', {\n    datatype: 'bang',\n  });\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n  c.outPorts.add('empty', {\n    datatype: 'bang',\n    required: false,\n  });\n\n  c.forwardBrackets = {};\n  return c.process((input, output) => {\n    if (!input.hasData('in')) { return; }\n    const bang = input.getData('in');\n\n    if (!input.hasData('data')) {\n      // No data packets in the buffer, send \"empty\"\n      output.sendDone({ empty: true });\n      return;\n    }\n\n    let sent = false;\n    // Loop until we've either drained the buffer completely, or until\n    // we hit the next data packet\n    while (input.has('data')) {\n      if (sent) {\n        // If we already sent data, we look ahead to see if next packet is data and bail out\n        const buf = c.inPorts.data.getBuffer(bang.scope);\n        if (buf[0].type === 'data') { break; }\n      }\n\n      const packet = input.get('data');\n      output.send({ out: packet });\n      if (packet.type === 'data') { sent = true; }\n    }\n    // After the loop we can deactivate\n    output.done();\n  });\n};\n"},"core/Split":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  c.icon = 'expand';\n  c.description = `This component receives data on a single input port and \nsends the same data out to all connected output ports`;\n\n  c.inPorts.add('in', {\n    datatype: 'all',\n    description: 'Packet to be forwarded',\n  });\n\n  c.outPorts.add('out', {\n    datatype: 'all',\n  });\n\n  return c.process((input, output) => {\n    const data = input.get('in');\n    output.sendDone({ out: data });\n  });\n};\n"},"dom/AddClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Add a class to an element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n\n  c.process (input, output) ->\n    return unless input.has 'element', 'class'\n    [element, className] = input.getData 'element', 'class'\n    element.classList.add className\n    output.done()\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'AddClass component', ->\n  c = null\n  element = null\n  classSocket = null\n  before (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/AddClass', (err, instance) ->\n      return done err if err\n      c = instance\n      element = noflo.internalSocket.createSocket()\n      classSocket = noflo.internalSocket.createSocket()\n      c.inPorts.element.attach element\n      c.inPorts.class.attach classSocket\n      done()\n\n  describe 'adding a class to an element', ->\n    el = document.querySelector '#fixtures .addclass'\n    it 'should be able to add the class', (done) ->\n      element.send el\n      classSocket.send 'foo'\n      setTimeout ->\n        chai.expect(el.classList.contains('foo')).to.equal true\n        done()\n      , 0\n"},"dom/AppendChild":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Append elements as children of a parent element'\n  c.inPorts.add 'parent',\n    datatype: 'object'\n  c.inPorts.add 'child',\n    datatype: 'object'\n\n  c.process (input, output) ->\n    return unless input.hasData 'parent', 'child'\n    [parent, child] = input.getData 'parent', 'child'\n    parent.appendChild child\n    output.done()\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'AppendChild component', ->\n  c = null\n  parent = null\n  child = null\n  before (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/AppendChild', (err, instance) ->\n      return done err if err\n      c = instance\n      parent = noflo.internalSocket.createSocket()\n      child = noflo.internalSocket.createSocket()\n      c.inPorts.parent.attach parent\n      c.inPorts.child.attach child\n      done()\n\n  describe 'adding children to an element', ->\n    el = document.querySelector '#fixtures .appendchild'\n    newEl = document.createElement 'p'\n    it 'should initially have no child elements', ->\n      chai.expect(el.hasChildNodes()).to.equal false\n    it 'should be able to add an element', (done) ->\n      parent.send el\n      child.send newEl\n      setTimeout ->\n        chai.expect(el.hasChildNodes()).to.equal true\n        done()\n      , 0\n"},"dom/CreateElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Create a new DOM Element'\n  c.inPorts.add 'tagname',\n    datatype: 'string'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.forwardBrackets =\n    tagname: ['element']\n\n  c.process (input, output) ->\n    return unless input.hasData 'tagname'\n    if c.inPorts.container.isAttached()\n      # If container is attached, we want it too\n      return unless input.hasData 'container'\n\n    tagname = input.getData 'tagname'\n    element = document.createElement tagname\n    if input.hasData 'container'\n      container = input.getData 'container'\n      container.appendChild element\n\n    output.sendDone\n      element: element\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'CreateElement component', ->\n  c = null\n  tagname = null\n  element = null\n  before (done) ->\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/CreateElement', (err, instance) ->\n      return done err if err\n      c = instance\n      tagname = noflo.internalSocket.createSocket()\n      element = noflo.internalSocket.createSocket()\n      c.inPorts.tagname.attach tagname\n      c.outPorts.element.attach element\n      done()\n\n  describe 'creating an Element', ->\n    it 'should produce a new element', (done) ->\n      element.on 'data', (data) ->\n        chai.expect(data).to.be.instanceof HTMLElement\n        done()\n      tagname.send 'div'\n"},"dom/CreateFragment":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c. description = 'Create a new DOM DocumentFragment'\n  c.inPorts.add 'in',\n    datatype: 'bang'\n  c.outPorts.add 'fragment',\n    datatype: 'object'\n\n  c.forwardBrackets =\n    in: ['fragment']\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    input.getData 'in'\n    fragment = document.createDocumentFragment()\n    output.sendDone\n      fragment: fragment\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'CreateFragment component', ->\n  c = null\n  ins = null\n  fragment = null\n  before (done) ->\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/CreateFragment', (err, instance) ->\n      return done err if err\n      c = instance\n      ins = noflo.internalSocket.createSocket()\n      fragment = noflo.internalSocket.createSocket()\n      c.inPorts.in.attach ins\n      c.outPorts.fragment.attach fragment\n      done()\n\n  describe 'creating a DocumentFragment', ->\n    it 'should produce a new fragment', (done) ->\n      fragment.on 'data', (data) ->\n        chai.expect(data).to.be.instanceof DocumentFragment\n        done()\n      ins.send true\n"},"dom/GetAttribute":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Reads the given attribute from the DOM element on the in\n    port.\"\n\n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element from which to read the attribute from.'\n    required: true\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is read from the DOM element.'\n    required: true\n    control: true\n\n  # Define out ports.\n  c.outPorts.add 'out',\n    datatype: 'string'\n    description: 'Value of the attribute being read.'\n\n  c.forwardBrackets =\n    element: ['out']\n\n  # On data flow.\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'attribute'\n    [element, attribute] = input.getData 'element', 'attribute'\n    value = element.getAttribute attribute\n    output.sendDone\n      out: value\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'GetAttribute component', ->\n  c = null\n  element = null\n  attribute = null\n  out = null\n  el = document.querySelector '#fixtures .getattribute'\n  before (done) ->\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/GetAttribute', (err, instance) ->\n      return done err if err\n      c = instance\n      element = noflo.internalSocket.createSocket()\n      attribute = noflo.internalSocket.createSocket()\n      c.inPorts.element.attach element\n      c.inPorts.attribute.attach attribute\n      done()\n  beforeEach ->\n    out = noflo.internalSocket.createSocket()\n    c.outPorts.out.attach out\n  afterEach ->\n    c.outPorts.out.detach out\n    out = null\n\n  describe 'with matching query', ->\n    it 'should return value', (done) ->\n      out.on 'data', (data) ->\n        chai.expect(data).to.equal 'bar'\n        done()\n      element.send el\n      attribute.send 'foo'\n  describe 'with non-matching query', ->\n    it 'should return a NULL', (done) ->\n      out.on 'data', (data) ->\n        chai.expect(data).to.be.a 'null'\n        done()\n      attribute.send 'bar'\n      element.send el\n"},"dom/GetElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description ='Get a DOM element matching a query'\n  c.inPorts.add 'in',\n    datatype: 'object'\n    description: 'DOM element to constrain the query to'\n  c.inPorts.add 'selector',\n    datatype: 'string'\n    description: 'CSS selector'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.forwardBrackets =\n    selector: ['element', 'error']\n  c.process (input, output) ->\n    return unless input.hasData 'selector'\n    return unless input.hasData 'in' if input.attached('in').length > 0\n    if input.hasData 'in'\n      # Element-scoped selector\n      [container, selector] = input.getData 'in', 'selector'\n      unless typeof container.querySelector is 'function'\n        output.done new Error 'Given container doesn\\'t support querySelectors'\n        return\n      el = container.querySelectorAll selector\n      unless el.length\n        output.done new Error \"No element matching '#{selector}' found under container\"\n        return\n      for element in el\n        output.send\n          element: element\n      output.done()\n      return\n    selector = input.getData 'selector'\n    el = document.querySelectorAll selector\n    unless el.length\n      output.done new Error \"No element matching '#{selector}' found under document\"\n      return\n    for element in el\n      output.send\n        element: element\n    output.done()\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'GetElement component', ->\n  c = null\n  ins = null\n  selector = null\n  element = null\n  error = null\n  before (done) ->\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/GetElement', (err, instance) ->\n      return done err if err\n      c = instance\n      selector = noflo.internalSocket.createSocket()\n      c.inPorts.selector.attach selector\n      done()\n  beforeEach ->\n    element = noflo.internalSocket.createSocket()\n    c.outPorts.element.attach element\n    error = noflo.internalSocket.createSocket()\n    c.outPorts.error.attach error\n  afterEach ->\n    c.outPorts.element.detach element\n    element = null\n    c.outPorts.error.detach error\n    error = null\n\n  describe 'with non-matching query', ->\n    it 'should transmit an Error when ERROR port is attached', (done) ->\n      error.on 'data', (data) ->\n        chai.expect(data).to.be.an.instanceof Error\n        done()\n      selector.send 'Foo'\n\n  describe 'with invalid query', ->\n    before ->\n      ins = noflo.internalSocket.createSocket()\n      c.inPorts.in.attach ins\n    after ->\n      c.inPorts.in.detach ins\n    it 'should transmit an Error when ERROR port is attached', (done) ->\n      error.on 'data', (data) ->\n        chai.expect(data).to.be.an.instanceof Error\n        done()\n      selector.send 'baz'\n      ins.send {}\n\n  describe 'with invalid container', ->\n    before ->\n      ins = noflo.internalSocket.createSocket()\n      c.inPorts.in.attach ins\n    after ->\n      c.inPorts.in.detach ins\n    it 'should transmit an Error when ERROR port is attached', (done) ->\n      error.on 'data', (data) ->\n        chai.expect(data).to.be.an.instanceof Error\n        done()\n      selector.send 'baz'\n      ins.send {}\n\n  describe 'with matching query without container', ->\n    it 'should send the matched element to the ELEMENT port', (done) ->\n      query = '#fixtures .getelement'\n      el = document.querySelector query\n      error.on 'data', (data) ->\n        done data\n      element.on 'data', (data) ->\n        chai.expect(data.tagName).to.exist\n        chai.expect(data.tagName).to.equal 'DIV'\n        chai.expect(data.innerHTML).to.equal 'Foo'\n        chai.expect(data).to.equal el\n        done()\n      selector.send query\n\n  describe 'with matching query with container', ->\n    before ->\n      ins = noflo.internalSocket.createSocket()\n      c.inPorts.in.attach ins\n    after ->\n      c.inPorts.in.detach ins\n    it 'should send the matched element to the ELEMENT port', (done) ->\n      container = document.querySelector '#fixtures'\n      el = document.querySelector '#fixtures .getelement'\n      error.on 'data', (data) ->\n        done data\n      element.on 'data', (data) ->\n        chai.expect(data.tagName).to.exist\n        chai.expect(data.tagName).to.equal 'DIV'\n        chai.expect(data.innerHTML).to.equal 'Foo'\n        chai.expect(data).to.equal el\n        done()\n      ins.send container\n      selector.send '.getelement'\n"},"dom/HasClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Check if an element has a given class'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'missed',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'class'\n    [element, klass] = input.getData 'element', 'class'\n    if element.classList.contains klass\n      output.sendDone\n        element: element\n      return\n    output.sendDone\n      missed: element\n"},"dom/Listen":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'addEventListener for specified event type'\n  c.icon = 'stethoscope'\n\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'type',\n    datatype: 'string'\n  c.inPorts.add 'preventdefault',\n    datatype: 'boolean'\n    control: true\n    default: false\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'event',\n    datatype: 'object'\n\n  c.elements = {}\n  cleanUp = (scope) ->\n    return unless c.elements[scope]\n    {element, event, listener} = c.elements[scope]\n    element.removeEventListener event, listener\n    c.elements[scope].deactivate()\n    delete c.elements[scope]\n  c.tearDown = (callback) ->\n    for scope, element of c.elements\n      cleanUp scope\n    c.elements = {}\n    callback()\n  c.forwardBrackets = {}\n\n  c.process (input, output, context) ->\n\n    return unless input.hasData 'element', 'type'\n    [element, type] = input.getData 'element', 'type'\n\n    preventDefault = false\n    if input.hasData 'preventdefault'\n      preventDefault = input.getData 'preventdefault'\n\n    scope = null\n    cleanUp scope\n\n    context.element = element\n    context.event = type\n    context.listener = (event) ->\n      event.preventDefault() if preventDefault\n      output.send\n        element: context.element\n        event: event\n    c.elements[context] = context\n    element.addEventListener type, context.listener\n"},"dom/ReadHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read HTML from an existing element'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.outPorts.add 'html',\n    datatype: 'string'\n  c.forwardBrackets =\n    container: ['html']\n  c.process (input, output) ->\n    return unless input.hasData 'container'\n    container = input.getData 'container'\n    output.sendDone\n      html: container.innerHTML\n"},"dom/RemoveClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Remove a class from an element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n\n  c.process (input, output) ->\n    return unless input.has 'element', 'class'\n    [element, className] = input.getData 'element', 'class'\n    element.classList.remove className\n    output.done()\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'RemoveClass component', ->\n  c = null\n  element = null\n  classSocket = null\n  before (done) ->\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/RemoveClass', (err, instance) ->\n      return done err if err\n      c = instance\n      element = noflo.internalSocket.createSocket()\n      classSocket = noflo.internalSocket.createSocket()\n      c.inPorts.element.attach element\n      c.inPorts.class.attach classSocket\n      done()\n\n  describe 'removing a class from an element', ->\n    el = document.querySelector '#fixtures .removeclass'\n    it 'should be able to remove the class', (done) ->\n      element.send el\n      classSocket.send 'foo'\n      setTimeout ->\n        chai.expect(el.classList.contains('foo')).to.equal false\n        done()\n      , 0\n"},"dom/RemoveElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Remove an element from DOM'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'element'\n    element = input.getData 'element'\n    return unless element.parentNode\n    element.parentNode.removeChild element\n    output.done()\n"},"dom/RequestAnimationFrame":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nrequestAnimationFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  (callback, element) ->\n    window.setTimeout( ->\n      callback(+new Date())\n    , 1000 / 60)\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends bangs that correspond with screen refresh rate.'\n  c.icon = 'film'\n\n  c.inPorts.add 'start',\n    datatype: 'bang'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.running = {}\n  cleanUp = (scope) ->\n    return unless c.running[scope]\n    c.running[scope].deactivate()\n    delete c.running[scope]\n  c.tearDown = (callback) ->\n    for scope, running of c.running\n      cleanUp scope\n    c.running = {}\n    callback()\n  c.animate = (scope, output) ->\n    # Stop when context has been stopped\n    return unless c.running[scope]\n    # Send bang\n    output.send true\n    # Request next frame\n    requestAnimationFrame c.animate.bind c, scope, output\n\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      start = input.get 'start'\n      return unless start.type is 'data'\n      # Ensure previous was deactivated\n      cleanUp start.scope\n\n      # Register scope\n      c.running[start.scope] = context\n\n      # Request first frame\n      requestAnimationFrame c.animate.bind c, start.scope, output\n      return\n\n    if input.hasData 'stop'\n      stop = input.get 'stop'\n      return unless stop.type is 'data'\n      # Deactivate this scope\n      cleanUp stop.scope\n      return\n"},"dom/SetAttribute":{language:"coffeescript",source:"'use strict'\n\n# @runtime noflo-browser\n\nnoflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Set the given attribute on the DOM element to the received\n    value.\"\n    \n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element on which to set the attribute.'\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is set on the DOM element.'\n\n  c.inPorts.add 'value',\n    datatype: 'string'\n    description: 'Value of the attribute being set.'\n  \n  # Define out ports.\n  c.outPorts.add 'element',\n    datatype: 'object'\n    description: 'The element that was updated.'\n\n  c.forwardBrackets =\n    element: ['element']\n    value: ['element']\n\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'attribute', 'value'\n    [element, attribute, value] = input.getData 'element', 'attribute', 'value'\n    if typeof value is 'object'\n      if toString.call(value) is '[object Array]'\n        value = value.join ' '\n      else\n        newVal = []\n        newVal.push val for key, val of value\n        value = newVal.join ' '\n    if attribute is \"value\"\n      element.value = value\n    else\n      element.setAttribute attribute, value\n\n    output.sendDone\n      element: element\n",tests:"noflo = require 'noflo'\nbaseDir = 'noflo-dom'\n\ndescribe 'SetAttribute component', ->\n  c = null\n  element = null\n  attribute = null\n  value = null\n  out = null\n  el = document.querySelector '#fixtures .setattribute'\n  before (done) ->\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'dom/SetAttribute', (err, instance) ->\n      return done err if err\n      c = instance\n      element = noflo.internalSocket.createSocket()\n      attribute = noflo.internalSocket.createSocket()\n      value = noflo.internalSocket.createSocket()\n      c.inPorts.element.attach element\n      c.inPorts.attribute.attach attribute\n      c.inPorts.value.attach value\n      done()\n  beforeEach ->\n    out = noflo.internalSocket.createSocket()\n    c.outPorts.element.attach out\n  afterEach ->\n    c.outPorts.element.detach out\n    out = null\n\n  describe 'when called', ->\n    it 'should return element', (done) ->\n      out.on 'data', (data) ->\n        chai.expect(data).to.equal el\n        done()\n      element.send el\n      attribute.send 'foo'\n      value.send 'baz'\n  describe 'with matching query', ->\n    it 'should update attribute', (done) ->\n      out.on 'data', (data) ->\n        content = el.getAttribute 'foo'\n        chai.expect(content).to.equal 'baz'\n        done()\n      element.send el\n      attribute.send 'foo'\n      value.send 'baz'\n  describe 'with non-matching query', ->\n    it 'should create attribute', (done) ->\n      out.on 'data', (data) ->\n        content = el.getAttribute 'bar'\n        chai.expect(content).to.equal 'baz'\n        done()\n      element.send el\n      attribute.send 'bar'\n      value.send 'baz'\n\n"},"dom/WriteHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Write HTML inside an existing element'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.inPorts.add 'html',\n    datatype: 'string'\n  c.outPorts.add 'container',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'container', 'html'\n    [container, html] = input.getData 'container', 'html'\n    container.innerHTML = html\n    output.sendDone\n      container: container\n"},"interaction/Focus":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'i-cursor'\n  c.description = 'focus element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'element to be focused'\n    control: true\n  c.inPorts.add 'trigger',\n    datatype: 'bang'\n    description: 'trigger focus'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'trigger'\n    element = input.getData 'element'\n    input.getData 'trigger'\n    window.setTimeout ->\n      element.focus()\n      output.sendDone\n        out: true\n    , 0\n",tests:"noflo = require 'noflo'\nsocket = noflo.internalSocket\nbaseDir = 'noflo-interaction'\n\ndescribe 'Focus component', ->\n  c = null\n  element = null\n  trigger = null\n  out = null\n\n  beforeEach (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'interaction/Focus', (err, instance) ->\n      return done err if err\n      c = instance\n      element = socket.createSocket()\n      trigger = socket.createSocket()\n      out = socket.createSocket()\n\n      c.inPorts.element.attach element\n      c.inPorts.trigger.attach trigger\n      c.outPorts.out.attach out\n      done()\n\n  describe 'on trigger', ->\n    it 'should call focus', (done) ->\n      input = document.createElement 'input'\n\n      focusCalled = false\n      input.focus = callback = -> focusCalled = true\n      element.send input\n\n      chai.expect(focusCalled).to.equal false\n\n      out.once 'data', (data) ->\n        chai.expect(focusCalled).to.equal true\n        done()\n\n      trigger.send true\n\n"},"interaction/ListenChange":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to changes on an input element'\n  c.icon = 'hourglass'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'value',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'change', element.listener, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      listener: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          value: event.target.value\n      ctx: context\n    data.el.addEventListener 'change', data.listener, false\n    c.elements.push data\n    return\n"},"interaction/ListenDrag":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description =  'Listen to drag events on a DOM element'\n  c.icon = 'arrows'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'start',\n    datatype: 'object'\n  c.outPorts.add 'movey',\n    datatype: 'number'\n  c.outPorts.add 'movex',\n    datatype: 'number'\n  c.outPorts.add 'end',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'dragstart', element.dragstart, false\n      element.el.removeEventListener 'drag', element.dragmove, false\n      element.el.removeEventListener 'dragend', element.dragend, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      dragstart: (event) ->\n        event.stopPropagation()\n        output.send\n          start: event\n      dragmove: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          movex: event.clientX\n          movey: event.clientY\n      dragend: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          end: event\n      ctx: context\n    data.el.addEventListener 'dragstart', data.dragstart, false\n    data.el.addEventListener 'drag', data.dragmove, false\n    data.el.addEventListener 'dragend', data.dragend, false\n    c.elements.push data\n    return\n",tests:"noflo = require 'noflo'\nsocket = noflo.internalSocket\nbaseDir = 'noflo-interaction'\n\ndescribe 'ListenDrag component', ->\n  c = null\n  element = null\n  start = null\n  movex = null\n  movey = null\n  end = null\n  beforeEach (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'interaction/ListenDrag', (err, instance) ->\n      return done err if err\n      c = instance\n      element = socket.createSocket()\n      start = socket.createSocket()\n      movex = socket.createSocket()\n      movey = socket.createSocket()\n      end = socket.createSocket()\n      c.inPorts.element.attach element\n      c.outPorts.start.attach start\n      c.outPorts.movex.attach movex\n      c.outPorts.movey.attach movey\n      c.outPorts.end.attach end\n      done()\n\n  describe 'on matched element', ->\n    el = document.querySelector '#fixtures .listendrag .target'\n    it 'should transmit a start event on drag start', (done) ->\n      element.send el\n      start.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'dragstart', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n\n    it 'should transmit a movex event on drag move', (done) ->\n      element.send el\n      movex.once 'data', (data) ->\n        chai.expect(data).to.equal 5\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'drag', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n\n    it 'should transmit a movey event on drag move', (done) ->\n      element.send el\n      movey.once 'data', (data) ->\n        chai.expect(data).to.equal 10\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'drag', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n\n    it 'should transmit a end event on drag end', (done) ->\n      element.send el\n      end.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'dragend', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n"},"interaction/ListenEvent":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'rss'\n  c.description = 'Listen to custom events on a DOM element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'event',\n    datatype: 'string'\n  c.outPorts.add 'out',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener element.eventName, element.onEvent, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element', 'event'\n    el = input.getData 'element'\n    eventName = input.getData 'event'\n    data =\n      el: el\n      eventName: eventName\n      onEvent: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        event.eventName = eventName\n        output.send\n          out: event\n      ctx: context\n    data.el.addEventListener eventName, data.onEvent, false\n    c.elements.push data\n    return\n",tests:"noflo = require 'noflo'\nsocket = noflo.internalSocket\nbaseDir = 'noflo-interaction'\n\ndescribe 'ListenEvent component', ->\n  c = null\n  element = null\n  event = null\n  out = null\n  beforeEach (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'interaction/ListenEvent', (err, instance) ->\n      return done err if err\n      c = instance\n      element = socket.createSocket()\n      event = socket.createSocket()\n      out = socket.createSocket()\n      c.inPorts.element.attach element\n      c.inPorts.event.attach event\n      c.outPorts.out.attach out\n      done()\n\n  describe 'on matched element', ->\n    el = document.querySelector '#fixtures .listenevent .target'\n    it 'should transmit a click packet on click event', (done) ->\n      element.send el\n      event.send 'click'\n      out.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        chai.expect(data.eventName).to.equal 'click'\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'click', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n    it 'should transmit a foo packet on foo event', (done) ->\n      element.send el\n      event.send 'foo'\n      out.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        chai.expect(data.eventName).to.equal 'foo'\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'foo', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n"},"interaction/ListenHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for hash changes in browser\\'s URL bar'\n  c.icon = 'slack'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'initial',\n    datatype: 'string'\n  c.outPorts.add 'change',\n    datatype: 'string'\n  c.current = null\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'hashchange', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    c.current = null\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      sendHash = (port) ->\n        oldHash = c.current\n        c.current = window.location.href.split('#')[1] or ''\n        if oldHash\n          output.send\n            change: new noflo.IP 'openBracket', oldHash\n        payload = {}\n        payload[port] = c.current\n        output.send payload\n        if oldHash\n          output.send\n            change: new noflo.IP 'closeBracket', oldHash\n      c.subscriber =\n        callback: (event) ->\n          sendHash 'change'\n        ctx: context\n      # Send initial\n      sendHash 'initial'\n      window.addEventListener 'hashchange', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenKeyboard":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for key presses on a given DOM element'\n  c.icon = 'keyboard-o'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'stop',\n    datatype: 'object'\n  c.outPorts.add 'keypress',\n    datatype: 'integer'\n  c.elements = []\n  unsubcribe = (element) ->\n    element.el.removeEventListener 'keypress', element.listener, false\n    element.ctx.deactivate()\n  c.tearDown = (callback) ->\n    unsubscribe element for element in c.elements\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'element'\n      data =\n        el: input.getData 'element'\n        listener: (event) ->\n          output.send\n            keypress: event.keyCode\n        ctx: context\n      data.el.addEventListener 'keypress', data.listener, false\n      c.elements.push data\n      return\n    if input.hasData 'stop'\n      element = input.getData 'stop'\n      ctx = null\n      for el in c.elements\n        continue unless el.el is element\n        ctx = el\n      return unless ctx\n      unsubscribe ctx\n      output.done()\n"},"interaction/ListenKeyboardShortcuts":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for keyboard shortcuts and route them'\n  c.icon = 'keyboard-o'\n  c.inPorts.add 'keys',\n    datatype: 'array'\n  c.inPorts.add 'ignoreinput',\n    datatype: 'boolean'\n    default: true\n    control: true\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n  c.outPorts.add 'shortcut',\n    datatype: 'bang'\n    addressable: true\n  c.outPorts.add 'missed',\n    datatype: 'integer'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    document.removeEventListener 'keydown', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'keys'\n      keys = input.getData 'keys'\n\n      # Ensure previous subscription is ended\n      do unsubscribe\n\n      # Older version of this component used string input\n      keys = keys.split ',' if typeof keys is 'string'\n\n      # We allow some common keyboard shortcuts to be passed as strings\n      for key, index in keys\n        switch key\n          when '-' then keys[index] = 189\n          when '=' then keys[index] = 187\n          when '0' then keys[index] = 48\n          when 'a' then keys[index] = 65\n          when 'x' then keys[index] = 88\n          when 'c' then keys[index] = 67\n          when 'v' then keys[index] = 86\n          when 'z' then keys[index] = 90\n          when 'r' then keys[index] = 82\n\n      ignoreInput = if input.hasData('ignoreinput') then input.getData('ignoreinput') else true\n\n      c.subscriber =\n        callback: (event) ->\n          return unless event.ctrlKey or event.metaKey\n          return if event.target.tagName is 'TEXTAREA' and ignoreInput\n          return if event.target.tagName is 'INPUT' and ignoreInput\n          return if String(event.target.contentEditable) is 'true' and ignoreInput\n          route = keys.indexOf event.keyCode\n          if route is -1\n            output.send\n              missed: event.keyCode\n            return\n          event.preventDefault()\n          event.stopPropagation()\n          output.send\n            shortcut: new noflo.IP 'data', event.keyCode,\n              index: route\n        ctx: context\n      document.addEventListener 'keydown', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenMouse":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'mouse-pointer'\n  c.description = 'Listen to mouse events on a DOM element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'click',\n    datatype: 'object'\n  c.outPorts.add 'dblclick',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'click', element.click, false\n      element.el.removeEventListener 'dblclick', element.dblclick, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      click: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          click: event\n      dblclick: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          dblclick: event\n      ctx: context\n    data.el.addEventListener 'click', data.click, false\n    data.el.addEventListener 'dblclick', data.dblclick, false\n    c.elements.push data\n    return\n",tests:"noflo = require 'noflo'\nsocket = noflo.internalSocket\nbaseDir = 'noflo-interaction'\n\ndescribe 'ListenMouse component', ->\n  c = null\n  element = null\n  click = null\n  beforeEach (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'interaction/ListenMouse', (err, instance) ->\n      return done err if err\n      c = instance\n      element = socket.createSocket()\n      click = socket.createSocket()\n      c.inPorts.element.attach element\n      c.outPorts.click.attach click\n      done()\n\n  describe 'on matched element', ->\n    el = document.querySelector '#fixtures .listenmouse .target'\n    it 'should transmit a click event on mouse click', (done) ->\n      element.send el\n      click.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'click', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n    it 'should transmit a dblclick event on mouse dblclick', (done) ->\n      element.send el\n      dblclick = socket.createSocket()\n      c.outPorts.dblclick.attach dblclick\n      dblclick.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'dblclick', true, true, window, 1\n      evt.clientX = 5\n      evt.clientY = 10\n      el.dispatchEvent evt\n"},"interaction/ListenPointer":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to pointer events on a DOM element'\n  c.icon = 'pencil-square-o'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'action',\n    datatype: 'string'\n    default: 'none'\n    control: true\n  events = [\n    'down'\n    'up'\n    'cancel'\n    'move'\n    'over'\n    'out'\n    'enter'\n    'leave'\n  ]\n  for event in events\n    c.outPorts.add event,\n      datatype: 'object'\n      description: \"Sends event on pointer#{event}\"\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      if element.el.removeAttribute\n        element.el.removeAttribute 'touch-action'\n      for event in events\n        element.el.removeEventListener \"pointer#{event}\", element[\"pointer#{event}\"], false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    action = if input.hasData('action') then input.getData('action') else 'none'\n    data =\n      el: input.getData 'element'\n      ctx: context\n    data.el.setAttribute 'touch-action', action\n    events.forEach (event) ->\n      data[\"pointer#{event}\"] = (ev) ->\n        ev.preventDefault()\n        ev.stopPropagation()\n        payload = {}\n        payload[event] = ev.target.value\n        output.send payload\n      data.el.addEventListener \"pointer#{event}\", data[\"pointer#{event}\"], false\n    c.elements.push data\n    return\n"},"interaction/ListenResize":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to window resize events'\n  c.icon = 'desktop'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for screen resizes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for screen resizes'\n  c.outPorts.add 'width',\n    datatype: 'number'\n  c.outPorts.add 'height',\n    datatype: 'number'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'resize', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      c.subscriber =\n        callback: (event) ->\n          output.send\n            width: window.innerWidth\n            height: window.innerHeight\n        ctx: context\n      output.send\n        width: window.innerWidth\n        height: window.innerHeight\n      window.addEventListener 'resize', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenScroll":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to scroll events on the browser window'\n  c.icon = 'arrows-v'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'top',\n    datatype: 'number'\n  c.outPorts.add 'bottom',\n    datatype: 'number'\n  c.outPorts.add 'left',\n    datatype: 'number'\n  c.outPorts.add 'right',\n    datatype: 'number'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'scroll', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      c.subscriber =\n        callback: (event) ->\n          top = window.scrollY\n          left = window.scrollX\n          output.send\n            top: top\n            bottom: top + window.innerHeight\n            left: left\n            right: left.window.innerWidth\n        ctx: context\n      window.addEventListener 'scroll', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n",tests:"noflo = require 'noflo'\nsocket = noflo.internalSocket\nbaseDir = 'noflo-interaction'\n\ndescribe 'ListenScroll component', ->\n  c = null\n  start = null\n  top = null\n  left = null\n  origTop = window.scrollY\n  origLeft = window.scrollX\n  beforeEach (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'interaction/ListenScroll', (err, instance) ->\n      return done err if err\n      c = instance\n      start = socket.createSocket()\n      top = socket.createSocket()\n      left = socket.createSocket()\n      c.inPorts.start.attach start\n      c.outPorts.top.attach top\n      c.outPorts.left.attach left\n      done()\n\n  afterEach ->\n    window.scrollTo origLeft, origTop\n\n  describe 'when started', ->\n    it 'should send the new scroll coordinates', (done) ->\n      unless window.navigator.userAgent.indexOf('Phantom') is -1\n        # Scroll API doesn't seem to work in the PhantomJS test runner\n        return @skip()\n      if window.location.href is 'http://127.0.0.1:9999/spec/runner.html'\n        # Scroll API doesn't seem to work in the SauceLabs test runner\n        return @skip()\n\n      start.send true\n      top.once 'data', (data) ->\n        chai.expect(data).to.equal 10\n      left.once 'data', (data) ->\n        chai.expect(data).to.equal 0\n      top.once 'disconnect', ->\n        done()\n      window.scrollTo 0, 10\n"},"interaction/ListenSpeech":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for user\\'s microphone and recognize phrases'\n  c.icon = 'microphone'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'result',\n    datatype: 'string'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    do c.subscriber.recognition.stop\n    do c.subscriber.ctx.deactivate\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      unless window.webkitSpeechRecognition\n        output.done new Error 'Speech recognition support not available'\n        return\n      c.subscriber =\n        sent: []\n        callback: (event) ->\n          for result, idx in event.results\n            continue unless result.isFinal\n            if c.subscriber.sent.indexOf(idx) isnt -1\n              continue\n            output.send\n              result: result[0].transcript\n            c.subscriber.sent.push idx\n        error: (err) ->\n          output.send\n            error: err\n        ctx: context\n      c.subscriber.recognition = new window.webkitSpeechRecognition\n      c.subscriber.recognition.continuous = true\n      c.subscriber.recognition.start()\n      c.subscriber.recognition.onresult = c.subscriber.callback\n      c.subscriber.recognition.onerror = c.subscriber.error\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenTouch":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to touch events on a DOM element'\n  c.icon = 'hand-o-up'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'start',\n    datatype: 'object'\n  c.outPorts.add 'movex',\n    datatype: 'number'\n  c.outPorts.add 'movey',\n    datatype: 'number'\n  c.outPorts.add 'end',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'touchstart', element.touchstart, false\n      element.el.removeEventListener 'touchmove', element.touchmove, false\n      element.el.removeEventListener 'touchend', element.touchend, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      touchstart: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            start: new noflo.IP 'data', event,\n              touch: idx\n      touchmove: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            movex: new noflo.IP 'data', touch.pageX,\n              touch: idx\n            movey: new noflo.IP 'data', touch.pageY,\n              touch: idx\n      touchend: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            end: new noflo.IP 'data', event,\n              touch: idx\n      ctx: context\n    data.el.addEventListener 'touchstart', data.touchstart, false\n    data.el.addEventListener 'touchmove', data.touchmove, false\n    data.el.addEventListener 'touchend', data.touchend, false\n    c.elements.push data\n    return\n",tests:"noflo = require 'noflo'\nsocket = noflo.internalSocket\nbaseDir = 'noflo-interaction'\n\ndescribe 'ListenTouch component', ->\n  c = null\n  element = null\n  start = null\n  movex = null\n  movey = null\n  end = null\n  beforeEach (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'interaction/ListenTouch', (err, instance) ->\n      return done err if err\n      c = instance\n      element = socket.createSocket()\n      start = socket.createSocket()\n      movex = socket.createSocket()\n      movey = socket.createSocket()\n      end = socket.createSocket()\n      c.inPorts.element.attach element\n      c.outPorts.start.attach start\n      c.outPorts.movex.attach movex\n      c.outPorts.movey.attach movey\n      c.outPorts.end.attach end\n      done()\n\n  describe 'on matched element', ->\n    el = document.querySelector '#fixtures .listentouch .target'\n    it 'should transmit a start event on touch start', (done) ->\n      element.send el\n      start.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'touchstart', true, true, window, 1\n      evt.changedTouches = []\n      evt.changedTouches.push\n        pageX: 5\n        pageY: 10\n      el.dispatchEvent evt\n\n    it 'should transmit a movex event on touch move', (done) ->\n      element.send el\n      movex.once 'data', (data) ->\n        chai.expect(data).to.equal 5\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'touchmove', true, true, window, 1\n      evt.changedTouches = []\n      evt.changedTouches.push\n        pageX: 5\n        pageY: 10\n      el.dispatchEvent evt\n\n    it 'should transmit a movey event on touch move', (done) ->\n      element.send el\n      movey.once 'data', (data) ->\n        chai.expect(data).to.equal 10\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'touchmove', true, true, window, 1\n      evt.changedTouches = []\n      evt.changedTouches.push\n        pageX: 5\n        pageY: 10\n      el.dispatchEvent evt\n\n    it 'should transmit a end event on touch end', (done) ->\n      element.send el\n      end.once 'data', (data) ->\n        chai.expect(data).is.instanceof UIEvent\n        done()\n      evt = document.createEvent 'UIEvent'\n      evt.initUIEvent 'touchend', true, true, window, 1\n      evt.changedTouches = []\n      evt.changedTouches.push\n        pageX: 5\n        pageY: 10\n      el.dispatchEvent evt\n"},"interaction/ReadCoordinates":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read the coordinates from a DOM event'\n  c.icon = 'map-marker'\n  c.inPorts.add 'event',\n    datatype: 'object'\n  c.outPorts.add 'screen',\n    datatype: 'object'\n  c.outPorts.add 'client',\n    datatype: 'object'\n  c.outPorts.add 'page',\n    datatype: 'object'\n  c.forwardBrackets =\n    event: ['screen', 'client', 'page']\n  c.process (input, output) ->\n    return unless input.hasData 'event'\n    event = input.getData 'event'\n    output.sendDone\n      screen:\n        x: event.screenX\n        y: event.screenY\n      client:\n        x: event.clientX\n        y: event.clientY\n      page:\n        x: event.pageX\n        y: event.pageY\n",tests:"noflo = require 'noflo'\nsocket = noflo.internalSocket\nbaseDir = 'noflo-interaction'\n\ndescribe 'ReadCoordinates component', ->\n  c = null\n  event = null\n  screen = null\n  client = null\n  page = null\n\n  beforeEach (done) ->\n    @timeout 4000\n    loader = new noflo.ComponentLoader baseDir\n    loader.load 'interaction/ReadCoordinates', (err, instance) ->\n      return done err if err\n      c = instance\n      event = socket.createSocket()\n      screen = socket.createSocket()\n      client = socket.createSocket()\n      page = socket.createSocket()\n      c.inPorts.event.attach event\n      c.outPorts.screen.attach screen\n      c.outPorts.client.attach client\n      c.outPorts.page.attach page\n      done()\n  describe 'when receiving an event',\n    it 'should send coordinates out', (done) ->\n      expected = [\n        ['screen', 42, 31]\n        ['client', 12, 15]\n        ['page', 56, 1]\n      ]\n      screen.on 'data', (data) ->\n        exp = expected.shift()\n        chai.expect(exp[0]).to.equal 'screen'\n        chai.expect(data.x).to.equal exp[1]\n        chai.expect(data.y).to.equal exp[2]\n        return done() unless expected.length\n      client.on 'data', (data) ->\n        exp = expected.shift()\n        chai.expect(exp[0]).to.equal 'client'\n        chai.expect(data.x).to.equal exp[1]\n        chai.expect(data.y).to.equal exp[2]\n        return done() unless expected.length\n      page.on 'data', (data) ->\n        exp = expected.shift()\n        chai.expect(exp[0]).to.equal 'page'\n        chai.expect(data.x).to.equal exp[1]\n        chai.expect(data.y).to.equal exp[2]\n        return done() unless expected.length\n      event.send\n        screenX: expected[0][1]\n        screenY: expected[0][2]\n        clientX: expected[1][1]\n        clientY: expected[1][2]\n        pageX: expected[2][1]\n        pageY: expected[2][2]\n"},"interaction/ReadGamepad":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read the state of a gamepad'\n  c.icon = 'gamepad'\n  c.inPorts.add 'gamepad',\n    datatype: 'integer'\n  c.outPorts.add 'out',\n    datatype: 'object'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.lastTimestamps = {}\n  c.tearDown = (callback) ->\n    c.lastTimestamps = {}\n    do callback\n  c.process (input, output) ->\n    return unless input.hasData 'gamepad'\n    gamepad = input.getData 'gamepad'\n    unless navigator.webkitGetGamepads\n      output.done new Error \"No WebKit Gamepad API available\"\n      return\n    gamepadState = navigator.webkitGetGamepads()[gamepad]\n    unless gamepadState\n      output.done new Error \"Gamepad '#{gamepad}' not available\"\n    if c.lastTimestamps[gamepad] = gamepadState.timestamp\n      # No change\n      output.done()\n      return\n    c.lastTimestamps[gamepad] = gamepadState.timestamp\n    output.sendDone\n      out: gamepadState\n"},"interaction/SetHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Set the hash in browser\\'s URL bar'\n  c.icon = 'slack'\n  c.inPorts.add 'hash',\n    datatype: 'string'\n  c.outPorts.add 'out',\n    datatype: 'string'\n  c.process (input, output) ->\n    return unless input.hasData 'hash'\n    hash = input.getData 'hash'\n    window.location.hash = \"##{hash}\"\n    output.sendDone\n      out: hash\n"}};e.setSource=function(t,e,n,i,a,s){r.setSource(o,t,e,n,i,a,s)},e.getSource=function(t,e,n){r.getSource(o,t,e,n)},e.getLanguages=r.getLanguages,e.register=function(t,e){t.setLibraryIcon("dom","html5"),t.registerComponent("browser-app","DoSomething",n(48)),t.registerComponent("browser-app","main",n(36)),t.registerComponent(null,"Graph",n(49)),t.registerComponent("core","Callback",n(50)),t.registerComponent("core","Copy",n(51)),t.registerComponent("core","DisconnectAfterPacket",n(53)),t.registerComponent("core","Drop",n(54)),t.registerComponent("core","Kick",n(55)),t.registerComponent("core","MakeFunction",n(56)),t.registerComponent("core","Merge",n(57)),t.registerComponent("core","Output",n(58)),t.registerComponent("core","ReadGlobal",n(61)),t.registerComponent("core","Repeat",n(62)),t.registerComponent("core","RepeatAsync",n(63)),t.registerComponent("core","RepeatDelayed",n(64)),t.registerComponent("core","RunInterval",n(65)),t.registerComponent("core","RunTimeout",n(66)),t.registerComponent("core","SendNext",n(67)),t.registerComponent("core","Split",n(68)),t.registerComponent("dom","AddClass",n(69)),t.registerComponent("dom","AppendChild",n(70)),t.registerComponent("dom","CreateElement",n(71)),t.registerComponent("dom","CreateFragment",n(72)),t.registerComponent("dom","GetAttribute",n(73)),t.registerComponent("dom","GetElement",n(74)),t.registerComponent("dom","HasClass",n(75)),t.registerComponent("dom","Listen",n(76)),t.registerComponent("dom","ReadHtml",n(77)),t.registerComponent("dom","RemoveClass",n(78)),t.registerComponent("dom","RemoveElement",n(79)),t.registerComponent("dom","RequestAnimationFrame",n(80)),t.registerComponent("dom","SetAttribute",n(81)),t.registerComponent("dom","WriteHtml",n(82)),t.registerComponent("interaction","Focus",n(83)),t.registerComponent("interaction","ListenChange",n(84)),t.registerComponent("interaction","ListenDrag",n(85)),t.registerComponent("interaction","ListenEvent",n(86)),t.registerComponent("interaction","ListenHash",n(87)),t.registerComponent("interaction","ListenKeyboard",n(88)),t.registerComponent("interaction","ListenKeyboardShortcuts",n(89)),t.registerComponent("interaction","ListenMouse",n(90)),t.registerComponent("interaction","ListenPointer",n(91)),t.registerComponent("interaction","ListenResize",n(92)),t.registerComponent("interaction","ListenScroll",n(93)),t.registerComponent("interaction","ListenSpeech",n(94)),t.registerComponent("interaction","ListenTouch",n(95)),t.registerComponent("interaction","ReadCoordinates",n(96)),t.registerComponent("interaction","ReadGamepad",n(97)),t.registerComponent("interaction","SetHash",n(98));r.registerCustomLoaders(t,[],e)}},function(module,exports){exports.registerCustomLoaders=function(t,e,n){if(!e.length)return n();var r=e.shift();t.registerLoader(r,(function(r){if(r)return n(r);exports.registerCustomLoaders(t,e,n)}))},exports.setSource=function(sources,loader,packageId,name,source,language,callback){var implementation,originalSource=source;if("coffeescript"===language){if("undefined"!=typeof window&&!window.CoffeeScript)return callback(new Error("CoffeeScript compiler needed for "+packageId+"/"+name+" not available"));try{source=window.CoffeeScript.compile(source,{bare:!0})}catch(t){return callback(t)}}if(("es6"===language||"es2015"===language)&&"undefined"!=typeof window&&window.babel)try{source=window.babel.transform(source).code}catch(t){return callback(t)}try{var withExports="(function () { var exports = {}; "+source+"; return exports; })();";implementation=eval(withExports)}catch(t){return callback(t)}if("function"!=typeof implementation&&(!implementation.getComponent||"function"!=typeof implementation.getComponent))return callback(new Error("Provided source for "+packageId+"/"+name+" failed to create a runnable component"));var fullName=packageId+"/"+name;sources[fullName]={language:language,source:originalSource},loader.registerComponent(packageId,name,implementation,callback)},exports.getSource=function(t,e,n,r){if(!e.components[n])return r(new Error("Component "+n+" not available"));var o=e.components[n];if(-1!==n.indexOf("/"))var i=n.split("/"),a={name:i[1],library:i[0]};else a={name:n,library:""};return e.isGraph(o)?(a.code=JSON.stringify(o,null,2),a.language="json",r(null,a)):t[n]?(a.code=t[n].source,a.language=t[n].language,a.tests=t[n].tests,r(null,a)):"function"==typeof o?(a.code=o.toString(),a.language="javascript",r(null,a)):"function"==typeof o.getComponent?(a.code=o.getComponent.toString(),a.language="javascript",r(null,a)):r(new Error("Unable to get sources for "+n))},exports.getLanguages=function(){var t=["javascript","es2015"];return"undefined"!=typeof window&&window.CoffeeScript&&t.push("coffeescript"),t}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.icon="cog",t.description="do X",t.inPorts.add("in",{datatype:"string"}),t.outPorts.add("out",{datatype:"string"}),t.process((t,e)=>{if(!t.hasData("in"))return;const n=t.getData("in");e.send({out:n}),e.done()}),t}},function(t,e,n){"use strict";(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=c(t);if(e){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=n(0),l=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(p,e);var n,s,c,l=a(p);function p(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(e=l.call(this)).metadata=t,e.network=null,e.ready=!0,e.started=!1,e.starting=!1,e.baseDir=null,e.loader=null,e.load=0,e.inPorts=new u.InPorts({graph:{datatype:"all",description:"NoFlo graph definition to be used with the subgraph component",required:!0}}),e.outPorts=new u.OutPorts,e.inPorts.graph.on("ip",(function(t){"data"===t.type&&e.setGraph(t.data,(function(t){t&&e.error(t)}))})),e}return n=p,(s=[{key:"setGraph",value:function(e,n){var o=this;if(this.ready=!1,"object"===r(e))return"function"==typeof e.addNode?void this.createNetwork(e,n):void u.graph.loadJSON(e,(function(t,e){var r=e;t?n(t):(r.baseDir=o.baseDir,o.createNetwork(r,n))}));var i=e;"/"!==i.substr(0,1)&&":"!==i.substr(1,1)&&t&&t.cwd&&(i="".concat(t.cwd(),"/").concat(i)),u.graph.loadFile(i,(function(t,e){var r=e;t?n(t):(r.baseDir=o.baseDir,o.createNetwork(r,n))}))}},{key:"createNetwork",value:function(t,e){var n=this;this.description=t.properties.description||"",this.icon=t.properties.icon||this.icon;var r=t;r.name||(r.name=this.nodeId),r.componentLoader=this.loader,u.createNetwork(r,{delay:!0,subscribeGraph:!1},(function(t,r){n.network=r,t?e(t):(n.emit("network",n.network),n.subscribeNetwork(n.network),n.network.connect((function(t){t?e(t):(Object.keys(n.network.processes).forEach((function(t){var e=n.network.processes[t];n.findEdgePorts(t,e)})),n.setToReady(),e())})))}))}},{key:"subscribeNetwork",value:function(){var t=this,e=[];return this.network.on("start",(function(){var n={};return e.push(n),t.activate(n)})),this.network.on("end",(function(){var n=e.pop();n&&t.deactivate(n)}))}},{key:"isExportedInport",value:function(t,e,n){for(var r=Object.keys(this.network.graph.inports),o=0;o<r.length;o+=1){var i=r[o],a=this.network.graph.inports[i];if(a.process===e&&a.port===n)return i}return!1}},{key:"isExportedOutport",value:function(t,e,n){for(var r=Object.keys(this.network.graph.outports),o=0;o<r.length;o+=1){var i=r[o],a=this.network.graph.outports[i];if(a.process===e&&a.port===n)return i}return!1}},{key:"setToReady",value:function(){var e=this;void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick((function(){return e.ready=!0,e.emit("ready")})):setTimeout((function(){return e.ready=!0,e.emit("ready")}),0)}},{key:"findEdgePorts",value:function(t,e){var n=this,r=e.component.inPorts.ports,o=e.component.outPorts.ports;return Object.keys(r).forEach((function(e){var o=r[e],i=n.isExportedInport(o,t,e);!1!==i&&(n.inPorts.add(i,o),n.inPorts[i].on("connect",(function(){n.starting||n.network.isStarted()||(n.network.startupDate?n.network.setStarted(!0):n.setUp((function(){})))})))})),Object.keys(o).forEach((function(e){var r=o[e],i=n.isExportedOutport(r,t,e);!1!==i&&n.outPorts.add(i,r)})),!0}},{key:"isReady",value:function(){return this.ready}},{key:"isSubgraph",value:function(){return!0}},{key:"isLegacy",value:function(){return!1}},{key:"setUp",value:function(t){var e=this;this.starting=!0,this.isReady()?this.network?this.network.start((function(n){n?t(n):(e.starting=!1,t())})):t(null):this.once("ready",(function(){e.setUp(t)}))}},{key:"tearDown",value:function(t){this.starting=!1,this.network?this.network.stop((function(e){e?t(e):t()})):t(null)}}])&&o(n.prototype,s),c&&o(n,c),p}(u.Component);e.getComponent=function(t){return new l(t)}}).call(this,n(1))},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="This component calls a given callback function for each\nIP it receives.  The Callback component is typically used to connect\nNoFlo with external Node.js code.",t.icon="sign-out",t.inPorts.add("in",{description:"Object passed as argument of the callback",datatype:"all"}),t.inPorts.add("callback",{description:"Callback to invoke",datatype:"function",control:!0,required:!0}),t.outPorts.add("error",{datatype:"object"}),t.process((t,e)=>{if(!t.hasData("callback","in"))return;const[n,r]=t.getData("callback","in");if("function"==typeof n){try{n(r)}catch(t){return void e.done(t)}e.done()}else e.done(new Error("The provided callback must be a function"))})}},function(t,e,n){const r=n(0),o=n(52);e.getComponent=()=>{const t=new r.Component;return t.description="deep (i.e. recursively) copy an object",t.icon="copy",t.inPorts.add("in",{datatype:"all",description:"Packet to be copied"}),t.outPorts.add("out",{datatype:"all",description:"Copy of the original packet"}),t.process((t,e)=>{if(!t.hasData("in"))return;const n=t.getData("in"),r=o.deepCopy(n);e.sendDone({out:r})})}},function(t,e,n){function r(){}function o(t){return"object"==typeof t?(r.prototype=t,new r):t}var i=[];function a(t){for(var e in t)this[e]=t[e]}function s(){this.copiedObjects=[];var t=this;this.recursiveDeepCopy=function(e){return t.deepCopy(e)},this.depth=0}function c(t,e){var n=new s;return e&&(n.maxDepth=e),n.deepCopy(t)}a.prototype={constructor:a,canCopy:function(t){return!1},create:function(t){},populate:function(t,e,n){}},s.prototype={constructor:s,maxDepth:256,cacheResult:function(t,e){this.copiedObjects.push([t,e])},getCachedResult:function(t){for(var e=this.copiedObjects,n=e.length,r=0;r<n;r++)if(e[r][0]===t)return e[r][1]},deepCopy:function(t){if(null===t)return null;if("object"!=typeof t)return t;var e=this.getCachedResult(t);if(e)return e;for(var n=0;n<i.length;n++){var r=i[n];if(r.canCopy(t))return this.applyDeepCopier(r,t)}throw new Error("no DeepCopier is able to copy "+t)},applyDeepCopier:function(t,e){var n=t.create(e);if(this.cacheResult(e,n),this.depth++,this.depth>this.maxDepth)throw new Error("Exceeded max recursion depth in deep copy.");return t.populate(this.recursiveDeepCopy,e,n),this.depth--,n}},c.DeepCopier=a,c.deepCopiers=i,c.register=function(t){t instanceof a||(t=new a(t)),i.unshift(t)},c.register({canCopy:function(t){return!0},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}}),c.register({canCopy:function(t){return t instanceof Array},create:function(t){return new t.constructor},populate:function(t,e,n){for(var r=0;r<e.length;r++)n.push(t(e[r]));return n}}),c.register({canCopy:function(t){return t instanceof Date},create:function(t){return new Date(t)}});var u=n(2).EventEmitter;c.register({canCopy:function(t){return t instanceof u},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&!e.hasOwnProperty(r)||(n[r]=t(e[r]));return n}}),c.register({canCopy:function(t){return!1},create:function(t){return t===document?document:t.cloneNode(!1)},populate:function(t,e,n){if(e===document)return document;if(e.childNodes&&e.childNodes.length)for(var r=0;r<e.childNodes.length;r++){var o=t(e.childNodes[r]);n.appendChild(o)}}}),e.DeepCopyAlgorithm=s,e.copy=function(t){if("object"!=typeof t)return t;var e=t.valueOf();if(t!=e)return new t.constructor(e);if(t instanceof t.constructor&&t.constructor!==Object){var n=o(t.constructor.prototype);for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}else{n={};for(var r in t)n[r]=t[r]}return n},e.clone=o,e.deepCopy=c},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;t.description="Makes each data packet a stream of its own",t.icon="pause",t.forwardBrackets={},t.autoOrdering=!1,t.inPorts.add("in",{datatype:"all",description:"Packet to be forward with disconnection"}),t.outPorts.add("out",{datatype:"all"});let e={};return t.tearDown=t=>{e={},t()},t.process((n,o)=>{t.autoOrdering=!1;const i=n.get("in");if(e[n.scope]||(e[n.scope]=[]),"openBracket"===i.type)return e[n.scope].push(i.data),void o.done();if("closeBracket"===i.type)return e[n.scope].pop(),void o.done();if("data"!==i.type)return;e[n.scope].forEach(t=>{o.sendIP("out",new r.IP("openBracket",t))}),o.sendIP("out",i);e[n.scope].slice(0).reverse(),e[n.scope].forEach(t=>{o.sendIP("out",new r.IP("closeBracket",t))}),o.done()})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="This component drops every packet it receives with no action",t.icon="trash-o",t.inPorts.add("in",{datatypes:"all",description:"Packet to be dropped"}),t.process((t,e)=>{t.get("in").drop(),e.done()})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="This component generates a single packet and sends it to\nthe output port. Mostly usable for debugging, but can also be useful\nfor starting up networks.",t.icon="share",t.inPorts.add("in",{datatype:"bang",description:"Signal to send the data packet"}),t.inPorts.add("data",{datatype:"all",description:"Packet to be sent",control:!0,default:null}),t.outPorts.add("out",{datatype:"all"}),t.process((t,e)=>{if(!t.hasStream("in"))return;if(t.attached("data").length&&!t.hasData("data"))return;t.getData("in");const n=t.getData("data");e.send({out:n}),e.done()})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;t.description='Evaluates a function each time data hits the "in" port \nand sends the return value to "out". Within the function "x" will \nbe the variable from the in port. For example, to make a ^2 function \ninput "return x*x;" to the function port.',t.icon="code",t.inPorts.add("in",{datatype:"all",description:"Packet to be processed"}),t.inPorts.add("function",{datatype:"string",description:"Function to evaluate",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("function",{datatype:"function"}),t.outPorts.add("error",{datatype:"object"});const e=(t,e)=>{let n;if("function"!=typeof t){try{n=Function("x",t)}catch(t){return void e(t)}e(null,n)}else e(null,t)};return t.process((t,n)=>{t.attached("in").length&&!t.hasData("in")||(t.hasData("function","in")?e(t.getData("function"),(e,r)=>{let o;if(e)return void n.done(e);const i=t.getData("in");try{o=r(i)}catch(t){return void n.done(t)}n.sendDone({function:r,out:o})}):t.hasData("function")&&e(t.getData("function"),(t,e)=>{t?n.done(t):n.sendDone({function:e})}))})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="This component receives data on multiple input ports and \nsends the same data out to the connected output port",t.icon="compress",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process((t,e)=>{const n=t.get("in");return e.sendDone({out:n})})}},function(t,e,n){const r=n(0),{inspect:o}=n(9);e.getComponent=()=>{const t=new r.Component;return t.description="Sends the data items to console.log",t.icon="bug",t.inPorts.add("in",{datatype:"all",description:"Packet to be printed through console.log"}),t.inPorts.add("options",{datatype:"object",description:"Options to be passed to console.log",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.process((t,e)=>{if(!t.hasData("in"))return;if(t.attached("options").length&&!t.hasData("options"))return;let n=null;t.has("options")&&(n=t.getData("options"));const r=t.getData("in");((t,e)=>{null!=t?console.log(o(e,t.showHidden,t.depth,t.colors)):console.log(e)})(n,r),e.sendDone({out:r})})}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(t){const r=n(0);e.getComponent=()=>{const e=new r.Component;return e.description="Returns the value of a global variable.",e.icon="usd",e.inPorts.add("name",{description:"The name of the global variable.",datatype:"string"}),e.outPorts.add("value",{description:"The value of the variable."}),e.outPorts.add("error",{description:"Any errors that occured reading the variables value.",datatype:"object"}),e.forwardBrackets={name:["value","error"]},e.process((e,n)=>{if(!e.hasData("name"))return;const o=e.getData("name"),i=r.isBrowser()?window[o]:t[o];if(void 0!==i)n.sendDone({value:i});else{const t=new Error(`"${o}" is undefined on the global object.`);n.sendDone(t)}})}}).call(this,n(8))},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="Forwards packets and metadata in the same way \nit receives them",t.icon="forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process((t,e)=>{const n=t.get("in");e.sendDone({out:n})})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="Like 'Repeat', except repeat on next tick",t.icon="step-forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process((t,e)=>{const n=t.get("in");setTimeout(()=>e.sendDone({out:n}),0)})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="Forward packet after a set delay",t.icon="clock-o",t.timers=[],t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded with a delay"}),t.inPorts.add("delay",{datatype:"number",description:"How much to delay",default:500,control:!0}),t.outPorts.add("out",{datatype:"all"}),t.tearDown=e=>(t.timers.forEach(t=>clearTimeout(t)),t.timers=[],e()),t.process((e,n)=>{if(!e.hasData("in"))return;if(e.attached("delay").length&&!e.hasData("delay"))return;let r=500;e.hasData("delay")&&(r=e.getData("delay"));const o=e.get("in"),i=setTimeout(()=>(t.timers.splice(t.timers.indexOf(i),1),n.sendDone({out:o})),r);t.timers.push(i)})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;t.description="Send a packet at the given interval",t.icon="clock-o",t.inPorts.add("interval",{datatype:"number",description:"Interval at which output packets are emitted (ms)",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the emission"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop the emission"}),t.outPorts.add("out",{datatype:"bang"}),t.timers={};const e=e=>{t.timers[e]&&(clearInterval(t.timers[e].interval),t.timers[e].deactivate(),t.timers[e]=null)};return t.tearDown=n=>{Object.keys(t.timers).forEach(e),t.timers={},n()},t.forwardBrackets={},t.process((n,o,i)=>{if(n.hasData("start")){if(!n.hasData("interval"))return;const o=n.get("start");if("data"!==o.type)return;const a=parseInt(n.getData("interval"),10);e(o.scope);return i.interval=setInterval(()=>{const e=new r.IP("data",!0);return e.scope=o.scope,t.outPorts.out.sendIP(e)},a),void(t.timers[o.scope]=i)}if(n.hasData("stop")){const t=n.get("stop");if("data"!==t.type)return;e(t.scope),o.done()}})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="Send a packet after the given time in ms",t.icon="clock-o",t.timer={},t.inPorts.add("time",{datatype:"number",description:"Time after which a packet will be sent",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the timeout before sending a packet"}),t.outPorts.add("out",{datatype:"bang"}),t.forwardBrackets={start:["out"]},t.stopTimer=e=>{t.timer[e]&&(clearTimeout(t.timer[e].timeout),t.timer[e].deactivate(),delete t.timer[e])},t.tearDown=e=>{Object.keys(t.timer).forEach(e=>t.stopTimer(e)),e()},t.process((e,n,r)=>{if(!e.hasData("time","start"))return;const o=parseInt(e.getData("time"),10);e.getData("start"),t.stopTimer(e.scope);r.timeout=setTimeout(()=>{t.timer=null,n.sendDone({out:!0})},o),t.timer[e.scope]=r})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.description="Sends next packet in buffer when receiving a bang",t.icon="forward",t.inPorts.add("data",{datatype:"all"}),t.inPorts.add("in",{datatype:"bang"}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("empty",{datatype:"bang",required:!1}),t.forwardBrackets={},t.process((e,n)=>{if(!e.hasData("in"))return;const r=e.getData("in");if(!e.hasData("data"))return void n.sendDone({empty:!0});let o=!1;for(;e.has("data");){if(o){if("data"===t.inPorts.data.getBuffer(r.scope)[0].type)break}const i=e.get("data");n.send({out:i}),"data"===i.type&&(o=!0)}n.done()})}},function(t,e,n){const r=n(0);e.getComponent=()=>{const t=new r.Component;return t.icon="expand",t.description="This component receives data on a single input port and \nsends the same data out to all connected output ports",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process((t,e)=>{const n=t.get("in");e.sendDone({out:n})})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Add a class to an element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.process((function(t,e){var n,o;if(t.has("element","class")){var i=r(t.getData("element","class"),2);return o=i[0],n=i[1],o.classList.add(n),e.done()}}))}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Append elements as children of a parent element",t.inPorts.add("parent",{datatype:"object"}),t.inPorts.add("child",{datatype:"object"}),t.process((function(t,e){var n,o;if(t.hasData("parent","child")){var i=r(t.getData("parent","child"),2);return o=i[0],n=i[1],o.appendChild(n),e.done()}}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Create a new DOM Element",t.inPorts.add("tagname",{datatype:"string"}),t.inPorts.add("container",{datatype:"object"}),t.outPorts.add("element",{datatype:"object"}),t.forwardBrackets={tagname:["element"]},t.process((function(e,n){var r,o;if(e.hasData("tagname")&&(!t.inPorts.container.isAttached()||e.hasData("container")))return o=e.getData("tagname"),r=document.createElement(o),e.hasData("container")&&e.getData("container").appendChild(r),n.sendDone({element:r})}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Create a new DOM DocumentFragment",t.inPorts.add("in",{datatype:"bang"}),t.outPorts.add("fragment",{datatype:"object"}),t.forwardBrackets={in:["fragment"]},t.process((function(t,e){var n;if(t.hasData("in"))return t.getData("in"),n=document.createDocumentFragment(),e.sendDone({fragment:n})}))}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Reads the given attribute from the DOM element on the in port.",t.inPorts.add("element",{datatype:"object",description:"The element from which to read the attribute from.",required:!0}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is read from the DOM element.",required:!0,control:!0}),t.outPorts.add("out",{datatype:"string",description:"Value of the attribute being read."}),t.forwardBrackets={element:["out"]},t.process((function(t,e){var n,o,i;if(t.hasData("element","attribute")){var a=r(t.getData("element","attribute"),2);return o=a[0],n=a[1],i=o.getAttribute(n),e.sendDone({out:i})}}))}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Get a DOM element matching a query",t.inPorts.add("in",{datatype:"object",description:"DOM element to constrain the query to"}),t.inPorts.add("selector",{datatype:"string",description:"CSS selector"}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("error",{datatype:"object"}),t.forwardBrackets={selector:["element","error"]},t.process((function(t,e){var n,o,i,a,s,c,u,l;if(t.hasData("selector")&&(!(t.attached("in").length>0)||t.hasData("in")))if(t.hasData("in")){var p=r(t.getData("in","selector"),2);if(n=p[0],l=p[1],"function"!=typeof n.querySelector)return void e.done(new Error("Given container doesn't support querySelectors"));if(!(o=n.querySelectorAll(l)).length)return void e.done(new Error("No element matching '".concat(l,"' found under container")));for(a=0,c=o.length;a<c;a++)i=o[a],e.send({element:i});e.done()}else{if(l=t.getData("selector"),(o=document.querySelectorAll(l)).length){for(s=0,u=o.length;s<u;s++)i=o[s],e.send({element:i});return e.done()}e.done(new Error("No element matching '".concat(l,"' found under document")))}}))}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Check if an element has a given class",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("missed",{datatype:"object"}),t.process((function(t,e){var n,o;if(t.hasData("element","class")){var i=r(t.getData("element","class"),2);if(n=i[0],o=i[1],!n.classList.contains(o))return e.sendDone({missed:n});e.sendDone({element:n})}}))}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t,e;return(t=new i.Component).description="addEventListener for specified event type",t.icon="stethoscope",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("type",{datatype:"string"}),t.inPorts.add("preventdefault",{datatype:"boolean",control:!0,default:!1}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("event",{datatype:"object"}),t.elements={},e=function(e){var n,r,o;if(t.elements[e]){var i=t.elements[e];return n=i.element,r=i.event,o=i.listener,n.removeEventListener(r,o),t.elements[e].deactivate(),delete t.elements[e]}},t.tearDown=function(n){var r,o;for(o in r=t.elements)r[o],e(o);return t.elements={},n()},t.forwardBrackets={},t.process((function(n,o,i){var a,s,c;if(n.hasData("element","type")){var u=r(n.getData("element","type"),2);return a=u[0],c=u[1],s=!1,n.hasData("preventdefault")&&(s=n.getData("preventdefault")),null,e(null),i.element=a,i.event=c,i.listener=function(t){return s&&t.preventDefault(),o.send({element:i.element,event:t})},t.elements[i]=i,a.addEventListener(c,i.listener)}}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Read HTML from an existing element",t.inPorts.add("container",{datatype:"object"}),t.outPorts.add("html",{datatype:"string"}),t.forwardBrackets={container:["html"]},t.process((function(t,e){var n;if(t.hasData("container"))return n=t.getData("container"),e.sendDone({html:n.innerHTML})}))}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Remove a class from an element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.process((function(t,e){var n,o;if(t.has("element","class")){var i=r(t.getData("element","class"),2);return o=i[0],n=i[1],o.classList.remove(n),e.done()}}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Remove an element from DOM",t.inPorts.add("element",{datatype:"object"}),t.process((function(t,e){var n;if(t.hasData("element")&&(n=t.getData("element")).parentNode)return n.parentNode.removeChild(n),e.done()}))}},function(t,e,n){"use strict";var r,o;r=n(0),o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout((function(){return t(+new Date)}),1e3/60)},e.getComponent=function(){var t,e;return(t=new r.Component).description="Sends bangs that correspond with screen refresh rate.",t.icon="film",t.inPorts.add("start",{datatype:"bang"}),t.inPorts.add("stop",{datatype:"bang"}),t.outPorts.add("out",{datatype:"bang"}),t.running={},e=function(e){if(t.running[e])return t.running[e].deactivate(),delete t.running[e]},t.tearDown=function(n){var r,o;for(o in r=t.running)r[o],e(o);return t.running={},n()},t.animate=function(e,n){if(t.running[e])return n.send(!0),o(t.animate.bind(t,e,n))},t.forwardBrackets={},t.process((function(n,r,i){var a,s;if(n.hasData("start")){if("data"!==(a=n.get("start")).type)return;return e(a.scope),t.running[a.scope]=i,void o(t.animate.bind(t,a.scope,r))}if(n.hasData("stop")){if("data"!==(s=n.get("stop")).type)return;e(s.scope)}}))}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var a;a=n(0),e.getComponent=function(){var t;return(t=new a.Component).description="Set the given attribute on the DOM element to the received value.",t.inPorts.add("element",{datatype:"object",description:"The element on which to set the attribute."}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is set on the DOM element."}),t.inPorts.add("value",{datatype:"string",description:"Value of the attribute being set."}),t.outPorts.add("element",{datatype:"object",description:"The element that was updated."}),t.forwardBrackets={element:["element"],value:["element"]},t.process((function(t,e){var n,i,a,s,c,u;if(t.hasData("element","attribute","value")){var l=o(t.getData("element","attribute","value"),3);if(i=l[0],n=l[1],"object"===r(u=l[2]))if("[object Array]"===toString.call(u))u=u.join(" ");else{for(a in s=[],u)c=u[a],s.push(c);u=s.join(" ")}return"value"===n?i.value=u:i.setAttribute(n,u),e.sendDone({element:i})}}))}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Write HTML inside an existing element",t.inPorts.add("container",{datatype:"object"}),t.inPorts.add("html",{datatype:"string"}),t.outPorts.add("container",{datatype:"object"}),t.process((function(t,e){var n,o;if(t.hasData("container","html")){var i=r(t.getData("container","html"),2);return n=i[0],o=i[1],n.innerHTML=o,e.sendDone({container:n})}}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="i-cursor",t.description="focus element",t.inPorts.add("element",{datatype:"object",description:"element to be focused",control:!0}),t.inPorts.add("trigger",{datatype:"bang",description:"trigger focus"}),t.outPorts.add("out",{datatype:"bang"}),t.process((function(t,e){var n;if(t.hasData("element","trigger"))return n=t.getData("element"),t.getData("trigger"),window.setTimeout((function(){return n.focus(),e.sendDone({out:!0})}),0)}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen to changes on an input element",t.icon="hourglass",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("value",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("change",n.listener,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process((function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),listener:function(t){return t.preventDefault(),t.stopPropagation(),n.send({value:t.target.value})},ctx:r}).el.addEventListener("change",o.listener,!1),t.elements.push(o))}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen to drag events on a DOM element",t.icon="arrows",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("start",{datatype:"object"}),t.outPorts.add("movey",{datatype:"number"}),t.outPorts.add("movex",{datatype:"number"}),t.outPorts.add("end",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("dragstart",n.dragstart,!1),n.el.removeEventListener("drag",n.dragmove,!1),n.el.removeEventListener("dragend",n.dragend,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process((function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),dragstart:function(t){return t.stopPropagation(),n.send({start:t})},dragmove:function(t){return t.preventDefault(),t.stopPropagation(),n.send({movex:t.clientX,movey:t.clientY})},dragend:function(t){return t.preventDefault(),t.stopPropagation(),n.send({end:t})},ctx:r}).el.addEventListener("dragstart",o.dragstart,!1),o.el.addEventListener("drag",o.dragmove,!1),o.el.addEventListener("dragend",o.dragend,!1),t.elements.push(o))}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="rss",t.description="Listen to custom events on a DOM element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("event",{datatype:"string"}),t.outPorts.add("out",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener(n.eventName,n.onEvent,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process((function(e,n,r){var o,i;e.hasData("element","event")&&((o={el:e.getData("element"),eventName:i=e.getData("event"),onEvent:function(t){return t.preventDefault(),t.stopPropagation(),t.eventName=i,n.send({out:t})},ctx:r}).el.addEventListener(i,o.onEvent,!1),t.elements.push(o))}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen for hash changes in browser's URL bar",t.icon="slack",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("initial",{datatype:"string"}),t.outPorts.add("change",{datatype:"string"}),t.current=null,t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("hashchange",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(n){return t.current=null,e(),n()},t.forwardBrackets={},t.process((function(n,o,i){var a;if(n.hasData("start"))return n.getData("start"),e(),a=function(e){var n,i;if(n=t.current,t.current=window.location.href.split("#")[1]||"",n&&o.send({change:new r.IP("openBracket",n)}),(i={})[e]=t.current,o.send(i),n)return o.send({change:new r.IP("closeBracket",n)})},t.subscriber={callback:function(t){return a("change")},ctx:i},a("initial"),void window.addEventListener("hashchange",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),o.done())}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen for key presses on a given DOM element",t.icon="keyboard-o",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("stop",{datatype:"object"}),t.outPorts.add("keypress",{datatype:"integer"}),t.elements=[],function(t){return t.el.removeEventListener("keypress",t.listener,!1),t.ctx.deactivate()},t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)n=i[r],unsubscribe(n);return t.elements=[],e()},t.forwardBrackets={},t.process((function(e,n,r){var o,i,a,s,c,u,l;if(e.hasData("element"))return(i={el:e.getData("element"),listener:function(t){return n.send({keypress:t.keyCode})},ctx:r}).el.addEventListener("keypress",i.listener,!1),void t.elements.push(i);if(e.hasData("stop")){for(s=e.getData("stop"),o=null,c=0,u=(l=t.elements).length;c<u;c++)(a=l[c]).el===s&&(o=a);if(!o)return;return unsubscribe(o),n.done()}}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen for keyboard shortcuts and route them",t.icon="keyboard-o",t.inPorts.add("keys",{datatype:"array"}),t.inPorts.add("ignoreinput",{datatype:"boolean",default:!0,control:!0}),t.inPorts.add("stop",{datatype:"bang"}),t.outPorts.add("shortcut",{datatype:"bang",addressable:!0}),t.outPorts.add("missed",{datatype:"integer"}),t.subscriber=null,e=function(){if(t.subscriber)return document.removeEventListener("keydown",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process((function(n,o,i){var a,s,c,u,l;if(n.hasData("keys")){for(u=n.getData("keys"),e(),"string"==typeof u&&(u=u.split(",")),c=a=0,l=u.length;a<l;c=++a)switch(u[c]){case"-":u[c]=189;break;case"=":u[c]=187;break;case"0":u[c]=48;break;case"a":u[c]=65;break;case"x":u[c]=88;break;case"c":u[c]=67;break;case"v":u[c]=86;break;case"z":u[c]=90;break;case"r":u[c]=82}return s=!n.hasData("ignoreinput")||n.getData("ignoreinput"),t.subscriber={callback:function(t){var e;if((t.ctrlKey||t.metaKey)&&!("TEXTAREA"===t.target.tagName&&s||"INPUT"===t.target.tagName&&s||"true"===String(t.target.contentEditable)&&s)){if(-1!==(e=u.indexOf(t.keyCode)))return t.preventDefault(),t.stopPropagation(),o.send({shortcut:new r.IP("data",t.keyCode,{index:e})});o.send({missed:t.keyCode})}},ctx:i},void document.addEventListener("keydown",t.subscriber.callback,!1)}n.hasData("stop")&&(n.getData("stop"),e(),o.done())}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="mouse-pointer",t.description="Listen to mouse events on a DOM element",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("click",{datatype:"object"}),t.outPorts.add("dblclick",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("click",n.click,!1),n.el.removeEventListener("dblclick",n.dblclick,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process((function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),click:function(t){return t.preventDefault(),t.stopPropagation(),n.send({click:t})},dblclick:function(t){return t.preventDefault(),t.stopPropagation(),n.send({dblclick:t})},ctx:r}).el.addEventListener("click",o.click,!1),o.el.addEventListener("dblclick",o.dblclick,!1),t.elements.push(o))}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e,n,o,i;for((t=new r.Component).description="Listen to pointer events on a DOM element",t.icon="pencil-square-o",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("action",{datatype:"string",default:"none",control:!0}),o=0,i=(n=["down","up","cancel","move","over","out","enter","leave"]).length;o<i;o++)e=n[o],t.outPorts.add(e,{datatype:"object",description:"Sends event on pointer".concat(e)});return t.elements=[],t.tearDown=function(r){var o,i,a,s,c,u;for(i=0,s=(u=t.elements).length;i<s;i++){for((o=u[i]).el.removeAttribute&&o.el.removeAttribute("touch-action"),a=0,c=n.length;a<c;a++)e=n[a],o.el.removeEventListener("pointer".concat(e),o["pointer".concat(e)],!1);o.ctx.deactivate()}return t.elements=[],r()},t.forwardBrackets={},t.process((function(e,r,o){var i,a;e.hasData("element")&&(i=e.hasData("action")?e.getData("action"):"none",(a={el:e.getData("element"),ctx:o}).el.setAttribute("touch-action",i),n.forEach((function(t){return a["pointer".concat(t)]=function(e){var n;return e.preventDefault(),e.stopPropagation(),(n={})[t]=e.target.value,r.send(n)},a.el.addEventListener("pointer".concat(t),a["pointer".concat(t)],!1)})),t.elements.push(a))}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen to window resize events",t.icon="desktop",t.inPorts.add("start",{datatype:"bang",description:"Start listening for screen resizes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for screen resizes"}),t.outPorts.add("width",{datatype:"number"}),t.outPorts.add("height",{datatype:"number"}),t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("resize",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process((function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),t.subscriber={callback:function(t){return r.send({width:window.innerWidth,height:window.innerHeight})},ctx:o},r.send({width:window.innerWidth,height:window.innerHeight}),void window.addEventListener("resize",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),r.done())}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen to scroll events on the browser window",t.icon="arrows-v",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("top",{datatype:"number"}),t.outPorts.add("bottom",{datatype:"number"}),t.outPorts.add("left",{datatype:"number"}),t.outPorts.add("right",{datatype:"number"}),t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("scroll",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process((function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),t.subscriber={callback:function(t){var e,n;return n=window.scrollY,e=window.scrollX,r.send({top:n,bottom:n+window.innerHeight,left:e,right:e.window.innerWidth})},ctx:o},void window.addEventListener("scroll",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),r.done())}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen for user's microphone and recognize phrases",t.icon="microphone",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("result",{datatype:"string"}),t.outPorts.add("error",{datatype:"object"}),t.subscriber=null,e=function(){if(t.subscriber)return t.subscriber.recognition.stop(),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process((function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),window.webkitSpeechRecognition?(t.subscriber={sent:[],callback:function(e){var n,o,i,a,s,c;for(c=[],o=n=0,i=(a=e.results).length;n<i;o=++n)(s=a[o]).isFinal&&-1===t.subscriber.sent.indexOf(o)&&(r.send({result:s[0].transcript}),c.push(t.subscriber.sent.push(o)));return c},error:function(t){return r.send({error:t})},ctx:o},t.subscriber.recognition=new window.webkitSpeechRecognition,t.subscriber.recognition.continuous=!0,t.subscriber.recognition.start(),t.subscriber.recognition.onresult=t.subscriber.callback,void(t.subscriber.recognition.onerror=t.subscriber.error)):void r.done(new Error("Speech recognition support not available"));n.hasData("stop")&&(n.getData("stop"),e(),r.done())}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen to touch events on a DOM element",t.icon="hand-o-up",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("start",{datatype:"object"}),t.outPorts.add("movex",{datatype:"number"}),t.outPorts.add("movey",{datatype:"number"}),t.outPorts.add("end",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("touchstart",n.touchstart,!1),n.el.removeEventListener("touchmove",n.touchmove,!1),n.el.removeEventListener("touchend",n.touchend,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process((function(e,n,o){var i;e.hasData("element")&&((i={el:e.getData("element"),touchstart:function(t){var e,o,i,a,s;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(s=[],o=e=0,i=(a=t.changedTouches).length;e<i;o=++e)a[o],s.push(n.send({start:new r.IP("data",t,{touch:o})}));return s}},touchmove:function(t){var e,o,i,a,s,c;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(s=[],o=e=0,i=(a=t.changedTouches).length;e<i;o=++e)c=a[o],s.push(n.send({movex:new r.IP("data",c.pageX,{touch:o}),movey:new r.IP("data",c.pageY,{touch:o})}));return s}},touchend:function(t){var e,o,i,a,s;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(s=[],o=e=0,i=(a=t.changedTouches).length;e<i;o=++e)a[o],s.push(n.send({end:new r.IP("data",t,{touch:o})}));return s}},ctx:o}).el.addEventListener("touchstart",i.touchstart,!1),i.el.addEventListener("touchmove",i.touchmove,!1),i.el.addEventListener("touchend",i.touchend,!1),t.elements.push(i))}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Read the coordinates from a DOM event",t.icon="map-marker",t.inPorts.add("event",{datatype:"object"}),t.outPorts.add("screen",{datatype:"object"}),t.outPorts.add("client",{datatype:"object"}),t.outPorts.add("page",{datatype:"object"}),t.forwardBrackets={event:["screen","client","page"]},t.process((function(t,e){var n;if(t.hasData("event"))return n=t.getData("event"),e.sendDone({screen:{x:n.screenX,y:n.screenY},client:{x:n.clientX,y:n.clientY},page:{x:n.pageX,y:n.pageY}})}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Read the state of a gamepad",t.icon="gamepad",t.inPorts.add("gamepad",{datatype:"integer"}),t.outPorts.add("out",{datatype:"object"}),t.outPorts.add("error",{datatype:"object"}),t.lastTimestamps={},t.tearDown=function(e){return t.lastTimestamps={},e()},t.process((function(e,n){var r,o;if(e.hasData("gamepad"))if(r=e.getData("gamepad"),navigator.webkitGetGamepads){if((o=navigator.webkitGetGamepads()[r])||n.done(new Error("Gamepad '".concat(r,"' not available"))),!(t.lastTimestamps[r]=o.timestamp))return t.lastTimestamps[r]=o.timestamp,n.sendDone({out:o});n.done()}else n.done(new Error("No WebKit Gamepad API available"))}))}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Set the hash in browser's URL bar",t.icon="slack",t.inPorts.add("hash",{datatype:"string"}),t.outPorts.add("out",{datatype:"string"}),t.process((function(t,e){var n;if(t.hasData("hash"))return n=t.getData("hash"),window.location.hash="#".concat(n),e.sendDone({out:n})}))}},function(t,e,n){"use strict";function r(t,e,n){if(void 0===e)return t;switch(null===n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){t.call(e,n,r,o,i)}}return function(){return t.apply(e,arguments)}}var o=function(t){function e(e,n,r,o,i,a){for(;i>=0&&i<a;){var s=o?o[i]:i;r=n(r,e[s],s,e),i+=t}return r}return function(n,o,i,a){o=r(o,a,4);var s=Object.keys(n),c=s||n,u=c.length,l=t>0?0:u-1;return arguments.length<3&&(i=n[s?s[l]:l],l+=t),e(n,o,i,s,l,u)}}(-1);e.guessLanguageFromFilename=function(t){return/.*\.coffee$/.test(t)?"coffeescript":/.*\.ts$/.test(t)?"typescript":"javascript"},e.reduceRight=o,e.debounce=function(t,e,n){var r,o,i,a,s;function c(){var u=Date.now-a;u<e&&u>=0?r=setTimeout(c,e-u):(r=null,n||(s=t.apply(i,o),r||(i=null,o=null)))}return function(){i=this,o=arguments,a=Date.now;var u=n&&!r;return r||(r=setTimeout(c,e)),u&&(s=t.apply(i,o),i=null,o=null),s}},e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=n(22),d=n(7).deprecated,f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,t);var e,n,r,u=c(p);function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,p),d("noflo.Network construction is deprecated, use noflo.createNetwork"),u.call(this,t,e)}return e=p,(n=[{key:"connect",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};a(l(p.prototype),"connect",this).call(this,(function(n){n?e(n):(t.subscribeGraph(),e())}))}},{key:"subscribeGraph",value:function(){var t=this,e=[],n=!1,r=function(t,n){e.push({op:t,details:n})},o=function r(o){if(o){if(0===t.listeners("process-error").length)throw o;t.bufferedEmit("process-error",o)}if(e.length){n=!0;var i=e.shift(),a=r;switch(i.op){case"renameNode":t.renameNode(i.details.from,i.details.to,a);break;default:t[i.op](i.details,a)}}else n=!1};return this.graph.on("addNode",(function(t){r("addNode",t),n||o()})),this.graph.on("removeNode",(function(t){r("removeNode",t),n||o()})),this.graph.on("renameNode",(function(t,e){r("renameNode",{from:t,to:e}),n||o()})),this.graph.on("addEdge",(function(t){r("addEdge",t),n||o()})),this.graph.on("removeEdge",(function(t){r("removeEdge",t),n||o()})),this.graph.on("addInitial",(function(t){r("addInitial",t),n||o()})),this.graph.on("removeInitial",(function(t){r("removeInitial",t),n||o()}))}}])&&i(e.prototype,n),r&&i(e,r),p}(p);e.Network=f},function(t,e,n){t.exports=function(t){function e(t){let n;function i(...t){if(!i.enabled)return;const r=i,o=Number(new Date),a=o-(n||o);r.diff=a,r.prev=n,r.curr=o,n=o,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return n;s++;const i=e.formatters[o];if("function"==typeof i){const e=t[s];n=i.call(r,e),t.splice(s,1),s--}return n}),e.formatArgs.call(r,t);(r.log||e.log).apply(r,t)}return i.namespace=t,i.enabled=e.enabled(t),i.useColors=e.useColors(),i.color=e.selectColor(t),i.destroy=r,i.extend=o,"function"==typeof e.init&&e.init(i),e.instances.push(i),i}function r(){const t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}function o(t,n){const r=e(this.namespace+(void 0===n?":":n)+t);return r.log=this.log,r}function i(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},e.disable=function(){const t=[...e.names.map(i),...e.skips.map(i).map(t=>"-"+t)].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.names=[],e.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){const t=e.instances[n];t.enabled=e.enabled(t.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(102),Object.keys(t).forEach(n=>{e[n]=t[n]}),e.instances=[],e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e}},function(t,e){var n=1e3,r=6e4,o=60*r,i=24*o;function a(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}t.exports=function(t,e){e=e||{};var s=typeof t;if("string"===s&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var a=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(t);if("number"===s&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=i)return a(t,e,i,"day");if(e>=o)return a(t,e,o,"hour");if(e>=r)return a(t,e,r,"minute");if(e>=n)return a(t,e,n,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=i)return Math.round(t/i)+"d";if(e>=o)return Math.round(t/o)+"h";if(e>=r)return Math.round(t/r)+"m";if(e>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ip=e,this.nodeInstance=n,this.port=r,this.result=o,this.scope=this.ip.scope,this.activated=!1,this.deactivated=!1}var e,n,o;return e=t,(n=[{key:"activate",value:function(){(this.result.__resolved||-1===this.nodeInstance.outputQ.indexOf(this.result))&&(this.result={}),this.nodeInstance.activate(this)}},{key:"deactivate",value:function(){this.result.__resolved||(this.result.__resolved=!0),this.nodeInstance.deactivate(this)}}])&&r(e.prototype,n),o&&r(e,o),t}()},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=n(4)("noflo:component");t.exports=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ports=e,this.context=n,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.port=this.context.port,this.result=this.context.result,this.scope=this.context.scope}var e,n,a;return e=t,(n=[{key:"activate",value:function(){this.context.activated||(this.nodeInstance.isOrdered()&&(this.result.__resolved=!1),this.nodeInstance.activate(this.context),this.port.isAddressable()?u("".concat(this.nodeInstance.nodeId," packet on '").concat(this.port.name,"[").concat(this.ip.index,"]' caused activation ").concat(this.nodeInstance.load,": ").concat(this.ip.type)):u("".concat(this.nodeInstance.nodeId," packet on '").concat(this.port.name,"' caused activation ").concat(this.nodeInstance.load,": ").concat(this.ip.type)))}},{key:"attached",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n;o.length||(o=["in"]);var i=[];return o.forEach((function(e){if(!t.ports[e])throw new Error("Node ".concat(t.nodeInstance.nodeId," has no port '").concat(e,"'"));i.push(t.ports[e].listAttached())})),1===o.length?i.pop():i}},{key:"has",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,o=e;o.length||(o=["in"]),r="function"==typeof o[o.length-1]?o.pop():function(){return!0};for(var i=0;i<o.length;i+=1){var a=o[i];if(Array.isArray(a)){if(!this.ports[a[0]])throw new Error("Node ".concat(this.nodeInstance.nodeId," has no port '").concat(a[0],"'"));if(!this.ports[a[0]].isAddressable())throw new Error("Non-addressable ports, access must be with string ".concat(a[0]));if(!this.ports[a[0]].has(this.scope,a[1],r))return!1}else{if(!this.ports[a])throw new Error("Node ".concat(this.nodeInstance.nodeId," has no port '").concat(a,"'"));if(this.ports[a].isAddressable())throw new Error("For addressable ports, access must be with array [".concat(a,", idx]"));if(!this.ports[a].has(this.scope,r))return!1}}return!0}},{key:"hasData",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e;return r.length||(r=["in"]),r.push((function(t){return"data"===t.type})),this.has.apply(this,i(r))}},{key:"hasStream",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i,a=n;a.length||(a=["in"]),i="function"==typeof a[a.length-1]?a.pop():function(){return!0};for(var s=function(e){var n=a[e],r=[],o=!1;if(!t.has(n,(function(t){return"openBracket"===t.type?(r.push(t.data),!1):"data"===t.type?(o=i(t,r),!r.length&&o):"closeBracket"===t.type&&(r.pop(),!r.length&&!!o)})))return{v:!1}},c=0;c<a.length;c+=1){var u=s(c);if("object"===o(u))return u.v}return!0}},{key:"get",value:function(){this.activate();for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e;o.length||(o=["in"]);for(var i=[],a=0;a<o.length;a+=1){var s=o[a],c=void 0,u=void 0,l=void 0;if(Array.isArray(s)){var p=Array.from(s),d=r(p,2);if(l=d[0],c=d[1],!this.ports[l].isAddressable())throw new Error("Non-addressable ports, access must be with string portname")}else if(l=s,this.ports[l].isAddressable())throw new Error("For addressable ports, access must be with array [portname, idx]");this.nodeInstance.isForwardingInport(l)?(u=this.__getForForwarding(l,c),i.push(u)):(u=this.ports[l].get(this.scope,c),i.push(u))}return 1===o.length?i[0]:i}},{key:"__getForForwarding",value:function(t,e){for(var n=[],r=null,o=!0;o;){var i=this.ports[t].get(this.scope,e);if(!i)break;if("data"===i.type){r=i,o=!1;break}n.push(i)}for(var a=0;a<n.length;a+=1){var s=n[a];if("closeBracket"===s.type){this.result.__bracketClosingBefore||(this.result.__bracketClosingBefore=[]);var c=this.nodeInstance.getBracketContext("in",t,this.scope,e).pop();c.closeIp=s,this.result.__bracketClosingBefore.push(c)}else"openBracket"===s.type&&this.nodeInstance.getBracketContext("in",t,this.scope,e).push({ip:s,ports:[],source:t})}return this.result.__bracketContext||(this.result.__bracketContext={}),this.result.__bracketContext[t]=this.nodeInstance.getBracketContext("in",t,this.scope,e).slice(0),r}},{key:"getData",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n;o.length||(o=["in"]);var i=[];return o.forEach((function(e){var n=t.get(e);if(null!=n){for(;"data"!==n.type&&(n=t.get(e)););i.push(n.data)}else i.push(n)})),1===o.length?i.pop():i}},{key:"getStream",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e;r.length||(r=["in"]);for(var o=[],i=0;i<r.length;i+=1){var a=r[i],s=[],c=[],u=!1,l=this.get(a);for(l||o.push(void 0);l&&("openBracket"===l.type&&(s.length||(c=[],u=!1),s.push(l.data),c.push(l)),"data"!==l.type||(c.push(l),u=!0,s.length))&&("closeBracket"!==l.type||(c.push(l),s.pop(),!u||s.length));)l=this.get(a);o.push(c)}return 1===r.length?o.pop():o}}])&&c(e.prototype,n),a&&c(e,a),t}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=n(4)("noflo:component"),a=n(6);t.exports=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ports=e,this.context=n,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.result=this.context.result,this.scope=this.context.scope}var e,n,s;return e=t,(n=[{key:"error",value:function(t){var e=this,n=t,r=Array.isArray(t);r||(n=[t]),!("error"in this.ports)||!this.ports.error.isAttached()&&this.ports.error.isRequired()?n.forEach((function(t){throw t})):(r&&this.sendIP("error",new a("openBracket")),n.forEach((function(t){e.sendIP("error",t)})),r&&this.sendIP("error",new a("closeBracket")))}},{key:"sendIP",value:function(t,e){var n;if(n=a.isIP(e)?e:new a("data",e),null!==this.scope&&null===n.scope&&(n.scope=this.scope),!this.nodeInstance.outPorts[t])throw new Error("Node ".concat(this.nodeInstance.nodeId," does not have outport ").concat(t));if(this.nodeInstance.outPorts[t].isAddressable()&&null===n.index)throw new Error("Sending packets to addressable port ".concat(this.nodeInstance.nodeId," ").concat(t," requires specifying index"));this.nodeInstance.isOrdered()?this.nodeInstance.addToResult(this.result,t,n):(this.nodeInstance.outPorts[t].options.scoped||(n.scope=null),this.nodeInstance.outPorts[t].sendIP(n))}},{key:"send",value:function(t){var e=this;if((n=t)instanceof Error||Array.isArray(n)&&n.length>0&&n[0]instanceof Error)this.error(t);else{var n,o=[],i=!1;if(Object.keys(this.ports.ports).forEach((function(e){"error"!==e&&"ports"!==e&&"_callbacks"!==e&&o.push(e),i||null==t||"object"!==r(t)||-1===Object.keys(t).indexOf(e)||(i=!0)})),1!==o.length||i){if(o.length>1&&!i)throw new Error("Port must be specified for sending output");Object.keys(t).forEach((function(n){var r=t[n];e.sendIP(n,r)}))}else this.sendIP(o[0],t)}}},{key:"sendDone",value:function(t){this.send(t),this.done()}},{key:"pass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!("out"in this.ports))throw new Error('output.pass() requires port "out" to be present');var n=this;Object.keys(e).forEach((function(t){var r=e[t];n.ip[t]=r})),this.ip.data=t,this.sendIP("out",this.ip),this.done()}},{key:"done",value:function(t){var e,n,r,o,a=this;this.result.__resolved=!0,this.nodeInstance.activate(this.context),t&&this.error(t),this.nodeInstance.isOrdered()&&(e=a.nodeInstance.outputQ.filter((function(t){return!t.__resolved||2!==Object.keys(t).length||!t.__bracketClosingAfter})),n=e.indexOf(a.result),r=e.length,o=a.nodeInstance.load,n===r-1||-1===n&&o===r+1||r<=1&&1===o)&&Object.keys(this.nodeInstance.bracketContext.in).forEach((function(t){var e=a.nodeInstance.bracketContext.in[t];if(e[a.scope]){var n=e[a.scope];if(n.length)for(var r=n[n.length-1],o=a.nodeInstance.inPorts[r.source],i=o.getBuffer(r.ip.scope,r.ip.index);i.length>0&&"closeBracket"===i[0].type;){var s=o.get(r.ip.scope,r.ip.index),c=n.pop();c.closeIp=s,a.result.__bracketClosingAfter||(a.result.__bracketClosingAfter=[]),a.result.__bracketClosingAfter.push(c)}}})),i("".concat(this.nodeInstance.nodeId," finished processing ").concat(this.nodeInstance.load)),this.nodeInstance.deactivate(this.context)}}])&&o(e.prototype,n),s&&o(e,s),t}()},function(t,e,n){"use strict";(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n(10).Graph,i=n(12).ComponentLoader,a=n(21).Network,s=n(6),c=n(11);function u(t,e){if(e.raw)return t;var n=[],r=null,o=n;return t.forEach((function(t){"openBracket"===t.type&&(r=o,o=[],r.push(o)),"data"===t.type&&o.push(t.data),"closeBracket"===t.type&&(o=r)})),1===n.length?n[0]:n}e.asCallback=function(e,n){return n=function(e,n){return e||(e={}),e.name||(e.name=n),e.loader&&(e.baseDir=e.loader.baseDir),!e.baseDir&&t&&t.cwd&&(e.baseDir=t.cwd()),e.loader||(e.loader=new i(e.baseDir)),e.raw||(e.raw=!1),e}(n,e),function(t,i){!function(t,e,n){var i;if("object"===r(t))return t.componentLoader=e.loader,void(i=new a(t,e)).connect((function(t){t?n(t):n(null,i)}));e.loader.load(t,(function(r,s){if(r)n(r);else{var c=new o(e.name),u=e.name;c.addNode(u,t);var l=s.inPorts.ports,p=s.outPorts.ports;Object.keys(l).forEach((function(t){c.addInport(t,u,t)})),Object.keys(p).forEach((function(t){c.addOutport(t,u,t)})),c.componentLoader=e.loader,(i=new a(c,e)).connect((function(t){t?n(t):n(null,i)}))}}))}(e,n,(function(e,o){if(e)i(e);else{n.networkCallback&&n.networkCallback(o);var a=function t(e,n){if("object"!==r(e))return"simple";if(Array.isArray(e))return e.filter((function(e){return"map"===t(e,n)})).length===e.length?"sequence":"simple";var o=Object.keys(e);if(!o.length)return"simple";for(var i=0;i<o.length;i+=1){var a=o[i];if(!n.graph.inports[a])return"simple"}return"map"}(t,o);!function(t,e,n,r){var o={},i=[],a=Object.keys(t.graph.outports),u={};a.forEach((function(e){var n=t.graph.outports[e],r=t.getNode(n.process);u[e]=c.createSocket(),r.component.outPorts[n.port].attach(u[e]),u[e].from={process:r,port:n.port},u[e].on("ip",(function(t){var n={};n[e]=t,i.push(n)}))}));var l,p=null;l=function(e){r(e.error),t.removeListener("end",p)},t.once("process-error",l),p=function(){Object.keys(u).forEach((function(t){var e=u[t];e.from.process.component.outPorts[e.from.port].detach(e)})),u={},o={},r(null,i),t.removeListener("process-error",l)},t.once("end",p),t.start((function(n){if(n)r(n);else for(var i=0;i<e.length;i+=1)for(var a=e[i],u=Object.keys(a),d=0;d<u.length;d+=1){var f=u[d],h=a[f];if(!o[f]){var m=t.graph.inports[f],g=t.getNode(m.process);o[f]=c.createSocket(),g.component.inPorts[m.port].attach(o[f])}try{s.isIP(h)?o[f].post(h):o[f].post(new s("data",h))}catch(e){return r(e),t.removeListener("process-error",l),void t.removeListener("end",p)}}}))}(o,function(t,e,n){if("sequence"===e)return t;if("map"===e)return[t];var r=Object.keys(n.graph.inports)[0];n.graph.inports.in&&(r="in");var o={};return o[r]=t,[o]}(t,a,o),0,(function(t,e){t?i(t):function(t,e,n,r){var o=t.filter((function(t){return null!=t.error})).map((function(t){return t.error}));if(o.length)r(u(o,n));else if("sequence"!==e){var i={};t.forEach((function(t){Object.keys(t).forEach((function(e){var n=t[e];i[e]||(i[e]=[]),i[e].push(n)}))}));var a=Object.keys(i).filter((function(t){return i[t].length>0}));if(0!==a.length)if(1!==a.length||"simple"!==e){var s={};Object.keys(i).forEach((function(t){var e=i[t];s[t]=u(e,n)})),r(null,s)}else r(null,u(i[a[0]],n));else r(null)}else r(null,t.map((function(t){var e={};return Object.keys(t).forEach((function(r){var o=t[r];n.raw?e[r]=o:e[r]=u([o],n)})),e})))}(e,a,n,i)}))}}))}}}).call(this,n(1))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var a=n(108),s=n(23).Component;e.asComponent=function(t,e){var n=!1,i=a(t).filter((function(t){return"callback"!==t.param||(n=!0,!1)})),c=new s(e);return i.forEach((function(t){var e={required:!0};void 0!==t.default&&(e.default=t.default,e.required=!1),c.inPorts.add(t.param,e),c.forwardBrackets[t.param]=["out","error"]})),i.length||c.inPorts.add("in",{datatype:"bang"}),c.outPorts.add("out"),c.outPorts.add("error"),c.process((function(e,a){var s;if(i.length){for(var c=0;c<i.length;c+=1){var u=i[c];if(!e.hasData(u.param))return}s=i.map((function(t){return e.getData(t.param)}))}else{if(!e.hasData("in"))return;e.getData("in"),s=[]}if(n)return s.push((function(t,e){t?a.done(t):a.sendDone(e)})),void t.apply(void 0,o(s));var l=t.apply(void 0,o(s));l&&"object"===r(l)&&"function"==typeof l.then?l.then((function(t){return a.sendDone(t)}),(function(t){return a.done(t)})):a.sendDone(l)})),c}},function(t,e,n){var r=n(28),o=n(109),i=n(110),a=n(111);t.exports=function(t){var e=[],n=t.toString().replace(/\/\*.*?\*\//g,"");n=o(e,n);var s=i(e,n,r.prePatterns).replace(/\n/g,"").replace(/\s*async\s*/,"").match(/(?:function\s*\((.*?)\)|\((.*?)\))|(.*?)\s*=>/);return s=s[1]||s[2]||s[3]||"",i(e,s,r.postPatterns).split(",").filter((function(t){return t})).map((function(t){var n=(t=a(e,t,!0)).split("="),r={param:n[0].trim()};return n[1]&&(r.default=a(e,n.slice(1).join("="))),r}))}},function(t,e,n){var r=n(28).stringPatterns,o=n(13);t.exports=function(t,e){for(;;){var n=r.reduce((function(t,n){return t.concat(e.match(n)||[])}),[]).sort((function(t,e){return t.length-e.length}))[0];if(!n)return e;e=e.replace(n,o(t.push(n)))}}},function(t,e,n){var r=n(13);t.exports=function(t,e,n){return n.forEach((function(n){for(;n.test(e);){var o=n.exec(e)[0];e=e.replace(o,r(t.push(o)))}})),e}},function(module,exports,__webpack_require__){var delim=__webpack_require__(13);module.exports=function(cache,string,skipEval){for(var pattern=/:~:(\d+?):~:/;pattern.test(string);){var id=pattern.exec(string)[1];string=string.replace(delim(id),cache[id-1])}return skipEval?string:eval("("+string+")")}},function(t,e,n){t.exports={postMessage:n(14),iframe:n(136),opener:n(137)}},function(t,e,n){const r=n(0),{EventEmitter:o}=n(2);function i(t,e,n){let r;if(!t.graph)return null;if(r=n?t.graph.inports[e]:t.graph.outports[e],!(null!=r?r.process:void 0))return null;const o=t.getNode(r.process);if(!o)return null;const{component:i}=o;return i?n?i.inPorts.ports[r.port]:i.outPorts.ports[r.port]:null}function a(t,e,n,r){const o={id:t,type:"all",description:null!=e.metadata?e.metadata.description:void 0,addressable:!1,required:!1},a=i(n,t,r);return a?(o.type=a.getDataType()||"all",("function"==typeof a.getSchema?a.getSchema():void 0)&&(o.schema=a.getSchema()),o.description=(null!=e.metadata?e.metadata.description:void 0)||a.getDescription()||"",o.addressable=a.isAddressable(),o.required=a.isRequired(),o):o}t.exports=class extends o{constructor(t){super(),this.transport=t,this.outputSockets={},this.mainGraph=null,this.transport.network.on("removenetwork",(t,e)=>(this.subscribeOutdata(e,t,!1),this.subscribeOutPorts(e,t),this.subscribeExportedPorts(e,t,!1),this.sendPorts(e,null)))}registerNetwork(t,e){this.subscribeExportedPorts(t,e,!0),this.subscribeOutPorts(t,e),this.sendPorts(t,e),e.isStarted()&&this.subscribeOutdata(t,e,!0),e.once("start",()=>{this.subscribeOutdata(t,e,!0)})}send(t,e,n){return this.transport.send("runtime",t,e,n)}sendAll(t,e){return this.transport.sendAll("runtime",t,e)}sendError(t,e){return this.send("error",new Error(t),e)}receive(t,e,n){switch(t){case"getruntime":return this.getRuntime(e,n);case"packet":return this.sendPacket(e,t=>{t?this.sendError(t.message,n):this.send("packetsent",{port:e.port,event:e.event,graph:e.graph,payload:e.payload},n)});default:return this.send("error",new Error(`runtime:${t} not supported`),n)}}getRuntime(t,e){let{type:n}=this.transport.options;n||(n=r.isBrowser()?"noflo-browser":"noflo-nodejs");const{capabilities:o}=this.transport.options,i=t?t.secret:null,a=o.filter(t=>this.transport.canDo(t,i)),s={type:n,version:this.transport.version,capabilities:a,allCapabilities:o};return this.mainGraph&&(s.graph=this.mainGraph),this.transport.options.id&&(s.id=this.transport.options.id),this.transport.options.label&&(s.label=this.transport.options.label),this.transport.options.namespace&&(s.namespace=this.transport.options.namespace),this.transport.options.repository&&(s.repository=this.transport.options.repository),this.transport.options.repositoryVersion&&(s.repositoryVersion=this.transport.options.repositoryVersion),this.send("runtime",s,e),(()=>{const t=[];return Object.keys(this.transport.network.networks).forEach(n=>{const r=this.transport.network.networks[n];t.push(this.sendPorts(n,r,e))}),t})()}sendPorts(t,e,n){const r=function(t,e){let n;const r={graph:t,inPorts:[],outPorts:[]};return(null!=e?e.graph:void 0)?(Object.keys(e.graph.inports).forEach(t=>{n=e.graph.inports[t],r.inPorts.push(a(t,n,e,!0))}),Object.keys(e.graph.outports).forEach(t=>{n=e.graph.outports[t],r.outPorts.push(a(t,n,e,!1))}),r):r}(t,e);return this.emit("ports",r),n?this.send("ports",r,n):this.sendAll("ports",r)}setMainGraph(t){this.mainGraph=t}subscribeExportedPorts(t,e,n){const r=()=>this.sendPorts(t,e),o=["addInport","addOutport","removeInport","removeOutport"];if(o.forEach(t=>{e.graph.removeListener(t,r)}),n){const t=[];o.forEach(n=>{t.push(e.graph.on(n,r))})}}subscribeOutPorts(t,e,n){const r=()=>this.subscribeOutdata(t,e,!1),o=()=>this.subscribeOutdata(t,e,!0),{graph:i}=e;i.removeListener("addOutport",o),i.removeListener("removeOutport",r),n&&(i.on("addOutport",o),i.on("removeOutport",r))}subscribeOutdata(t,e,n){this.outputSockets[t]||(this.outputSockets[t]={});let o=this.outputSockets[t];Object.keys(o).forEach(t=>{o[t].removeAllListeners("ip")}),o={},n&&Object.keys(e.graph.outports).forEach(n=>{const i=e.graph.outports[n],a=r.internalSocket.createSocket();o[n]=a;const{component:s}=e.processes[i.process];if(!(null!=s?s.outPorts[i.port]:void 0))throw new Error(`Exported outport ${i.port} in node ${i.process} not found`);let c;s.outPorts[i.port].attach(a),a.on("ip",e=>{switch(e.type){case"openBracket":c="begingroup";break;case"closeBracket":c="endgroup";break;default:c=e.type}this.emit("packet",{port:n,event:c,graph:t,payload:e.data}),this.sendAll("packet",{port:n,event:c,graph:t,payload:e.data})})})}sendPacket(t,e){const n=this.transport.network.networks[t.graph];if(!n)return e(new Error("Cannot find network for graph "+t.graph));const o=i(n.network,t.port,!0);return o?(function(t,e,n){const o=r.internalSocket.createSocket();switch(t.attach(o),e){case"begingroup":o.beginGroup(n);break;case"endgroup":o.endGroup(n);break;case"data":o.send(n)}t.detach(o)}(o,t.event,t.payload),e()):e(new Error("Cannot find internal port for "+t.port))}}},function(t,e,n){const r=n(0),{EventEmitter:o}=n(2),{withNamespace:i}=n(15);t.exports=class extends o{constructor(t){super(),this.transport=t,this.graphs={}}send(t,e,n){return this.transport.send("graph",t,e,n)}sendAll(t,e){return this.transport.sendAll("graph",t,e)}receive(t,e,n){let r;if("clear"===t||(r=this.resolveGraph(e,n),r))switch(t){case"clear":this.initGraph(e,n);break;case"addnode":this.addNode(r,e,n);break;case"removenode":this.removeNode(r,e,n);break;case"renamenode":this.renameNode(r,e,n);break;case"changenode":this.changeNode(r,e,n);break;case"addedge":this.addEdge(r,e,n);break;case"removeedge":this.removeEdge(r,e,n);break;case"changeedge":this.changeEdge(r,e,n);break;case"addinitial":this.addInitial(r,e,n);break;case"removeinitial":this.removeInitial(r,e,n);break;case"addinport":this.addInport(r,e,n);break;case"removeinport":this.removeInport(r,e,n);break;case"renameinport":this.renameInport(r,e,n);break;case"addoutport":this.addOutport(r,e,n);break;case"removeoutport":this.removeOutport(r,e,n);break;case"renameoutport":this.renameOutport(r,e,n);break;case"addgroup":this.addGroup(r,e,n);break;case"removegroup":this.removeGroup(r,e,n);break;case"renamegroup":this.renameGroup(r,e,n);break;case"changegroup":this.changeGroup(r,e,n);break;default:this.send("error",new Error(`graph:${t} not supported`),n)}}resolveGraph(t,e){return t.graph?this.graphs[t.graph]?this.graphs[t.graph]:(this.send("error",new Error("Requested graph not found"),e),null):(this.send("error",new Error("No graph specified"),e),null)}getLoader(t){return this.transport.component.getLoader(t,this.transport.options)}sendGraph(t,e,n){const r={graph:t,description:e.toJSON()};return this.send("graph",r,n)}initGraph(t,e){if(!t.id)return void this.send("error",new Error("No graph ID provided"),e);const n=new r.Graph(t.name||"NoFlo runtime");n.properties.id=t.id,n.properties.main=t.main;let{library:o}=t;o&&(o=o.replace("noflo-",""),n.properties.library=o),t.icon&&(n.properties.icon=t.icon),t.description&&(n.properties.description=t.description),n.baseDir=this.transport.options.baseDir,this.registerGraph(t.id,n,e,!0)}registerGraph(t,e,n=null,r=!0){this.transport.network.initNetwork(e,t,n,(o,a)=>{if(o)return void this.send("error",o,n);if(this.subscribeGraph(t,e,n),this.graphs[t]=e,this.sendAll("clear",{id:t,name:e.name,library:e.properties.library,main:e.properties.main,icon:e.properties.icon,description:e.properties.description},n),!r)return;const s=i(t,e.properties.library||this.transport.options.namespace);this.transport.runtime.registerNetwork(t,a),0!==t.indexOf("fixture.")&&("main"===e.name||e.properties.main?this.transport.runtime.setMainGraph(s,e,n):this.transport.component.registerGraph(s,e,n))})}subscribeGraph(t,e,n){return e.on("addNode",e=>{this.sendAll("addnode",{...e,graph:t},n)}),e.on("removeNode",e=>{const r={id:e.id,graph:t};this.sendAll("removenode",r,n)}),e.on("renameNode",(e,r)=>this.sendAll("renamenode",{from:e,to:r,graph:t},n)),e.on("changeNode",e=>this.sendAll("changenode",{id:e.id,metadata:e.metadata,graph:t},n)),e.on("addEdge",e=>{const r={src:e.from,tgt:e.to,metadata:e.metadata,graph:t};this.sendAll("addedge",r,n)}),e.on("removeEdge",e=>{const r={src:e.from,tgt:e.to,graph:t};this.sendAll("removeedge",r,n)}),e.on("changeEdge",e=>{const r={src:e.from,tgt:e.to,metadata:e.metadata,graph:t};this.sendAll("changeedge",r,n)}),e.on("addInitial",e=>{const r={src:e.from,tgt:e.to,metadata:e.metadata,graph:t};this.sendAll("addinitial",r,n)}),e.on("removeInitial",e=>{const r={src:e.from,tgt:e.to,graph:t};this.sendAll("removeinitial",r,n)}),e.on("addGroup",e=>{const r={name:e.name,nodes:e.nodes,metadata:e.metadata,graph:t};this.sendAll("addgroup",r,n)}),e.on("removeGroup",e=>{const r={name:e.name,graph:t};this.sendAll("removegroup",r,n)}),e.on("renameGroup",(e,r)=>{const o={from:e,to:r,graph:t};this.sendAll("renamegroup",o,n)}),e.on("changeGroup",e=>{const r={name:e.name,metadata:e.metadata,graph:t};this.sendAll("changegroup",r,n)}),e.on("addInport",(e,r)=>{const o={public:e,node:r.process,port:r.port,metadata:r.metadata,graph:t};this.sendAll("addinport",o,n)}),e.on("addOutport",(e,r)=>{const o={public:e,node:r.process,port:r.port,metadata:r.metadata,graph:t};this.sendAll("addoutport",o,n)}),e.on("removeInport",e=>{const r={public:e,graph:t};this.sendAll("removeinport",r,n)}),e.on("removeOutport",e=>{const r={public:e,graph:t};this.sendAll("removeoutport",r,n)}),e.on("renameInport",(e,r)=>{const o={from:e,to:r,graph:t};this.sendAll("renameinport",o,n)}),e.on("renameOutport",(e,r)=>{const o={from:e,to:r,graph:t};this.sendAll("renameoutport",o,n)}),e.on("endTransaction",()=>this.emit("updated",{name:t,graph:e}))}addNode(t,e,n){if(!e.id&&!e.component)return void this.send("error",new Error("No ID or component supplied"),n);const r=this.transport.network.getNetwork(t.properties.id);r?r.addNode(e,t=>{t&&this.send("error",t,n)}):t.addNode(e.id,e.component,e.metadata)}removeNode(t,e,n){if(!e.id)return void this.send("error",new Error("No ID supplied"),n);const r=this.transport.network.getNetwork(t.properties.id);r?r.removeNode(e,t=>{t&&this.send("error",t,n)}):t.removeNode(e.id)}renameNode(t,e,n){if(!e.from&&!e.to)return void this.send("error",new Error("No from or to supplied"),n);const r=this.transport.network.getNetwork(t.properties.id);r?r.renameNode(e.from,e.to,t=>{t&&this.send("error",t,n)}):t.renameNode(e.from,e.to)}changeNode(t,e,n){e.id||e.metadata?t.setNodeMetadata(e.id,e.metadata):this.send("error",new Error("No id or metadata supplied"),n)}addEdge(t,e,n){if(!e.src&&!e.tgt)return void this.send("error",new Error("No src or tgt supplied"),n);const r=this.transport.network.getNetwork(t.properties.id);r?r.addEdge({from:e.src,to:e.tgt,metadata:e.metadata},t=>{t&&this.send("error",t,n)}):"number"!=typeof e.src.index&&"number"!=typeof e.tgt.index||!t.addEdgeIndex?t.addEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata):t.addEdgeIndex(e.src.node,e.src.port,e.src.index,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata)}removeEdge(t,e,n){if(!e.src&&!e.tgt)return void this.send("error",new Error("No src or tgt supplied"),n);const r=this.transport.network.getNetwork(t.properties.id);r?r.removeEdge({from:e.src,to:e.tgt},t=>{t&&this.send("error",t,n)}):t.removeEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port)}changeEdge(t,e,n){e.src||e.tgt?t.setEdgeMetadata(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata):this.send("error",new Error("No src or tgt supplied"),n)}addInitial(t,e,n){if(!e.src&&!e.tgt)return void this.send("error",new Error("No src or tgt supplied"),n);const r=this.transport.network.getNetwork(t.properties.id);r?r.addInitial({from:e.src,to:e.tgt,metadata:e.metadata},t=>{t&&this.send("error",t,n)}):t.addInitialIndex&&"number"==typeof e.tgt.index?t.addInitialIndex(e.src.data,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata):t.addInitial(e.src.data,e.tgt.node,e.tgt.port,e.metadata)}removeInitial(t,e,n){if(!e.tgt)return void this.send("error",new Error("No tgt supplied"),n);const r=this.transport.network.getNetwork(t.properties.id);r?r.removeInitial({from:e.src,to:e.tgt,metadata:e.metadata},t=>{t&&this.send("error",t,n)}):t.removeInitial(e.tgt.node,e.tgt.port)}addInport(t,e,n){e.public||e.node||e.port?t.addInport(e.public,e.node,e.port,e.metadata):this.send("error",new Error("Missing exported inport information"),n)}removeInport(t,e,n){e.public?t.removeInport(e.public):this.send("error",new Error("Missing exported inport name"),n)}renameInport(t,e,n){e.from||e.to?t.renameInport(e.from,e.to):this.send("error",new Error("No from or to supplied"),n)}addOutport(t,e,n){e.public||e.node||e.port?t.addOutport(e.public,e.node,e.port,e.metadata):this.send("error",new Error("Missing exported outport information"),n)}removeOutport(t,e,n){e.public?t.removeOutport(e.public):this.send("error",new Error("Missing exported outport name"),n)}renameOutport(t,e,n){e.from||e.to?t.renameOutport(e.from,e.to):this.send("error",new Error("No from or to supplied"),n)}addGroup(t,e,n){e.name||e.nodes||e.metadata?t.addGroup(e.name,e.nodes,e.metadata):this.send("error",new Error("No name or nodes or metadata supplied"),n)}removeGroup(t,e,n){e.name?t.removeGroup(e.name):this.send("error",new Error("No name supplied"),n)}renameGroup(t,e,n){e.from||e.to?t.renameGroup(e.from,e.to):this.send("error",new Error("No from or to supplied"),n)}changeGroup(t,e,n){e.name||e.metadata?t.setEdgeMetadata(e.name,e.metadata):this.send("error",new Error("No name or metadata supplied"),n)}}},function(t,e,n){(function(e){const r=n(0),{EventEmitter:o}=n(2);const i=t=>t?`${t.process}(${t.port})`:"",a=t=>t?`${t.process.id}(${t.port})`:"";t.exports=class extends o{constructor(t){super(),this.transport=t,this.networks={}}send(t,e,n){return this.transport.send("network",t,e,n)}sendAll(t,e){return this.transport.sendAll("network",t,e)}receive(t,e,n){const r=this.resolveGraph(e,n);if(r)switch(t){case"start":this.startNetwork(r,e,n);break;case"stop":this.stopNetwork(r,e,n);break;case"edges":this.updateEdgesFilter(r,e,n);break;case"debug":this.debugNetwork(r,e,n);break;case"getstatus":this.getStatus(r,e,n);break;default:this.send("error",new Error(`network:${t} not supported`),n)}}resolveGraph(t,e){return t.graph?this.transport.graph.graphs[t.graph]?this.transport.graph.graphs[t.graph]:(this.send("error",new Error("Requested graph not found"),e),null):(this.send("error",new Error("No graph specified"),e),null)}getNetwork(t){return this.networks[t]&&this.networks[t].network?this.networks[t].network:null}updateEdgesFilter(t,e,n){let r=this.networks[e.graph];r?r.filters={}:(r={network:null,filters:{}},this.networks[e.graph]=r),e.edges.forEach(t=>{const e=(t=>`${i(t.src)} -> ${i(t.tgt)}`)(t);r.filters[e]=!0}),this.send("edges",{graph:e.graph,edges:e.edges},n)}eventFiltered(t,e){if(!this.transport.options.filterData)return!0;const n=(r=e.socket,`${a(r.from)} -> ${a(r.to)}`);var r;return this.networks[t].filters[n]}initNetwork(t,e,n,o){const i=this.getNetwork(e);if(i)return void i.stop(r=>{r?o(r):(delete this.networks[e].network,this.emit("removenetwork",i,e,this.networks),this.initNetwork(t,e,n,o))});const a=t;a.componentLoader=this.transport.component.getLoader(t.baseDir,this.transport.options);const s=JSON.parse(JSON.stringify(this.transport.options));s.delay=!0,r.createNetwork(a,{subscribeGraph:!1,delay:!0},(t,r)=>{t?o(t):(this.networks[e]&&this.networks[e].network?this.networks[e].network=r:this.networks[e]={network:r,filters:{}},this.emit("addnetwork",r,e,this.networks),this.subscribeNetwork(r,e,n),r.connect(t=>{t?o(t):o(null,r)}))},s)}subscribeNetwork(t,n,o){t.on("start",e=>this.sendAll("started",{time:e.start,graph:n,running:t.isRunning(),started:t.isStarted()},o)),t.on("end",e=>{this.sendAll("stopped",{time:new Date,uptime:e.uptime,graph:n,running:t.isRunning(),started:t.isStarted()},o)}),t.on("icon",t=>{this.sendAll("icon",{...t,graph:n},o)}),t.on("ip",t=>{if(!this.eventFiltered(n,t))return;const i={id:t.id,socket:t.socket,subgraph:t.subgraph,metadata:t.metadata};switch(t.type){case"openBracket":i.type="begingroup",i.group=t.data||"";break;case"data":i.type="data",i.data=t.data,i.datatype=t.datatype,i.schema=t.schema;break;case"closeBracket":i.type="endgroup",i.group=t.data||""}this.sendAll(i.type,function(t,n){const o={id:t.id,graph:n};if(t.socket.from&&(o.src={node:t.socket.from.process.id,port:t.socket.from.port}),t.socket.to&&(o.tgt={node:t.socket.to.process.id,port:t.socket.to.port}),t.subgraph&&(o.subgraph=t.subgraph),void 0!==t.group&&(o.group=t.group),t.datatype&&(o.type=t.datatype),t.schema&&(o.schema=t.schema),o.data=t.data,void 0!==o.data){if(r.isBrowser()||e.isBuffer(o.data)&&(o.data=o.data.slice(0,20)),(null!=o.data?o.data.toJSON:void 0)&&(o.data=o.data.toJSON()),(null!=o.data?o.data.toString:void 0)&&(o.data=o.data.toString(),"[object Object]"===o.data))try{o.data=JSON.parse(JSON.stringify(o.data))}catch(t){}(null!=t.metadata?t.metadata.secure:void 0)&&(o.data="DATA")}return o}(i,n),o)}),t.on("process-error",t=>{let e=t.error.message;if(t.error.stack){t.error.stack.split("\n").slice(0,3).forEach(t=>{e+="\n"+t})}this.sendAll("processerror",{id:t.id,error:e,graph:n},o)})}_startNetwork(t,e,n,r){const o=this.getNetwork(e);o?o.start(t=>{t?r(t):r(null,o)}):this.initNetwork(t,e,n,t=>{if(t)return void r(t);const n=this.getNetwork(e);n.start(t=>{t?r(t):r(null,n)})})}startNetwork(t,e,n){this._startNetwork(t,e.graph,n,t=>{t&&this.send("error",t,n)})}stopNetwork(t,e,n){const r=this.getNetwork(e.graph);r?r.isStarted()?this.networks[e.graph].network.stop(t=>{t?this.send("error",t,n):this.send("stopped",{time:new Date,graph:e.graph,running:r.isRunning(),started:r.isStarted()},n)}):this.send("stopped",{time:new Date,graph:e.graph,running:r.isRunning(),started:r.isStarted()},n):this.send("error",new Error(`Network ${e.graph} not found`),n)}debugNetwork(t,e,n){const r=this.getNetwork(e.graph);r?(r.setDebug(e.enable),this.send("setdebug",{enable:e.enable})):this.send("error",new Error(`Network ${e.graph} not found`),n)}getStatus(t,e,n){const r=this.getNetwork(e.graph);r?this.send("status",{graph:e.graph,running:r.isRunning(),started:r.isStarted()},n):this.send("error",new Error(`Network ${e.graph} not found`),n)}}}).call(this,n(20).Buffer)},function(t,e,n){const r=n(0),o=n(117),{EventEmitter:i}=n(2),{parseName:a}=n(15);class s extends i{static initClass(){this.prototype.loaders={}}constructor(t){super(),this.transport=t}send(t,e,n){return this.transport.send("component",t,e,n)}receive(t,e,n){switch(t){case"list":return this.listComponents(e,n);case"getsource":return this.getSource(e,n);case"source":return this.setSource(e,n);default:return this.send("error",new Error(`component:${t} not supported`),n)}}getLoader(t,e={}){return this.loaders[t]||(this.loaders[t]=new r.ComponentLoader(t,e)),this.loaders[t]}listComponents(t,e){const{baseDir:n}=this.transport.options,r=this.getLoader(n,this.transport.options);return r.listComponents((t,n)=>{if(t)return void this.send("error",t,e);const o=Object.keys(n);let i=0;o.forEach(t=>{this.processComponent(r,t,e,t=>{if(t)return this.send("error",t,e),void(i+=1);i+=1,i<o.length||this.send("componentsready",i,e)})})})}getSource(t,e){const{baseDir:n}=this.transport.options;return this.getLoader(n,this.transport.options).getSource(t.name,(n,r)=>{if(n){const r=a(t.name),o=this.transport.graph.graphs[t.name]||this.transport.graph.graphs[r.name];return null==o?void this.send("error",n,e):void this.send("source",{name:r.name,library:r.library,code:JSON.stringify(o.toJSON()),language:"json"},e)}this.send("source",r,e)})}setSource(t,e){const{baseDir:n}=this.transport.options,r=this.getLoader(n,this.transport.options);r.setSource(t.library,t.name,t.code,t.language,n=>{n?this.send("error",n,e):(this.emit("updated",{name:t.name,library:t.library,code:t.code,tests:t.tests,language:t.language}),this.processComponent(r,r.normalizeName(t.library,t.name),e))})}processComponent(t,e,n,r=(()=>{})){return t.load(e,(t,o)=>{if(t)return this.send("error",t,n),void r(t);const{library:i,name:s}=a(e);o.isReady()?(o.isSubgraph()&&i===this.transport.options.namespace&&!this.transport.graph.graphs[e]&&this.transport.graph.registerGraph(e,o.network.graph,null,!1),this.sendComponent(e,o,n),r(null)):o.once("ready",()=>{o.isSubgraph()&&i===this.transport.options.namespace&&!this.transport.graph.graphs[s]&&this.transport.graph.registerGraph(e,o.network.graph,null,!1),this.sendComponent(e,o,n),r(null)})},!0)}processPort(t,e){const n={id:t,type:e.getDataType?e.getDataType():"all"};return("function"==typeof e.getSchema?e.getSchema():void 0)&&(n.schema=e.getSchema()),e.isRequired&&(n.required=e.isRequired()),e.isAddressable&&(n.addressable=e.isAddressable()),e.getDescription&&(n.description=e.getDescription()),(null!=e.options?e.options.values:void 0)&&(n.values=e.options.values),("function"==typeof e.hasDefault?e.hasDefault():void 0)&&(n.default=e.options.default),n}sendComponent(t,e,n){const r=[],o=[];Object.keys(e.inPorts).forEach(t=>{const n=e.inPorts[t];n&&"function"!=typeof n&&n.canAttach&&r.push(this.processPort(t,n))}),Object.keys(e.outPorts).forEach(t=>{const n=e.outPorts[t];n&&"function"!=typeof n&&n.canAttach&&o.push(this.processPort(t,n))});const i=e.getIcon?e.getIcon():"gear";this.send("component",{name:t,description:e.description,subgraph:e.isSubgraph(),icon:i,inPorts:r,outPorts:o},n)}registerGraph(t,e,n){const r=this.getLoader(e.baseDir,this.transport.options),i=o(()=>this.processComponent(r,t,n),10);r.listComponents(o=>{if(o)return void this.send("error",o,n);const{library:s,name:c}=a(t);r.registerComponent(s,c,e),i()}),e.on("addNode",i),e.on("removeNode",i),e.on("renameNode",i),e.on("addEdge",i),e.on("removeEdge",i),e.on("addInitial",i),e.on("removeInitial",i),e.on("addInport",i),e.on("removeInport",i),e.on("renameInport",i),e.on("addOutport",i),e.on("removeOutport",i),e.on("renameOutport",i)}}s.initClass(),t.exports=s},function(t,e){function n(t,e,n){var r,o,i,a,s;function c(){var u=Date.now()-a;u<e&&u>=0?r=setTimeout(c,e-u):(r=null,n||(s=t.apply(i,o),i=o=null))}null==e&&(e=100);var u=function(){i=this,o=arguments,a=Date.now();var u=n&&!r;return r||(r=setTimeout(c,e)),u&&(s=t.apply(i,o),i=o=null),s};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(s=t.apply(i,o),i=o=null,clearTimeout(r),r=null)},u}n.debounce=n,t.exports=n},function(t,e,n){const r=n(0),o=n(4)("noflo-runtime-base:trace"),i=n(119);let a=JSON.stringify;try{a=n(120)}catch(t){o("WARN: failed to load json-stringify-safe, circular objects may cause fail.\n"+t.message)}function s(t,e,n,o){const i={};return Object.keys(t.graph.outports).forEach(a=>{const s=t.graph.outports[a],c=r.internalSocket.createSocket();i[a]=c;const{component:u}=t.processes[s.process];u.outPorts[s.port].attach(c);n.forEach(t=>{c.on(t,(t=>function(n){const r={id:`EXPORT: ${e} ${a.toUpperCase()} ->`,payload:n,socket:{to:{process:{id:e},port:a}}};return o(t,r)})(t))})}),i}function c(t,e,n){o("event",t,e,`'${n.id}'`);const{socket:r}=n,i={protocol:"network",command:e,payload:{time:(new Date).toISOString(),graph:t,error:null,src:{node:null!=r.from?r.from.process.id:void 0,port:null!=r.from?r.from.port:void 0},tgt:{node:null!=r.to?r.to.process.id:void 0,port:null!=r.to?r.to.port:void 0},id:void 0,subgraph:void 0}},s=function(t){const e=t;try{e.group=n.group.toString()}catch(t){o("group serialization error",t),e.error=t.message}},c=i.payload;switch(e){case"connect":case"disconnect":break;case"begingroup":case"endgroup":s(i.payload);break;case"data":try{c.data=function(t){const e=a(t);return JSON.parse(e)}(n.data)}catch(t){o("data serialization error",t),c.error=t.message}break;default:throw new Error("trace: Unknown event type "+e)}return o("event done",t,e,`'${n.id}'`),i}t.exports.Tracer=class{constructor(t){this.options=t,this.buffer=new i,this.header={graphs:{}}}attach(t){const e=t.graph.name||t.graph.properties.name||"default";o("attach",e);const n=["connect","begingroup","data","endgroup","disconnect"];n.forEach(n=>t.on(n,t=>{const r=c(e,n,t);return this.buffer.add(r)})),s(t,e,n,(t,n)=>{const r=c(e,t,n);return this.buffer.add(r)}),this.header.graphs[e]=t.graph.toJSON()}detach(){}dumpString(t){const e=[];return this.buffer.getAll(t=>e.push(t),n=>{const r={header:this.header,events:e};return t(n,JSON.stringify(r,null,2))})}dumpFile(t,e){const r=n(3),i=n(121);let a=e=>r.open(t,"w",(n,r)=>e(n,{path:t,fd:r}));return t||(a=t=>i.open({suffix:".json"},t)),a((t,n)=>{if(t)return void e(t);let i=0;const a=(t,e)=>r.write(n.fd,t,{encoding:"utf-8"},e),s=function(t){let e=i?",":"";i+=1,e+=JSON.stringify(t,null,2),a(e,()=>{})};o("streaming to file",n.path);const c=JSON.stringify(this.header,null,2);a(`{\n "header": ${c}\n, "events":\n[`,t=>{t?e(t):this.buffer.getAll(s,t=>{t?e(t):(o(`streamed ${i} events`),a("]\n }",t=>{o("completed stream",n.path),e(t,n.path)}))})})})}}},function(t,e){t.exports=class{constructor(){this.events=[]}add(t){this.events.push(t)}getAll(t,e){this.events.forEach(e=>{t(e)}),e(null)}}},function(t,e){function n(t,e){var n=[],r=[];return null==e&&(e=function(t,e){return n[0]===e?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(e)).join(".")+"]"}),function(o,i){if(n.length>0){var a=n.indexOf(this);~a?n.splice(a+1):n.push(this),~a?r.splice(a,1/0,o):r.push(o),~n.indexOf(i)&&(i=e.call(this,o,i))}else n.push(i);return null==t?i:t.call(this,o,i)}}(t.exports=function(t,e,r,o){return JSON.stringify(t,n(e,o),r)}).getSerialize=n},function(t,e,n){(function(r){var o=n(3),i=n(5),a=n(122),s=n(123),c=n(132),u=s.sync,l=i.resolve(c.tmpdir()),p=a.O_CREAT|a.O_TRUNC|a.O_RDWR|a.O_EXCL,d=function(t){return"function"==typeof t?[void 0,t]:[new Promise((function(t,n){e=function(){var e=Array.from(arguments),o=e.shift();r.nextTick((function(){o?n(o):1===e.length?t(e[0]):t(e)}))}})),e];var e},f=function(t,e){var n=h(t,e),o=new Date,a=[n.prefix,o.getFullYear(),o.getMonth(),o.getDate(),"-",r.pid,"-",(4294967296*Math.random()+1).toString(36),n.suffix].join("");return i.join(n.dir||l,a)},h=function(t,e){var n={prefix:null,suffix:null};if(t)switch(typeof t){case"string":n.prefix=t;break;case"object":n=t;break;default:throw new Error("Unknown affix declaration: "+n)}else n.prefix=e;return n},m=!1,g=!1,v=[],y=[];function b(t){if(!m)return!1;E(),v.push(t)}function w(t){if(!m)return!1;E(),y.push(t)}function E(){if(!m)return!1;g||(r.addListener("exit",k),g=!0)}function k(){return!!m&&{files:function(){if(!m)return!1;for(var t,e=0;void 0!==(t=v.shift());)u(t),e++;return e}(),dirs:function(){if(!m)return!1;for(var t,e=0;void 0!==(t=y.shift());)u(t),e++;return e}()}}e.dir=l,e.track=function(e){return m=!1!==e,t.exports},e.mkdir=function(t,e){var n=d(e),r=n[0];e=n[1];var i=f(t,"d-");return o.mkdir(i,parseInt("0700",8),(function(t){t||w(i),e(t,i)})),r},e.mkdirSync=function(t){var e=f(t,"d-");return o.mkdirSync(e,parseInt("0700",8)),w(e),e},e.open=function(t,e){var n=d(e),r=n[0];e=n[1];var i=f(t,"f-");return o.open(i,p,parseInt("0600",8),(function(t,n){t||b(i),e(t,{path:i,fd:n})})),r},e.openSync=function(t){var e=f(t,"f-"),n=o.openSync(e,p,parseInt("0600",8));return b(e),{path:e,fd:n}},e.path=f,e.cleanup=function(t){var e=d(t),n=e[0];return t=e[1],m?(function(t){var e=d(t),n=e[0];if(t=e[1],!m)return t(new Error("not tracking")),n;var r,o=0,i=v.length;if(!i)return t(null,o),n;for(var a=function(e){if(i){if(e)return t(e),void(i=0);o++,--i||t(null,o)}};void 0!==(r=v.shift());)s(r,a)}((function(e,n){e?t(e,{files:n}):function(t){var e=d(t),n=e[0];if(t=e[1],!m)return t(new Error("not tracking")),n;var r,o=0,i=y.length;if(!i)return t(null,o),n;for(var a=function(e){if(i){if(e)return t(e,o),void(i=0);o++,--i||t(null,o)}};void 0!==(r=y.shift());)s(r,a)}((function(e,r){t(e,{files:n,dirs:r})}))})),n):(t(new Error("not tracking")),n)},e.cleanupSync=k,e.createWriteStream=function(t){var e=f(t,"s-"),n=o.createWriteStream(e,{flags:p,mode:parseInt("0600",8)});return b(e),n}}).call(this,n(1))},function(t){t.exports=JSON.parse('{"O_RDONLY":0,"O_WRONLY":1,"O_RDWR":2,"S_IFMT":61440,"S_IFREG":32768,"S_IFDIR":16384,"S_IFCHR":8192,"S_IFBLK":24576,"S_IFIFO":4096,"S_IFLNK":40960,"S_IFSOCK":49152,"O_CREAT":512,"O_EXCL":2048,"O_NOCTTY":131072,"O_TRUNC":1024,"O_APPEND":8,"O_DIRECTORY":1048576,"O_NOFOLLOW":256,"O_SYNC":128,"O_SYMLINK":2097152,"O_NONBLOCK":4,"S_IRWXU":448,"S_IRUSR":256,"S_IWUSR":128,"S_IXUSR":64,"S_IRWXG":56,"S_IRGRP":32,"S_IWGRP":16,"S_IXGRP":8,"S_IRWXO":7,"S_IROTH":4,"S_IWOTH":2,"S_IXOTH":1,"E2BIG":7,"EACCES":13,"EADDRINUSE":48,"EADDRNOTAVAIL":49,"EAFNOSUPPORT":47,"EAGAIN":35,"EALREADY":37,"EBADF":9,"EBADMSG":94,"EBUSY":16,"ECANCELED":89,"ECHILD":10,"ECONNABORTED":53,"ECONNREFUSED":61,"ECONNRESET":54,"EDEADLK":11,"EDESTADDRREQ":39,"EDOM":33,"EDQUOT":69,"EEXIST":17,"EFAULT":14,"EFBIG":27,"EHOSTUNREACH":65,"EIDRM":90,"EILSEQ":92,"EINPROGRESS":36,"EINTR":4,"EINVAL":22,"EIO":5,"EISCONN":56,"EISDIR":21,"ELOOP":62,"EMFILE":24,"EMLINK":31,"EMSGSIZE":40,"EMULTIHOP":95,"ENAMETOOLONG":63,"ENETDOWN":50,"ENETRESET":52,"ENETUNREACH":51,"ENFILE":23,"ENOBUFS":55,"ENODATA":96,"ENODEV":19,"ENOENT":2,"ENOEXEC":8,"ENOLCK":77,"ENOLINK":97,"ENOMEM":12,"ENOMSG":91,"ENOPROTOOPT":42,"ENOSPC":28,"ENOSR":98,"ENOSTR":99,"ENOSYS":78,"ENOTCONN":57,"ENOTDIR":20,"ENOTEMPTY":66,"ENOTSOCK":38,"ENOTSUP":45,"ENOTTY":25,"ENXIO":6,"EOPNOTSUPP":102,"EOVERFLOW":84,"EPERM":1,"EPIPE":32,"EPROTO":100,"EPROTONOSUPPORT":43,"EPROTOTYPE":41,"ERANGE":34,"EROFS":30,"ESPIPE":29,"ESRCH":3,"ESTALE":70,"ETIME":101,"ETIMEDOUT":60,"ETXTBSY":26,"EWOULDBLOCK":35,"EXDEV":18,"SIGHUP":1,"SIGINT":2,"SIGQUIT":3,"SIGILL":4,"SIGTRAP":5,"SIGABRT":6,"SIGIOT":6,"SIGBUS":10,"SIGFPE":8,"SIGKILL":9,"SIGUSR1":30,"SIGSEGV":11,"SIGUSR2":31,"SIGPIPE":13,"SIGALRM":14,"SIGTERM":15,"SIGCHLD":20,"SIGCONT":19,"SIGSTOP":17,"SIGTSTP":18,"SIGTTIN":21,"SIGTTOU":22,"SIGURG":16,"SIGXCPU":24,"SIGXFSZ":25,"SIGVTALRM":26,"SIGPROF":27,"SIGWINCH":28,"SIGIO":23,"SIGSYS":12,"SSL_OP_ALL":2147486719,"SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION":262144,"SSL_OP_CIPHER_SERVER_PREFERENCE":4194304,"SSL_OP_CISCO_ANYCONNECT":32768,"SSL_OP_COOKIE_EXCHANGE":8192,"SSL_OP_CRYPTOPRO_TLSEXT_BUG":2147483648,"SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS":2048,"SSL_OP_EPHEMERAL_RSA":0,"SSL_OP_LEGACY_SERVER_CONNECT":4,"SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER":32,"SSL_OP_MICROSOFT_SESS_ID_BUG":1,"SSL_OP_MSIE_SSLV2_RSA_PADDING":0,"SSL_OP_NETSCAPE_CA_DN_BUG":536870912,"SSL_OP_NETSCAPE_CHALLENGE_BUG":2,"SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG":1073741824,"SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG":8,"SSL_OP_NO_COMPRESSION":131072,"SSL_OP_NO_QUERY_MTU":4096,"SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION":65536,"SSL_OP_NO_SSLv2":16777216,"SSL_OP_NO_SSLv3":33554432,"SSL_OP_NO_TICKET":16384,"SSL_OP_NO_TLSv1":67108864,"SSL_OP_NO_TLSv1_1":268435456,"SSL_OP_NO_TLSv1_2":134217728,"SSL_OP_PKCS1_CHECK_1":0,"SSL_OP_PKCS1_CHECK_2":0,"SSL_OP_SINGLE_DH_USE":1048576,"SSL_OP_SINGLE_ECDH_USE":524288,"SSL_OP_SSLEAY_080_CLIENT_DH_BUG":128,"SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG":0,"SSL_OP_TLS_BLOCK_PADDING_BUG":512,"SSL_OP_TLS_D5_BUG":256,"SSL_OP_TLS_ROLLBACK_BUG":8388608,"ENGINE_METHOD_DSA":2,"ENGINE_METHOD_DH":4,"ENGINE_METHOD_RAND":8,"ENGINE_METHOD_ECDH":16,"ENGINE_METHOD_ECDSA":32,"ENGINE_METHOD_CIPHERS":64,"ENGINE_METHOD_DIGESTS":128,"ENGINE_METHOD_STORE":256,"ENGINE_METHOD_PKEY_METHS":512,"ENGINE_METHOD_PKEY_ASN1_METHS":1024,"ENGINE_METHOD_ALL":65535,"ENGINE_METHOD_NONE":0,"DH_CHECK_P_NOT_SAFE_PRIME":2,"DH_CHECK_P_NOT_PRIME":1,"DH_UNABLE_TO_CHECK_GENERATOR":4,"DH_NOT_SUITABLE_GENERATOR":8,"NPN_ENABLED":1,"RSA_PKCS1_PADDING":1,"RSA_SSLV23_PADDING":2,"RSA_NO_PADDING":3,"RSA_PKCS1_OAEP_PADDING":4,"RSA_X931_PADDING":5,"RSA_PKCS1_PSS_PADDING":6,"POINT_CONVERSION_COMPRESSED":2,"POINT_CONVERSION_UNCOMPRESSED":4,"POINT_CONVERSION_HYBRID":6,"F_OK":0,"R_OK":4,"W_OK":2,"X_OK":1,"UV_UDP_REUSEADDR":4}')},function(t,e,n){(function(e){t.exports=d,d.sync=v;var r=n(16),o=n(5),i=n(3),a=n(30),s=parseInt("666",8),c={nosort:!0,silent:!0},u=0,l="win32"===e.platform;function p(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach((function(e){t[e]=t[e]||i[e],t[e+="Sync"]=t[e]||i[e]})),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,!1===t.glob&&(t.disableGlob=!0),t.disableGlob=t.disableGlob||!1,t.glob=t.glob||c}function d(t,e,n){"function"==typeof e&&(n=e,e={}),r(t,"rimraf: missing path"),r.equal(typeof t,"string","rimraf: path should be a string"),r.equal(typeof n,"function","rimraf: callback function required"),r(e,"rimraf: invalid options argument provided"),r.equal(typeof e,"object","rimraf: options should be object"),p(e);var o=0,i=null,s=0;if(e.disableGlob||!a.hasMagic(t))return c(null,[t]);function c(t,r){return t?n(t):0===(s=r.length)?n():void r.forEach((function(t){f(t,e,(function r(a){if(a){if(("EBUSY"===a.code||"ENOTEMPTY"===a.code||"EPERM"===a.code)&&o<e.maxBusyTries)return o++,setTimeout((function(){f(t,e,r)}),100*o);if("EMFILE"===a.code&&u<e.emfileWait)return setTimeout((function(){f(t,e,r)}),u++);"ENOENT"===a.code&&(a=null)}u=0,function(t){i=i||t,0==--s&&n(i)}(a)}))}))}e.lstat(t,(function(n,r){if(!n)return c(null,[t]);a(t,e.glob,c)}))}function f(t,e,n){r(t),r(e),r("function"==typeof n),e.lstat(t,(function(r,o){return r&&"ENOENT"===r.code?n(null):(r&&"EPERM"===r.code&&l&&h(t,e,r,n),o&&o.isDirectory()?g(t,e,r,n):void e.unlink(t,(function(r){if(r){if("ENOENT"===r.code)return n(null);if("EPERM"===r.code)return l?h(t,e,r,n):g(t,e,r,n);if("EISDIR"===r.code)return g(t,e,r,n)}return n(r)})))}))}function h(t,e,n,o){r(t),r(e),r("function"==typeof o),n&&r(n instanceof Error),e.chmod(t,s,(function(r){r?o("ENOENT"===r.code?null:n):e.stat(t,(function(r,i){r?o("ENOENT"===r.code?null:n):i.isDirectory()?g(t,e,n,o):e.unlink(t,o)}))}))}function m(t,e,n){r(t),r(e),n&&r(n instanceof Error);try{e.chmodSync(t,s)}catch(t){if("ENOENT"===t.code)return;throw n}try{var o=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw n}o.isDirectory()?y(t,e,n):e.unlinkSync(t)}function g(t,e,n,i){r(t),r(e),n&&r(n instanceof Error),r("function"==typeof i),e.rmdir(t,(function(a){!a||"ENOTEMPTY"!==a.code&&"EEXIST"!==a.code&&"EPERM"!==a.code?a&&"ENOTDIR"===a.code?i(n):i(a):function(t,e,n){r(t),r(e),r("function"==typeof n),e.readdir(t,(function(r,i){if(r)return n(r);var a,s=i.length;if(0===s)return e.rmdir(t,n);i.forEach((function(r){d(o.join(t,r),e,(function(r){if(!a)return r?n(a=r):void(0==--s&&e.rmdir(t,n))}))}))}))}(t,e,i)}))}function v(t,e){var n;if(p(e=e||{}),r(t,"rimraf: missing path"),r.equal(typeof t,"string","rimraf: path should be a string"),r(e,"rimraf: missing options"),r.equal(typeof e,"object","rimraf: options should be object"),e.disableGlob||!a.hasMagic(t))n=[t];else try{e.lstatSync(t),n=[t]}catch(r){n=a.sync(t,e.glob)}if(n.length)for(var o=0;o<n.length;o++){t=n[o];try{var i=e.lstatSync(t)}catch(n){if("ENOENT"===n.code)return;"EPERM"===n.code&&l&&m(t,e,n)}try{i&&i.isDirectory()?y(t,e,null):e.unlinkSync(t)}catch(n){if("ENOENT"===n.code)return;if("EPERM"===n.code)return l?m(t,e,n):y(t,e,n);if("EISDIR"!==n.code)throw n;y(t,e,n)}}}function y(t,e,n){r(t),r(e),n&&r(n instanceof Error);try{e.rmdirSync(t)}catch(i){if("ENOENT"===i.code)return;if("ENOTDIR"===i.code)throw n;"ENOTEMPTY"!==i.code&&"EEXIST"!==i.code&&"EPERM"!==i.code||function(t,e){r(t),r(e),e.readdirSync(t).forEach((function(n){v(o.join(t,n),e)}));var n=l?100:1,i=0;for(;;){var a=!0;try{var s=e.rmdirSync(t,e);return a=!1,s}finally{if(++i<n&&a)continue}}}(t,e)}}}).call(this,n(1))},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,c=a(t),u=1;u<arguments.length;u++){for(var l in n=Object(arguments[u]))o.call(n,l)&&(c[l]=n[l]);if(r){s=r(n);for(var p=0;p<s.length;p++)i.call(n,s[p])&&(c[s[p]]=n[s[p]])}}return c}},function(t,e,n){(function(t){var r=n(5),o="win32"===t.platform,i=n(3),a=t.env.NODE_DEBUG&&/fs/.test(t.env.NODE_DEBUG);function s(e){return"function"==typeof e?e:function(){var e;if(a){var n=new Error;e=function(t){t&&(n.message=t.message,r(t=n))}}else e=r;return e;function r(e){if(e){if(t.throwDeprecation)throw e;if(!t.noDeprecation){var n="fs: missing callback "+(e.stack||e.message);t.traceDeprecation?console.trace(n):console.error(n)}}}}()}r.normalize;if(o)var c=/(.*?)(?:[\/\\]+|$)/g;else c=/(.*?)(?:[\/]+|$)/g;if(o)var u=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else u=/^[\/]*/;e.realpathSync=function(t,e){if(t=r.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var n,a,s,l,p=t,d={},f={};function h(){var e=u.exec(t);n=e[0].length,a=e[0],s=e[0],l="",o&&!f[s]&&(i.lstatSync(s),f[s]=!0)}for(h();n<t.length;){c.lastIndex=n;var m=c.exec(t);if(l=a,a+=m[0],s=l+m[1],n=c.lastIndex,!(f[s]||e&&e[s]===s)){var g;if(e&&Object.prototype.hasOwnProperty.call(e,s))g=e[s];else{var v=i.lstatSync(s);if(!v.isSymbolicLink()){f[s]=!0,e&&(e[s]=s);continue}var y=null;if(!o){var b=v.dev.toString(32)+":"+v.ino.toString(32);d.hasOwnProperty(b)&&(y=d[b])}null===y&&(i.statSync(s),y=i.readlinkSync(s)),g=r.resolve(l,y),e&&(e[s]=g),o||(d[b]=y)}t=r.resolve(g,t.slice(n)),h()}}return e&&(e[p]=t),t},e.realpath=function(e,n,a){if("function"!=typeof a&&(a=s(n),n=null),e=r.resolve(e),n&&Object.prototype.hasOwnProperty.call(n,e))return t.nextTick(a.bind(null,null,n[e]));var l,p,d,f,h=e,m={},g={};function v(){var n=u.exec(e);l=n[0].length,p=n[0],d=n[0],f="",o&&!g[d]?i.lstat(d,(function(t){if(t)return a(t);g[d]=!0,y()})):t.nextTick(y)}function y(){if(l>=e.length)return n&&(n[h]=e),a(null,e);c.lastIndex=l;var r=c.exec(e);return f=p,p+=r[0],d=f+r[1],l=c.lastIndex,g[d]||n&&n[d]===d?t.nextTick(y):n&&Object.prototype.hasOwnProperty.call(n,d)?E(n[d]):i.lstat(d,b)}function b(e,r){if(e)return a(e);if(!r.isSymbolicLink())return g[d]=!0,n&&(n[d]=d),t.nextTick(y);if(!o){var s=r.dev.toString(32)+":"+r.ino.toString(32);if(m.hasOwnProperty(s))return w(null,m[s],d)}i.stat(d,(function(t){if(t)return a(t);i.readlink(d,(function(t,e){o||(m[s]=e),w(t,e)}))}))}function w(t,e,o){if(t)return a(t);var i=r.resolve(f,e);n&&(n[o]=i),E(i)}function E(t){e=r.resolve(t,e.slice(l)),v()}v()}}).call(this,n(1))},function(t,e,n){var r=n(127),o=n(128);t.exports=function(t){if(!t)return[];"{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2));return function t(e,n){var i=[],a=o("{","}",e);if(!a||/\$$/.test(a.pre))return[e];var c,u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(a.body),p=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(a.body),g=u||p,v=a.body.indexOf(",")>=0;if(!g&&!v)return a.post.match(/,.*\}/)?(e=a.pre+"{"+a.body+s+a.post,t(e)):[e];if(g)c=a.body.split(/\.\./);else{if(1===(c=function t(e){if(!e)return[""];var n=[],r=o("{","}",e);if(!r)return e.split(",");var i=r.pre,a=r.body,s=r.post,c=i.split(",");c[c.length-1]+="{"+a+"}";var u=t(s);s.length&&(c[c.length-1]+=u.shift(),c.push.apply(c,u));return n.push.apply(n,c),n}(a.body)).length)if(1===(c=t(c[0],!1).map(d)).length)return(w=a.post.length?t(a.post,!1):[""]).map((function(t){return a.pre+c[0]+t}))}var y,b=a.pre,w=a.post.length?t(a.post,!1):[""];if(g){var E=l(c[0]),k=l(c[1]),S=Math.max(c[0].length,c[1].length),P=3==c.length?Math.abs(l(c[2])):1,O=h;k<E&&(P*=-1,O=m);var _=c.some(f);y=[];for(var C=E;O(C,k);C+=P){var A;if(p)"\\"===(A=String.fromCharCode(C))&&(A="");else if(A=String(C),_){var x=S-A.length;if(x>0){var I=new Array(x+1).join("0");A=C<0?"-"+I+A.slice(1):I+A}}y.push(A)}}else y=r(c,(function(e){return t(e,!1)}));for(var D=0;D<y.length;D++)for(var N=0;N<w.length;N++){var R=b+y[D]+w[N];(!n||g||R)&&i.push(R)}return i}(function(t){return t.split("\\\\").join(i).split("\\{").join(a).split("\\}").join(s).split("\\,").join(c).split("\\.").join(u)}(t),!0).map(p)};var i="\0SLASH"+Math.random()+"\0",a="\0OPEN"+Math.random()+"\0",s="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function l(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function p(t){return t.split(i).join("\\").split(a).join("{").split(s).join("}").split(c).join(",").split(u).join(".")}function d(t){return"{"+t+"}"}function f(t){return/^-?0\d/.test(t)}function h(t,e){return t<=e}function m(t,e){return t>=e}},function(t,e){t.exports=function(t,e){for(var r=[],o=0;o<t.length;o++){var i=e(t[o],o);n(i)?r.push.apply(r,i):r.push(i)}return r};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function r(t,e,n){t instanceof RegExp&&(t=o(t,n)),e instanceof RegExp&&(e=o(e,n));var r=i(t,e,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+t.length,r[1]),post:n.slice(r[1]+e.length)}}function o(t,e){var n=e.match(t);return n?n[0]:null}function i(t,e,n){var r,o,i,a,s,c=n.indexOf(t),u=n.indexOf(e,c+1),l=c;if(c>=0&&u>0){for(r=[],i=n.length;l>=0&&!s;)l==c?(r.push(l),c=n.indexOf(t,l+1)):1==r.length?s=[r.pop(),u]:((o=r.pop())<i&&(i=o,a=u),u=n.indexOf(e,l+1)),l=c<u&&c>=0?c:u;r.length&&(s=[i,a])}return s}t.exports=r,r.range=i},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},function(t,e,n){(function(e){t.exports=h,h.GlobSync=m;var r=n(3),o=n(31),i=n(17),a=(i.Minimatch,n(30).Glob,n(9),n(5)),s=n(16),c=n(18),u=n(32),l=(u.alphasort,u.alphasorti,u.setopts),p=u.ownProp,d=u.childrenIgnored,f=u.isIgnored;function h(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new m(t,e).found}function m(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof m))return new m(t,e);if(l(this,t,e),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var r=0;r<n;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}m.prototype._finish=function(){if(s(this instanceof m),this.realpath){var t=this;this.matches.forEach((function(e,n){var r=t.matches[n]=Object.create(null);for(var i in e)try{i=t._makeAbs(i),r[o.realpathSync(i,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;r[t._makeAbs(i)]=!0}}))}u.finish(this)},m.prototype._process=function(t,e,n){s(this instanceof m);for(var r,o=0;"string"==typeof t[o];)o++;switch(o){case t.length:return void this._processSimple(t.join("/"),e);case 0:r=null;break;default:r=t.slice(0,o).join("/")}var a,u=t.slice(o);null===r?a=".":c(r)||c(t.join("/"))?(r&&c(r)||(r="/"+r),a=r):a=r;var l=this._makeAbs(a);d(this,a)||(u[0]===i.GLOBSTAR?this._processGlobStar(r,a,l,u,e,n):this._processReaddir(r,a,l,u,e,n))},m.prototype._processReaddir=function(t,e,n,r,o,i){var s=this._readdir(n,i);if(s){for(var c=r[0],u=!!this.minimatch.negate,l=c._glob,p=this.dot||"."===l.charAt(0),d=[],f=0;f<s.length;f++){if("."!==(g=s[f]).charAt(0)||p)(u&&!t?!g.match(c):g.match(c))&&d.push(g)}var h=d.length;if(0!==h)if(1!==r.length||this.mark||this.stat){r.shift();for(f=0;f<h;f++){var m;g=d[f];m=t?[t,g]:[g],this._process(m.concat(r),o,i)}}else{this.matches[o]||(this.matches[o]=Object.create(null));for(var f=0;f<h;f++){var g=d[f];t&&(g="/"!==t.slice(-1)?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=a.join(this.root,g)),this._emitMatch(o,g)}}}},m.prototype._emitMatch=function(t,e){if(!f(this,e)){var n=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=n),!this.matches[t][e]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},m.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,n;try{n=r.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var o=n&&n.isSymbolicLink();return this.symlinks[t]=o,o||!n||n.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},m.prototype._readdir=function(t,e){if(e&&!p(this.symlinks,t))return this._readdirInGlobStar(t);if(p(this.cache,t)){var n=this.cache[t];if(!n||"FILE"===n)return null;if(Array.isArray(n))return n}try{return this._readdirEntries(t,r.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},m.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var r=e[n];r="/"===t?t+r:t+"/"+r,this.cache[r]=!0}return this.cache[t]=e,e},m.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var r=new Error(e.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=e.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},m.prototype._processGlobStar=function(t,e,n,r,o,i){var a=this._readdir(n,i);if(a){var s=r.slice(1),c=t?[t]:[],u=c.concat(s);this._process(u,o,!1);var l=a.length;if(!this.symlinks[n]||!i)for(var p=0;p<l;p++){if("."!==a[p].charAt(0)||this.dot){var d=c.concat(a[p],s);this._process(d,o,!0);var f=c.concat(a[p],r);this._process(f,o,!0)}}}},m.prototype._processSimple=function(t,n){var r=this._stat(t);if(this.matches[n]||(this.matches[n]=Object.create(null)),r){if(t&&c(t)&&!this.nomount){var o=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=a.join(this.root,t):(t=a.resolve(this.root,t),o&&(t+="/"))}"win32"===e.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(n,t)}},m.prototype._stat=function(t){var e=this._makeAbs(t),n="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&p(this.cache,e)){var o=this.cache[e];if(Array.isArray(o)&&(o="DIR"),!n||"DIR"===o)return o;if(n&&"FILE"===o)return!1}var i=this.statCache[e];if(!i){var a;try{a=r.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(a&&a.isSymbolicLink())try{i=r.statSync(e)}catch(t){i=a}else i=a}this.statCache[e]=i;o=!0;return i&&(o=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||o,(!n||"FILE"!==o)&&o},m.prototype._mark=function(t){return u.mark(this,t)},m.prototype._makeAbs=function(t){return u.makeAbs(this,t)}}).call(this,n(1))},function(t,e,n){(function(e){var r=n(33),o=Object.create(null),i=n(34);function a(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r]=t[r];return n}t.exports=r((function(t,n){return o[t]?(o[t].push(n),null):(o[t]=[n],function(t){return i((function n(){var r=o[t],i=r.length,s=a(arguments);try{for(var c=0;c<i;c++)r[c].apply(null,s)}finally{r.length>i?(r.splice(0,i),e.nextTick((function(){n.apply(null,s)}))):delete o[t]}}))}(t))}))}).call(this,n(1))},function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!=typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}},function(t,e,n){const r=n(134),o=n(135);e.Client=r,e.Runtime=o},function(t,e,n){const{EventEmitter:r}=n(2);t.exports=class extends r{constructor(t,e){super(),this.name=e,this.runtime=t,this.name||(this.name="Unnamed client")}connect(){return this.runtime._connect(this)}disconnect(){return this.runtime._disconnect(this)}send(t,e,n){const r={protocol:t,command:e,payload:n};return this.emit("send",r)}_receive(t){return setTimeout(()=>this.emit("message",t),1)}}},function(t,e,n){const r=n(29);t.exports=class extends r{constructor(t){super(t),this.clients=[]}_connect(t){this.clients.push(t),t.on("send",e=>{this._receive(e,{client:t})})}_disconnect(t){-1!==this.clients.indexOf(t)&&(this.clients.splice(this.clients.indexOf(t),1),t.removeAllListeners("send"))}_receive(t,e){this.receive(t.protocol,t.command,t.payload,e)}send(t,e,n,r){if(!r||!r.client)return;const o={protocol:t,command:e,payload:n};r.client._receive(o)}sendAll(t,e,n){const r={protocol:t,command:e,payload:n};this.clients.forEach(t=>{t._receive(r)})}}},function(t,e,n){const r=n(14),o=n(35);class i extends r{constructor(t){super(t),this.setClient(window.parent)}}t.exports=function(t){const e=o.normalizeOptions(t),n=new i(e);return o.subscribe(window,(t,e)=>{"iframe"!==t.protocol||"setcontent"!==t.command?n.receive(t.protocol,t.command,t.payload,{href:e.origin}):document.body.innerHTML=t.payload}),n}},function(t,e,n){const r=n(14),o=n(35);class i extends r{constructor(t,e){super(t),e&&e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.openClient(e.getAttribute("href"))})}openClient(t){const e=window.open(t,"_blank");if(!e)throw new Error(`Unable to open client window at '${t}'`);this.context={href:"*"};const n=function(t){let{data:e}=t;"string"==typeof t.data&&(e=JSON.parse(t.data)),e.protocol&&e.command&&this.receive(e.protocol,e.command,e.payload,this.context)}.bind(this),r=setInterval(()=>{e&&!e.closed||(this.setClient(null),window.removeEventListener("message",n),clearInterval(r))},1e3);this.setClient(e),window.addEventListener("message",n)}}t.exports=function(t,e){const n=o.normalizeOptions(t);return new i(n,e)}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){const r=n(140),o=n(144),i=n(148),a=n(36);document.addEventListener("DOMContentLoaded",()=>{o(a,{runtimeOptions:{baseDir:i.name,label:i.name,namespace:i.name,repository:i.repository?i.repository.url:null,id:r(window.location.href)},debugButton:document.getElementById("flowhub_debug_url")}).catch(t=>{const e=document.querySelector("body p");e.innerHTML="ERROR: "+t.message,e.parentElement.classList.add("error")})})},function(t,e,n){var r=n(141),o=new Uint8Array(0);t.exports=function t(e,n,i){if("string"!=typeof e)throw TypeError("Value must be string");if("number"==typeof n)return t(e,void 0,n);if(null==i)return t(e,n,5);if(3!==i&&5!==i)throw TypeError("Version of UUID can be only 3 or 5");var a=r.stringToCharBuffer(e),s="string"==typeof n?r.stringToCharBuffer(n):o,c=r.concatBuffers(s,a),u=3===i?r.md5Hash(c):r.sha1Hash(c);return r.hashToUuid(u,i)}},function(t,e,n){var r=n(142),o=n(143),i="0123456789abcdef".split(""),a=function(t){var e=t>>4,n=t-(e<<4);return i[e]+i[n]},s=function(t){for(var e=[],n=0;n<t.length;n++)e.push(a(t[n]));return e.join("")};t.exports={uint8ToHex:a,uint8ArrayToHex:s,stringToCharBuffer:function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t[n].charCodeAt(0);return e},md5Hash:function(t){return new Uint8Array(r.arrayBuffer(t))},sha1Hash:function(t){return new Uint8Array(o.arrayBuffer(t))},concatBuffers:function(t,e){var n=new Uint8Array(t.length+e.length);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n},hashToUuid:function(t,e){return[s(t.slice(0,4)),"-",s(t.slice(4,6)),"-",a(15&t[6]|parseInt(10*e,16)),a(t[7]),"-",a(63&t[8]|128),a(t[9]),"-",s(t.slice(10,16))].join("")}}},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;
/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.7.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(138),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t){return function(e){return new Md5(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Md5},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createOutputMethod(n)}return t},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("md5").update(t,"utf8").digest("hex");if(null==t)throw ERROR;return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer?crypto.createHash("md5").update(new Buffer(t)).digest("hex"):method(t)};return nodeMethod};function Md5(t){if(t)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var e=new ArrayBuffer(68);this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(t){if(!this.finalized){var e,n=typeof t;if("string"!==n){if("object"!==n)throw ERROR;if(null===t)throw ERROR;if(ARRAY_BUFFER&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||ARRAY_BUFFER&&ArrayBuffer.isView(t)))throw ERROR;e=!0}for(var r,o,i=0,a=t.length,s=this.blocks,c=this.buffer8;i<a;){if(this.hashed&&(this.hashed=!1,s[0]=s[16],s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),e)if(ARRAY_BUFFER)for(o=this.start;i<a&&o<64;++i)c[o++]=t[i];else for(o=this.start;i<a&&o<64;++i)s[o>>2]|=t[i]<<SHIFT[3&o++];else if(ARRAY_BUFFER)for(o=this.start;i<a&&o<64;++i)(r=t.charCodeAt(i))<128?c[o++]=r:r<2048?(c[o++]=192|r>>6,c[o++]=128|63&r):r<55296||r>=57344?(c[o++]=224|r>>12,c[o++]=128|r>>6&63,c[o++]=128|63&r):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++i)),c[o++]=240|r>>18,c[o++]=128|r>>12&63,c[o++]=128|r>>6&63,c[o++]=128|63&r);else for(o=this.start;i<a&&o<64;++i)(r=t.charCodeAt(i))<128?s[o>>2]|=r<<SHIFT[3&o++]:r<2048?(s[o>>2]|=(192|r>>6)<<SHIFT[3&o++],s[o>>2]|=(128|63&r)<<SHIFT[3&o++]):r<55296||r>=57344?(s[o>>2]|=(224|r>>12)<<SHIFT[3&o++],s[o>>2]|=(128|r>>6&63)<<SHIFT[3&o++],s[o>>2]|=(128|63&r)<<SHIFT[3&o++]):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++i)),s[o>>2]|=(240|r>>18)<<SHIFT[3&o++],s[o>>2]|=(128|r>>12&63)<<SHIFT[3&o++],s[o>>2]|=(128|r>>6&63)<<SHIFT[3&o++],s[o>>2]|=(128|63&r)<<SHIFT[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[e>>2]|=EXTRA[3&e],e>=56&&(this.hashed||this.hash(),t[0]=t[16],t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.bytes<<3,t[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var t,e,n,r,o,i,a=this.blocks;this.first?e=((e=((t=((t=a[0]-680876937)<<7|t>>>25)-271733879<<0)^(n=((n=(-271733879^(r=((r=(-1732584194^2004318071&t)+a[1]-117830708)<<12|r>>>20)+t<<0)&(-271733879^t))+a[2]-1126478375)<<17|n>>>15)+r<<0)&(r^t))+a[3]-1316259209)<<22|e>>>10)+n<<0:(t=this.h0,e=this.h1,n=this.h2,e=((e+=((t=((t+=((r=this.h3)^e&(n^r))+a[0]-680876936)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+a[1]-389564586)<<12|r>>>20)+t<<0)&(t^e))+a[2]+606105819)<<17|n>>>15)+r<<0)&(r^t))+a[3]-1044525330)<<22|e>>>10)+n<<0),e=((e+=((t=((t+=(r^e&(n^r))+a[4]-176418897)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+a[5]+1200080426)<<12|r>>>20)+t<<0)&(t^e))+a[6]-1473231341)<<17|n>>>15)+r<<0)&(r^t))+a[7]-45705983)<<22|e>>>10)+n<<0,e=((e+=((t=((t+=(r^e&(n^r))+a[8]+1770035416)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+a[9]-1958414417)<<12|r>>>20)+t<<0)&(t^e))+a[10]-42063)<<17|n>>>15)+r<<0)&(r^t))+a[11]-1990404162)<<22|e>>>10)+n<<0,e=((e+=((t=((t+=(r^e&(n^r))+a[12]+1804603682)<<7|t>>>25)+e<<0)^(n=((n+=(e^(r=((r+=(n^t&(e^n))+a[13]-40341101)<<12|r>>>20)+t<<0)&(t^e))+a[14]-1502002290)<<17|n>>>15)+r<<0)&(r^t))+a[15]+1236535329)<<22|e>>>10)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+a[1]-165796510)<<5|t>>>27)+e<<0)^e))+a[6]-1069501632)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+a[11]+643717713)<<14|n>>>18)+r<<0)^r))+a[0]-373897302)<<20|e>>>12)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+a[5]-701558691)<<5|t>>>27)+e<<0)^e))+a[10]+38016083)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+a[15]-660478335)<<14|n>>>18)+r<<0)^r))+a[4]-405537848)<<20|e>>>12)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+a[9]+568446438)<<5|t>>>27)+e<<0)^e))+a[14]-1019803690)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+a[3]-187363961)<<14|n>>>18)+r<<0)^r))+a[8]+1163531501)<<20|e>>>12)+n<<0,e=((e+=((r=((r+=(e^n&((t=((t+=(n^r&(e^n))+a[13]-1444681467)<<5|t>>>27)+e<<0)^e))+a[2]-51403784)<<9|r>>>23)+t<<0)^t&((n=((n+=(t^e&(r^t))+a[7]+1735328473)<<14|n>>>18)+r<<0)^r))+a[12]-1926607734)<<20|e>>>12)+n<<0,e=((e+=((i=(r=((r+=((o=e^n)^(t=((t+=(o^r)+a[5]-378558)<<4|t>>>28)+e<<0))+a[8]-2022574463)<<11|r>>>21)+t<<0)^t)^(n=((n+=(i^e)+a[11]+1839030562)<<16|n>>>16)+r<<0))+a[14]-35309556)<<23|e>>>9)+n<<0,e=((e+=((i=(r=((r+=((o=e^n)^(t=((t+=(o^r)+a[1]-1530992060)<<4|t>>>28)+e<<0))+a[4]+1272893353)<<11|r>>>21)+t<<0)^t)^(n=((n+=(i^e)+a[7]-155497632)<<16|n>>>16)+r<<0))+a[10]-1094730640)<<23|e>>>9)+n<<0,e=((e+=((i=(r=((r+=((o=e^n)^(t=((t+=(o^r)+a[13]+681279174)<<4|t>>>28)+e<<0))+a[0]-358537222)<<11|r>>>21)+t<<0)^t)^(n=((n+=(i^e)+a[3]-722521979)<<16|n>>>16)+r<<0))+a[6]+76029189)<<23|e>>>9)+n<<0,e=((e+=((i=(r=((r+=((o=e^n)^(t=((t+=(o^r)+a[9]-640364487)<<4|t>>>28)+e<<0))+a[12]-421815835)<<11|r>>>21)+t<<0)^t)^(n=((n+=(i^e)+a[15]+530742520)<<16|n>>>16)+r<<0))+a[2]-995338651)<<23|e>>>9)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+a[0]-198630844)<<6|t>>>26)+e<<0)|~n))+a[7]+1126891415)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+a[14]-1416354905)<<15|n>>>17)+r<<0)|~t))+a[5]-57434055)<<21|e>>>11)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+a[12]+1700485571)<<6|t>>>26)+e<<0)|~n))+a[3]-1894986606)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+a[10]-1051523)<<15|n>>>17)+r<<0)|~t))+a[1]-2054922799)<<21|e>>>11)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+a[8]+1873313359)<<6|t>>>26)+e<<0)|~n))+a[15]-30611744)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+a[6]-1560198380)<<15|n>>>17)+r<<0)|~t))+a[13]+1309151649)<<21|e>>>11)+n<<0,e=((e+=((r=((r+=(e^((t=((t+=(n^(e|~r))+a[4]-145523070)<<6|t>>>26)+e<<0)|~n))+a[11]-1120210379)<<10|r>>>22)+t<<0)^((n=((n+=(t^(r|~e))+a[2]+718787259)<<15|n>>>17)+r<<0)|~t))+a[9]-343485551)<<21|e>>>11)+n<<0,this.first?(this.h0=t+1732584193<<0,this.h1=e-271733879<<0,this.h2=n-1732584194<<0,this.h3=r+271733878<<0,this.first=!1):(this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0)},Md5.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3;return HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(16),e=new Uint32Array(t);return e[0]=this.h0,e[1]=this.h1,e[2]=this.h2,e[3]=this.h3,t},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var t,e,n,r="",o=this.array(),i=0;i<15;)t=o[i++],e=o[i++],n=o[i++],r+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[63&(t<<4|e>>>4)]+BASE64_ENCODE_CHAR[63&(e<<2|n>>>6)]+BASE64_ENCODE_CHAR[63&n];return t=o[i],r+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[t<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(1),__webpack_require__(8))},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;
/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */!function(){"use strict";var root="object"==typeof window?window:{},NODE_JS=!root.JS_SHA1_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS&&(root=global);var COMMON_JS=!root.JS_SHA1_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(138),HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[],createOutputMethod=function(t){return function(e){return new Sha1(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Sha1},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createOutputMethod(n)}return t},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("sha1").update(t,"utf8").digest("hex");if(t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(void 0===t.length)return method(t);return crypto.createHash("sha1").update(new Buffer(t)).digest("hex")};return nodeMethod};function Sha1(t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(t){if(!this.finalized){var e="string"!=typeof t;e&&t.constructor===root.ArrayBuffer&&(t=new Uint8Array(t));for(var n,r,o=0,i=t.length||0,a=this.blocks;o<i;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)for(r=this.start;o<i&&r<64;++o)a[r>>2]|=t[o]<<SHIFT[3&r++];else for(r=this.start;o<i&&r<64;++o)(n=t.charCodeAt(o))<128?a[r>>2]|=n<<SHIFT[3&r++]:n<2048?(a[r>>2]|=(192|n>>6)<<SHIFT[3&r++],a[r>>2]|=(128|63&n)<<SHIFT[3&r++]):n<55296||n>=57344?(a[r>>2]|=(224|n>>12)<<SHIFT[3&r++],a[r>>2]|=(128|n>>6&63)<<SHIFT[3&r++],a[r>>2]|=(128|63&n)<<SHIFT[3&r++]):(n=65536+((1023&n)<<10|1023&t.charCodeAt(++o)),a[r>>2]|=(240|n>>18)<<SHIFT[3&r++],a[r>>2]|=(128|n>>12&63)<<SHIFT[3&r++],a[r>>2]|=(128|n>>6&63)<<SHIFT[3&r++],a[r>>2]|=(128|63&n)<<SHIFT[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.block=a[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=EXTRA[3&e],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},Sha1.prototype.hash=function(){var t,e,n=this.h0,r=this.h1,o=this.h2,i=this.h3,a=this.h4,s=this.blocks;for(t=16;t<80;++t)e=s[t-3]^s[t-8]^s[t-14]^s[t-16],s[t]=e<<1|e>>>31;for(t=0;t<20;t+=5)n=(e=(r=(e=(o=(e=(i=(e=(a=(e=n<<5|n>>>27)+(r&o|~r&i)+a+1518500249+s[t]<<0)<<5|a>>>27)+(n&(r=r<<30|r>>>2)|~n&o)+i+1518500249+s[t+1]<<0)<<5|i>>>27)+(a&(n=n<<30|n>>>2)|~a&r)+o+1518500249+s[t+2]<<0)<<5|o>>>27)+(i&(a=a<<30|a>>>2)|~i&n)+r+1518500249+s[t+3]<<0)<<5|r>>>27)+(o&(i=i<<30|i>>>2)|~o&a)+n+1518500249+s[t+4]<<0,o=o<<30|o>>>2;for(;t<40;t+=5)n=(e=(r=(e=(o=(e=(i=(e=(a=(e=n<<5|n>>>27)+(r^o^i)+a+1859775393+s[t]<<0)<<5|a>>>27)+(n^(r=r<<30|r>>>2)^o)+i+1859775393+s[t+1]<<0)<<5|i>>>27)+(a^(n=n<<30|n>>>2)^r)+o+1859775393+s[t+2]<<0)<<5|o>>>27)+(i^(a=a<<30|a>>>2)^n)+r+1859775393+s[t+3]<<0)<<5|r>>>27)+(o^(i=i<<30|i>>>2)^a)+n+1859775393+s[t+4]<<0,o=o<<30|o>>>2;for(;t<60;t+=5)n=(e=(r=(e=(o=(e=(i=(e=(a=(e=n<<5|n>>>27)+(r&o|r&i|o&i)+a-1894007588+s[t]<<0)<<5|a>>>27)+(n&(r=r<<30|r>>>2)|n&o|r&o)+i-1894007588+s[t+1]<<0)<<5|i>>>27)+(a&(n=n<<30|n>>>2)|a&r|n&r)+o-1894007588+s[t+2]<<0)<<5|o>>>27)+(i&(a=a<<30|a>>>2)|i&n|a&n)+r-1894007588+s[t+3]<<0)<<5|r>>>27)+(o&(i=i<<30|i>>>2)|o&a|i&a)+n-1894007588+s[t+4]<<0,o=o<<30|o>>>2;for(;t<80;t+=5)n=(e=(r=(e=(o=(e=(i=(e=(a=(e=n<<5|n>>>27)+(r^o^i)+a-899497514+s[t]<<0)<<5|a>>>27)+(n^(r=r<<30|r>>>2)^o)+i-899497514+s[t+1]<<0)<<5|i>>>27)+(a^(n=n<<30|n>>>2)^r)+o-899497514+s[t+2]<<0)<<5|o>>>27)+(i^(a=a<<30|a>>>2)^n)+r-899497514+s[t+3]<<0)<<5|r>>>27)+(o^(i=i<<30|i>>>2)^a)+n-899497514+s[t+4]<<0,o=o<<30|o>>>2;this.h0=this.h0+n<<0,this.h1=this.h1+r<<0,this.h2=this.h2+o<<0,this.h3=this.h3+i<<0,this.h4=this.h4+a<<0},Sha1.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,o=this.h4;return HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]},Sha1.prototype.toString=Sha1.prototype.hex,Sha1.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,o=this.h4;return[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o]},Sha1.prototype.array=Sha1.prototype.digest,Sha1.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};var exports=createMethod();COMMON_JS?module.exports=exports:(root.sha1=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(1),__webpack_require__(8))},function(t,e,n){const r=n(0),o=n(112),i=n(145),a=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:getsource","component:setsource"];function s(t){return new URL(document.location).searchParams.get(t)}function c(t,e={}){return new Promise((t,n)=>{const r=e.protocol||s("fbp_protocol")||"opener",c={...e.runtimeOptions};switch(c.defaultPermissions||(c.defaultPermissions=a),r){case"opener":{if(!e.debugButton)return void n(new Error("No debug button defined"));const r=e.debugButton;return r.classList.replace("nodebug","debug"),r.href=function(t,e="https://app.flowhub.io"){const n={protocol:"opener",address:window.location.href};return t.id&&(n.id=t.id),`${e}#runtime/endpoint?${i.stringify(n)}`}(c,e.ide),void t(o.opener(c,r))}case"iframe":return void t(o.iframe(c));default:n(new Error("Unknown FBP protocol "+r))}})}t.exports=(t,e)=>{return(n=t,new Promise((t,e)=>{r.graph.loadJSON(n,(n,r)=>{n?e(n):t(r)})})).then(t=>c(0,e).then(n=>function(t,e,n){return n.noLoad||"true"===s("fbp_noload")?Promise.resolve(t):new Promise((n,r)=>{const o=`${t.options.namespace||"default"}/${e.name||"main"}`;t.graph.registerGraph(o,e),t.network._startNetwork(e,o,"none",i=>{i?r(i):(t.runtime.setMainGraph(o,e),n(t))})})}(n,t,e)));var n}},function(t,e,n){"use strict";e.decode=e.parse=n(146),e.encode=e.stringify=n(147)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,i){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var u=t.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var p,d,f,h,m=t[l].replace(s,"%20"),g=m.indexOf(n);g>=0?(p=m.substr(0,g),d=m.substr(g+1)):(p=m,d=""),f=decodeURIComponent(p),h=decodeURIComponent(d),r(a,f)?o(a[f])?a[f].push(h):a[f]=[a[f],h]:a[f]=h}return a};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?i(a(t),(function(a){var s=encodeURIComponent(r(a))+n;return o(t[a])?i(t[a],(function(t){return s+encodeURIComponent(r(t))})).join(e):s+encodeURIComponent(r(t[a]))})).join(e):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t){t.exports=JSON.parse('{"name":"noflo-browser-app","description":"The best project ever.","version":"0.4.0","author":{"name":"Jon Nordby","email":"jononor@gmail.com"},"repository":{"type":"git","url":"git://github.com/noflo/noflo-browser-app.git"},"license":"MIT","scripts":{"build":"webpack","lint":"eslint *.js components/*.js","lint-fix":"eslint --fix *.js components/*.js","postinstall":"noflo-cache-preheat","pretest":"npm run lint && npm run build","start":"webpack-dev-server","test":"fbp-spec --address ws://localhost:3569 --command \\"noflo-runtime-headless -f dist/test.js\\" spec/*.yaml"},"dependencies":{"noflo":"^1.0.0","noflo-core":"^0.6.0","noflo-dom":"^0.3.0","noflo-interaction":"^0.3.0","noflo-runtime-postmessage":"^0.11.0","uuid-by-string":"^3.0.2"},"devDependencies":{"@babel/core":"^7.1.6","@babel/preset-env":"^7.1.6","babel-loader":"^8.0.4","coffee-loader":"^1.0.0","copy-webpack-plugin":"^6.1.0","eslint":"^7.9.0","eslint-config-airbnb-base":"^14.2.0","eslint-plugin-import":"^2.14.0","fbp-spec":"^0.6.6","noflo-component-loader":"^0.3.2","noflo-runtime-headless":"^0.1.0","webpack":"^4.26.1","webpack-cli":"^3.1.2","webpack-dev-server":"^3.1.10"},"keywords":["noflo"]}')}]);
//# sourceMappingURL=app.js.map